{"version":3,"file":"token-action-hud-core.min.js","sources":["../scripts/constants.js","../scripts/utils.js","../scripts/data-handler.js","../scripts/action-handlers/generic-action-handler.js","../scripts/action-handlers/compendium-action-handler.js","../scripts/action-handlers/macro-action-handler.js","../scripts/action-handlers/action-handler.js","../scripts/action-handlers/action-list-extender.js","../scripts/migration-manager.js","../scripts/roll-handlers/roll-handler.js","../scripts/roll-handlers/pre-roll-handler.js","../scripts/forms/custom-style-form.js","../scripts/forms/settings-form.js","../scripts/settings.js","../scripts/action-handlers/item-macro-extender.js","../scripts/roll-handlers/compendium-macro-pre-handler.js","../scripts/roll-handlers/pre-item-macro.js","../scripts/system-manager.js","../node_modules/@yaireo/dragsort/dist/dragsort.js","../node_modules/@yaireo/tagify/dist/tagify.min.js","../scripts/dialogs/tag-dialog.js","../scripts/dialogs/tag-dialog-helper.js","../scripts/group-resizer.js","../scripts/token-action-hud.js","../scripts/init.js"],"sourcesContent":["/**\n * Module-based constants\n */\nexport const MODULE = {\n    ID: 'token-action-hud-core',\n    NAME: 'Token Action HUD'\n}\n\n/**\n * Template directory\n */\nconst TEMPLATE_DIR = `modules/${MODULE.ID}/templates`\n\n/**\n * Templates\n */\nexport const TEMPLATE = {\n    action: `${TEMPLATE_DIR}/action.hbs`,\n    customStyleForm: `${TEMPLATE_DIR}/custom-style-form.hbs`,\n    group: `${TEMPLATE_DIR}/group.hbs`,\n    hud: `${TEMPLATE_DIR}/hud.hbs`,\n    listGroup: `${TEMPLATE_DIR}/list-group.hbs`,\n    settings: `${TEMPLATE_DIR}/settings.hbs`,\n    tabGroup: `${TEMPLATE_DIR}/tab-group.hbs`,\n    tagDialogGroup: `${TEMPLATE_DIR}/tag-dialog-group.hbs`,\n    tagDialogHud: `${TEMPLATE_DIR}/tag-dialog-hud.hbs`,\n    tagDialogTopLevelGroup: `${TEMPLATE_DIR}/tag-dialog-top-level-group.hbs`\n}\n\n/**\n * Delimiter character\n */\nexport const DELIMITER = '|'\n\n/**\n * Action types\n */\nexport const ACTION_TYPE = {\n    compendiumEntry: 'tokenActionHud.compendiumEntry',\n    compendiumMacro: 'tokenActionHud.compendiumMacro',\n    compendiumPlaylist: 'tokenActionHud.compendiumPlaylist',\n    macro: 'tokenActionHud.macro'\n}\n\n/**\n * Compendium action types\n */\nexport const COMPENDIUM_ACTION_TYPES = ['compendiumEntry', 'compendiumMacro', 'compendiumPlaylist', 'macro']\n\n/**\n * Compendium pack types\n */\nexport const COMPENDIUM_PACK_TYPES = ['JournalEntry', 'Macro', 'RollTable']\n\n/**\n * CSS styles\n */\nexport const CSS_STYLE = {\n    compact: {\n        class: 'tah-style-foundry-vtt',\n        file: 'tah-compact',\n        primaryColor: '#dddddd',\n        secondaryColor: '#dddddd80',\n        tertiaryColor: '#ff6400'\n    },\n    custom: {\n        class: 'tah-style-custom',\n        file: 'tah-custom'\n    },\n    dorakoUI: {\n        class: 'tah-style-dorako-ui',\n        file: 'tah-dorako'\n    },\n    foundryVTT: {\n        class: 'tah-style-foundry-vtt-dark',\n        file: 'tah-foundry-vtt-dark',\n        primaryColor: '#dddddd',\n        secondaryColor: '#dddddd80',\n        tertiaryColor: '#ff6400'\n    },\n    foundryVttLight: {\n        class: 'tah-style-foundry-vtt-light',\n        file: 'tah-foundry-vtt-light',\n        primaryColor: '#dddddd',\n        secondaryColor: '#dddddd80',\n        tertiaryColor: '#ff6400'\n    },\n    highContrast: {\n        class: 'tah-style-high-contrast',\n        file: 'tah-high-contrast',\n        primaryColor: '#ffff00',\n        secondaryColor: '#ffff00',\n        tertiaryColor: '#0C7BDC'\n    },\n    pathfinder: {\n        class: 'tah-style-pathfinder',\n        file: 'tah-pathfinder'\n    }\n}\n\n/**\n * Custom styles\n */\nexport const CUSTOM_STYLE = {\n    backgroundColor: { cssProperty: '--tah-background-color', type: String, default: '#00000000' },\n    buttonHeight: { cssProperty: '--tah-button-height-editable', type: Number, default: 32 },\n    buttonBackgroundColor: { cssProperty: '--tah-button-background-color-editable', type: String, default: '#000000b3' },\n    buttonBorderPrimaryColor: { cssProperty: '--tah-button-border-primary-color-editable', type: String, default: '#0C0C0CFF' },\n    buttonBorderSecondaryColor: { cssProperty: '--tah-button-border-secondary-color-editable', type: String, default: '#060606FF' },\n    buttonTextColor: { cssProperty: '--tah-button-text-color-editable', type: String, default: '#DDDDDDFF' },\n    buttonHoverBorderPrimaryColor: { cssProperty: '--tah-button-hover-border-primary-color-editable', type: String, default: '#FF6400FF' },\n    buttonHoverBorderSecondaryColor: { cssProperty: '--tah-button-hover-border-secondary-color-editable', type: String, default: '#FF0000FF' },\n    buttonHoverBackgroundColor: { cssProperty: '--tah-button-hover-background-color-editable', type: String, default: '#000000B3' },\n    buttonHoverTextColor: { cssProperty: '--tah-button-hover-text-color-editable', type: String, default: '#FFFFFFFF' },\n    buttonToggleActiveBackgroundColor: { cssProperty: '--tah-button-toggle-active-background-color-editable', type: String, default: '#3C0078BF' },\n    buttonToggleActiveBorderPrimaryColor: { cssProperty: '--tah-button-toggle-active-border-primary-color-editable', type: String, default: '#9B8DFFFF' },\n    buttonToggleActiveBorderSecondaryColor: { cssProperty: '--tah-button-toggle-active-border-secondary-color-editable', type: String, default: '#9B8DFFFF' },\n    buttonToggleActiveTextColor: { cssProperty: '--tah-button-toggle-active-text-color-editable', type: String, default: '#FFFFFFFF' },\n    buttonToggleHoverBackgroundColor: { cssProperty: '--tah-button-toggle-hover-background-color-editable', type: String, default: '#3C0078BF' },\n    buttonToggleHoverBorderPrimaryColor: { cssProperty: '--tah-button-toggle-hover-border-primary-color-editable', type: String, default: '#9B8DFFFF' },\n    buttonToggleHoverBorderSecondaryColor: { cssProperty: '--tah-button-toggle-hover-secondary-color-editable', type: String, default: '#9B8DFFFF' },\n    buttonToggleHoverTextColor: { cssProperty: '--tah-button-toggle-hover-text-color-editable', type: String, default: '#FFFFFFFF' },\n    textPrimaryColor: { cssProperty: '--tah-text-primary-color-editable', type: String, default: '#DDDDDDFF' },\n    textSecondaryColor: { cssProperty: '--tah-text-secondary-color-editable', type: String, default: '#DDDDDD80' },\n    textTertiaryColor: { cssProperty: '--tah-text-tertiary-color-editable', type: String, default: '#FF6400FF' },\n    textHoverPrimaryColor: { cssProperty: '--tah-text-hover-primary-color-editable', type: String, default: '#DDDDDDFF' },\n    textHoverSecondaryColor: { cssProperty: '--tah-text-hover-secondary-color-editable', type: String, default: '#DDDDDD80' },\n    textHoverTertiaryColor: { cssProperty: '--tah-text-tertiary-color-editable', type: String, default: '#FF6400FF' }\n}\n\n/**\n * Group types\n */\nexport const GROUP_TYPE = {\n    COMPENDIUM: 'compendium',\n    CUSTOM: 'custom',\n    SYSTEM: 'system',\n    SYSTEM_DERIVED: 'system-derived'\n}\n\n/**\n * Item Macro icon\n */\nexport const ITEM_MACRO_ICON = {\n    ICON: 'fas fa-sd-card',\n    TOOLTIP: 'Item Macro'\n}\n\n/**\n * Layout settings\n */\nexport const LAYOUT_SETTING = {\n    customLayout: {\n        hint: 'tokenActionHud.settings.customLayout.hint',\n        name: 'tokenActionHud.settings.customLayout.name',\n        inputType: 'filePicker',\n        filePickerType: 'json',\n        dtype: 'String',\n        scope: 'world'\n    },\n    userCustomLayout: {\n        hint: 'tokenActionHud.settings.userCustomLayout.hint',\n        name: 'tokenActionHud.settings.userCustomLayout.name',\n        inputType: 'filePicker',\n        filePickerType: 'json',\n        dtype: 'String',\n        scope: 'client'\n    },\n    exportLayout: {\n        hint: 'tokenActionHud.settings.exportLayout.hint',\n        label: 'tokenActionHud.settings.exportLayout.label',\n        name: 'tokenActionHud.settings.exportLayout.name',\n        inputType: 'button',\n        icon: 'fa-solid fa-file-export',\n        onClick: 'game?.tokenActionHud?.actionHandler?.exportLayout()'\n    },\n    resetLayout: {\n        hint: 'tokenActionHud.settings.resetLayout.hint',\n        label: 'tokenActionHud.settings.resetLayout.label',\n        name: 'tokenActionHud.settings.resetLayout.name',\n        inputType: 'button',\n        icon: 'fa-solid fa-arrow-rotate-left',\n        onClick: 'game?.tokenActionHud?.resetDialog()',\n        scope: 'client'\n    },\n    resetAllLayouts: {\n        hint: 'tokenActionHud.settings.resetAllLayouts.hint',\n        label: 'tokenActionHud.settings.resetAllLayouts.label',\n        name: 'tokenActionHud.settings.resetAllLayouts.name',\n        inputType: 'button',\n        icon: 'fa-solid fa-bomb',\n        onClick: 'game?.tokenActionHud?.resetAllDialog()',\n        scope: 'world'\n    }\n}\n\n/**\n * Settings\n */\nexport const SETTING = {\n    activeCssAsText: { classes: ['TokenActionHud'], variable: 'activeCssAsTextSetting' },\n    allow: { classes: ['TokenActionHud'], variable: 'allowSetting' },\n    alwaysShowHud: { classes: ['TokenActionHud'], variable: 'alwaysShowHudSetting' },\n    backgroundColor: {},\n    buttonBackgroundColor: {},\n    buttonBorderPrimaryColor: {},\n    buttonBorderSecondaryColor: {},\n    buttonHeight: {},\n    buttonHoverBorderPrimaryColor: {},\n    buttonHoverBorderSecondaryColor: {},\n    buttonHoverBackgroundColor: {},\n    buttonHoverTextColor: {},\n    buttonTextColor: {},\n    buttonToggleActiveBackgroundColor: {},\n    buttonToggleActiveBorderPrimaryColor: {},\n    buttonToggleActiveBorderSecondaryColor: {},\n    buttonToggleActiveTextColor: {},\n    buttonToggleHoverBackgroundColor: {},\n    buttonToggleHoverBorderPrimaryColor: {},\n    buttonToggleHoverBorderSecondaryColor: {},\n    buttonToggleHoverTextColor: {},\n    clickOpenCategory: { classes: ['TokenActionHud'], variable: 'clickOpenCategorySetting' },\n    customLayout: { classes: ['ActionHandler'], variable: 'customLayoutSetting' },\n    customStyle: {},\n    debug: { classes: ['TokenActionHud'], variable: 'debugSetting' },\n    direction: { classes: ['TokenActionHud'], variable: 'directionSetting' },\n    displayCharacterName: { classes: ['TokenActionHud'], variable: 'displayCharacterName' },\n    displayIcons: { classes: ['TokenActionHud'], variable: 'displayIconsSetting' },\n    drag: { classes: ['TokenActionHud'], variable: 'dragSetting' },\n    enable: { classes: ['TokenActionHud'], variable: 'enableSetting' },\n    enableCustomization: { classes: ['ActionHandler', 'TokenActionHud'], variable: 'enableCustomizationSetting' },\n    grid: { classes: ['TokenActionHud'], variable: 'gridSetting' },\n    itemMacro: {},\n    migrationVersion: {},\n    reset: {},\n    renderItemOnRightClick: {},\n    rollHandler: { default: 'core' },\n    scale: { classes: ['TokenActionHud'], variable: 'scaleSetting' },\n    sortActions: { classes: ['ActionHandler'], variable: 'sortActionsSetting' },\n    startup: {},\n    style: {},\n    tooltips: { classes: ['ActionHandler'], variable: 'tooltipsSetting' },\n    textPrimaryColor: {},\n    textSecondaryColor: {},\n    textTertiaryColor: {},\n    textHoverPrimaryColor: {},\n    textHoverSecondaryColor: {},\n    textHoverTertiaryColor: {},\n    userCustomLayout: { classes: ['ActionHandler'], variable: 'userCustomLayoutSetting' }\n}\n","import { CSS_STYLE, CUSTOM_STYLE, MODULE } from './constants.js'\n\n/**\n * Console logger\n */\nexport class Logger {\n    static info (message, notify = false) {\n        if (notify) ui.notifications.info(`Token Action HUD | ${message}`)\n        else console.log(`Token Action HUD Info | ${message}`)\n    }\n\n    static error (message, notify = false) {\n        if (notify) ui.notifications.error(`Token Action HUD | ${message}`)\n        else console.error(`Token Action HUD Error | ${message}`)\n    }\n\n    static debug (message, data) {\n        const isDebug = (game.tokenActionHud) ? game.tokenActionHud.debugSetting : Utils.getSetting('debug')\n        if (isDebug) {\n            if (!data) {\n                console.log(`Token Action HUD Debug | ${message}`)\n                return\n            }\n            const dataClone = Utils.deepClone(data)\n            console.log(`Token Action HUD Debug | ${message}`, dataClone)\n        }\n    }\n}\n\n/**\n * Timer for setting and aborting timeouts\n */\nexport class Timer {\n    constructor (milliseconds) {\n        this.milliseconds = milliseconds\n        this.timer = null\n    }\n\n    async start () {\n        if (this.timer) this.abort()\n        return new Promise(resolve => {\n            this.timer = setTimeout(() => { resolve() }, this.milliseconds ?? 100)\n        })\n    }\n\n    async abort () {\n        clearTimeout(this.timer)\n        this.timer = null\n    }\n}\n\nexport class Utils {\n    /**\n    * Whether the user is allowed to use the HUD\n    * @public\n    * @param {number} userRole The user's role\n    * @returns {boolean}\n    */\n    static checkAllow (userRole, allowSetting) {\n        if (userRole >= allowSetting) return true\n        return false\n    }\n\n    /**\n     * Foundry VTT's deepClone function wrapped here to avoid code error highlighting due to missing definition.\n     * @public\n     * @param {*} original\n     * @param {*} options\n     */\n    static deepClone (original, options) {\n        // eslint-disable-next-line no-undef\n        return deepClone(original, options)\n    }\n\n    /**\n     * Get actor from the token or actor object\n     * @public\n     * @param {string} actorId The actor id\n     * @param {string} tokenId The token id\n     * @returns {object}       The actor\n     */\n    static getActor (actorId, tokenId) {\n        let token = null\n        if (tokenId) token = canvas.tokens.placeables.find((token) => token.id === tokenId)\n        if (token) return token.actor\n        return game.actors.get(actorId)\n    }\n\n    /**\n     * Get status effect from actor based on the status id\n     * @param {object} actor    The actor\n     * @param {string} statusId The status id\n     * @returns {object}        The status effect\n     */\n    static getStatusEffect (actor, statusId) {\n        if (game.version.startsWith('11')) {\n            return actor.effects.find((effect) => effect.statuses.every((status) => status === statusId))\n        } else {\n            // V10\n            return actor.effects.find((effect) => effect.flags?.core?.statusId === statusId)\n        }\n    }\n\n    /**\n     * Get image from entity\n     * @public\n     * @param {object} entity       The entity, e.g., actor, item\n     * @param {array} defaultImages Any default images to exclude\n     * @returns {string}            The image URL\n     */\n    static getImage (entity, defaultImages = []) {\n        defaultImages.push('icons/svg/mystery-man.svg')\n        let result = ''\n        if (game.tokenActionHud.displayIconsSetting) result = (typeof entity === 'string') ? entity : entity?.img ?? entity?.icon ?? ''\n        return !defaultImages.includes(result) ? result : ''\n    }\n\n    /**\n     * Get item from the actor object\n     * @public\n     * @param {object} actor  The actor\n     * @param {string} itemId The item id\n     * @returns {object}      The item\n     */\n    static getItem (actor, itemId) {\n        return actor.items.get(itemId)\n    }\n\n    /**\n     * Get token\n     * @public\n     * @param {string} tokenId The token id\n     * @returns {object}       The token\n     */\n    static getToken (tokenId) {\n        return canvas.tokens.placeables.find((token) => token.id === tokenId)\n    }\n\n    /**\n     * Get controlled tokens\n     * @public\n     * @returns {array} The controlled tokens\n     */\n    static getControlledTokens () {\n        return game.canvas.tokens.controlled\n    }\n\n    /**\n     * Get first controlled tokens\n     * @public\n     * @returns {object} The first controlled token\n     */\n    static getFirstControlledToken () {\n        const controlledToken = game.canvas.tokens.controlled[0]\n        if (controlledToken) {\n            return controlledToken\n        }\n        const character = game.user?.character\n        if (character) {\n            return canvas.tokens.placeables.find(token => token.actor?.id === character.id)\n        }\n    }\n\n    /**\n     * Get setting value\n     * @public\n     * @param {string} key               The setting key\n     * @param {string=null} defaultValue The setting default value\n     * @returns {*}                      The setting value\n     */\n    static getSetting (key, defaultValue = null) {\n        let value = defaultValue ?? null\n        try {\n            value = game.settings.get(MODULE.ID, key)\n        } catch {\n            Logger.debug(`Setting '${key}' not found`)\n        }\n        return value\n    }\n\n    /**\n     * Set setting value\n     * @public\n     * @param {string} key   The setting key\n     * @param {string} value The setting value\n     */\n    static async setSetting (key, value) {\n        if (game.settings.settings.get(`${MODULE.ID}.${key}`)) {\n            await game.settings.set(MODULE.ID, key, value)\n            Logger.debug(`Setting '${key}' set to '${value}'`)\n        } else {\n            Logger.debug(`Setting '${key}' not found`)\n        }\n    }\n\n    /**\n     * Get module actor flag\n     * @public\n     * @param {string} key The flag key\n     * @returns {*}        The flag value\n     */\n    static getActorFlag (key) {\n        return game.tokenActionHud.actor.getFlag(MODULE.ID, key)\n    }\n\n    /**\n     * Set module actor flag\n     * @public\n     * @param {string} key The flag key\n     * @param {*} value    The flag value\n     */\n    static async setActorFlag (key, value) {\n        await game.tokenActionHud.actor.setFlag(MODULE.ID, key, value)\n    }\n\n    /**\n     * Unset module actor flag\n     * @public\n     * @param {string} key The flag key\n     */\n    static async unsetActorFlag (key) {\n        await game.tokenActionHud.actor.unsetFlag(MODULE.ID, key)\n    }\n\n    /**\n     * Get module user flag\n     * @public\n     * @param {string} key The flag key\n     * @returns {*}        The flag value\n     */\n    static getUserFlag (key) {\n        return game.user.getFlag(MODULE.ID, key)\n    }\n\n    /**\n     * Set module user flag\n     * @public\n     * @param {string} key The flag key\n     * @param {*} value    The flag value\n     */\n    static async setUserFlag (key, value) {\n        await game.user.setFlag(MODULE.ID, key, value)\n    }\n\n    /**\n     * Unset module user flag\n     * @public\n     * @param {string} key The flag key\n     */\n    static async unsetUserFlag (key) {\n        await game.user.unsetFlag(MODULE.ID, key)\n    }\n\n    /**\n     * Language translation\n     * @public\n     * @param {string} toTranslate The value to translate\n     * @returns {string}           The translated value\n     */\n    static i18n (toTranslate) {\n        return game.i18n.localize(toTranslate)\n    }\n\n    /**\n     * Whether a GM is active\n     * @public\n     * @returns {boolean} Whether a GM is active\n     */\n    static isGmActive () {\n        return game.users.some(user => user.isGM && user.active)\n    }\n\n    /**\n     * Whether the given module is active\n     * @public\n     * @param {string} moduleId The module id\n     * @returns {boolean}       Whether the given module is active\n     */\n    static isModuleActive (moduleId) {\n        const module = game.modules.get(moduleId)\n        return module && module.active\n    }\n\n    /**\n     * Get the given module's title\n     * @public\n     * @param {string} moduleId The module id\n     * @returns {string}        The module title\n     */\n    static getModuleTitle (moduleId) {\n        return game.modules.get(moduleId)?.title ?? ''\n    }\n\n    /**\n     * Get the given module's version\n     * @public\n     * @param {string} moduleId The module id\n     * @returns {string}        The module version\n     */\n    static getModuleVersion (moduleId) {\n        return game.modules.get(moduleId)?.version ?? ''\n    }\n\n    /**\n     * Humanize keybinding\n     * @param {object} key The keybinding key\n     * @returns {string}   The humanized keybinding\n     */\n    static humanizeBinding (key) {\n        const binding = game.keybindings.get(MODULE.ID, key)\n        if (!binding) return ''\n        const stringParts = binding[0].modifiers.reduce((parts, part) => {\n            if (KeyboardManager.MODIFIER_CODES[part]?.includes(binding[0].key)) return parts\n            parts.unshift(KeyboardManager.getKeycodeDisplayString(part))\n            return parts\n        }, [KeyboardManager.getKeycodeDisplayString(binding[0].key)])\n        return stringParts.join(' + ')\n    }\n\n    /**\n     * Get the median\n     * @public\n     * @param {array} numbers The array of numbers\n     * @returns {number}      The median\n     */\n    static median (numbers) {\n        const mid = Math.floor(numbers.length / 2)\n        const nums = [...numbers].sort((a, b) => a - b)\n        return numbers.length % 2 !== 0 ? nums[mid] : (nums[mid - 1] + nums[mid]) / 2\n    }\n\n    /**\n     * Get upper quartile average\n     * @param {array} numbers The numbers\n     * @returns {number}      The upper quartile average\n     */\n    static getUpperQuartileAverage (numbers) {\n        const sortedNumbers = numbers.slice().sort((a, b) => a - b)\n        const length = sortedNumbers.length\n        const startIndex = Math.ceil(length * 0.75)\n        const endIndex = length - 1\n\n        let sum = 0\n        let count = 0\n\n        for (let i = startIndex; i <= endIndex; i++) {\n            sum += sortedNumbers[i]\n            count++\n        }\n\n        const upperQuartileAverage = sum / count\n\n        return upperQuartileAverage\n    }\n\n    /**\n     * Get modifier\n     * @param {number} value The value\n     * @returns {string}     The modifier\n     */\n    static getModifier (value) {\n        if (!value && value !== 0) return ''\n        const sign = (value >= 0) ? '+' : ''\n        return `${sign}${value}`\n    }\n\n    /**\n     * Sort items\n     * @public\n     * @param {object} items The items\n     * @returns {object}     The sorted items\n     */\n    static sortItems (items) {\n        return new Map([...items.entries()].sort((a, b) => a[1].sort.localeCompare(b[1].sort)))\n    }\n\n    /**\n     * Sort items by name\n     * @public\n     * @param {object} items The items\n     * @returns {object}     The sorted items\n     */\n    static sortItemsByName (items) {\n        return new Map([...items.entries()].sort((a, b) => a[1].name.localeCompare(b[1].name)))\n    }\n\n    /**\n     * Enable stylesheet based on setting and disable all other stylesheets\n     * @public\n     * @param {string} style The 'style' setting value\n     */\n    static switchCSS (style) {\n        for (const [key, value] of Object.entries(CSS_STYLE)) {\n            const href = [`modules/${MODULE.ID}/`, `styles/${value.file}`]\n            if (key === style) {\n                Object.values(document.styleSheets).find(\n                    (ss) => ss.href?.includes(href[0]) && ss.href?.includes(href[1])\n                ).disabled = false\n            } else {\n                Object.values(document.styleSheets).find(\n                    (ss) => ss.href?.includes(href[0]) && ss.href?.includes(href[1])\n                ).disabled = true\n            }\n        }\n\n        if (style === 'custom') {\n            for (const [key, value] of Object.entries(CUSTOM_STYLE)) {\n                const setting = Utils.getSetting(key)\n                if (setting) {\n                    document.querySelector(':root').style.setProperty(value.cssProperty, setting)\n                }\n            }\n        }\n\n        const tahElement = document.querySelector('#token-action-hud')\n        if (tahElement) {\n            tahElement.classList.remove(...tahElement.classList)\n            tahElement.classList.add(CSS_STYLE[style].class)\n        }\n    }\n\n    /**\n     * Register Handlebar helpers\n     * @public\n     */\n    static registerHandlebars () {\n        // Capitalise first character\n        Handlebars.registerHelper('cap', function (string) {\n            if (!string || string.length < 1) return ''\n            return string[0].toUpperCase() + string.slice(1)\n        })\n\n        const reduceOp = function (args, reducer) {\n            args = Array.from(args)\n            args.pop() // => options\n            const first = args.shift()\n            return args.reduce(reducer, first)\n        }\n\n        // Support operators\n        Handlebars.registerHelper({\n            eq: function () { return reduceOp(arguments, (a, b) => a === b) },\n            ne: function () { return reduceOp(arguments, (a, b) => a !== b) },\n            lt: function () { return reduceOp(arguments, (a, b) => a < b) },\n            gt: function () { return reduceOp(arguments, (a, b) => a > b) },\n            lte: function () { return reduceOp(arguments, (a, b) => a <= b) },\n            gte: function () { return reduceOp(arguments, (a, b) => a >= b) },\n            and: function () { return reduceOp(arguments, (a, b) => a && b) },\n            or: function () { return reduceOp(arguments, (a, b) => a || b) },\n            true: function () { return reduceOp(arguments, (a) => a) },\n            false: function () { return reduceOp(arguments, (a) => !a) }\n        })\n\n        // Add asterisk to toggleable actions\n        Handlebars.registerHelper('activeText', function (block) {\n            if (game.tokenActionHud.activeCssAsTextSetting) {\n                return block.fn(this)\n            }\n            return block.inverse(this)\n        })\n    }\n\n    /**\n     * Get the major, minor and patch parts of the module version\n     * @public\n     * @param {string} moduleVersion The module version\n     * @returns {object}             The module version parts\n     */\n    static getModuleVersionParts (moduleVersion) {\n        if (!moduleVersion) {\n            Logger.debug('Module version not retrieved', { trigger: 'getModuleVersionParts' })\n            return\n        }\n        const moduleVersionParts = moduleVersion.split('.')\n        return {\n            major: moduleVersionParts[0],\n            minor: moduleVersionParts[1],\n            patch: moduleVersionParts[2]\n        }\n    }\n\n    /**\n     * Whether the system module is compatible with the core module version\n     * @public\n     * @param {object} systemModuleCoreModuleVersion The system module's required core module version\n     * @returns {boolean}\n     */\n    static checkModuleCompatibility (requiredCoreModuleVersion) {\n        // Get core module version in parts\n        const requiredCoreModuleVersionParts = this.getModuleVersionParts(requiredCoreModuleVersion)\n        const coreModuleVersionParts = this.getModuleVersionParts(game.modules.get(MODULE.ID).version)\n\n        if (coreModuleVersionParts.major !== requiredCoreModuleVersionParts.major ||\n            coreModuleVersionParts.minor !== requiredCoreModuleVersionParts.minor ||\n            (requiredCoreModuleVersionParts.patch && coreModuleVersionParts.patch !== requiredCoreModuleVersionParts.patch)\n        ) {\n            ui.notifications.error(\n                `The installed Token Action HUD system module requires Token Action HUD Core module version ${requiredCoreModuleVersion}. Install the required version to continue using Token Action HUD.`\n            )\n            return false\n        }\n        return true\n    }\n\n    /**\n     * Get subcategories by criteria\n     * @public\n     * @param {object} subcategories  The subcategories\n     * @param {object} data           The search data\n     * @returns {object}\n     */\n    static getSubcategories (subcategories, data = {}) {\n        let order = 0\n        if (!subcategories) return\n        const subcategoryId = data?.id\n        const subcategoryType = data?.type\n        subcategories = (Array.isArray(subcategories)) ? subcategories : Object.values(subcategories)\n        const foundSubcategories = {}\n        for (const subcategory of subcategories) {\n            if ((!subcategoryId || subcategory.id === subcategoryId) && (!subcategoryType || subcategory.type === subcategoryType)) {\n                order++\n                const level = subcategory.nestId.split('_').length\n                foundSubcategories[subcategory.nestId] = { ...subcategory, order, level }\n            }\n            if (subcategory.subcategories?.length > 0) {\n                const subcategories = this.getSubcategories(subcategory.subcategories, data)\n                if (subcategories) Object.assign(foundSubcategories, subcategories)\n            }\n        }\n        return (Object.keys(foundSubcategories).length > 0) ? foundSubcategories : null\n    }\n\n    /**\n     * Get nested groups by criteria\n     * @public\n     * @param {object} groups  The groups\n     * @param {object} data    The search data\n     * @returns {object}\n     */\n    static getNestedGroups (groups, data = {}) {\n        let order = 0\n        if (!groups) return\n        const groupId = data?.id\n        const groupType = data?.type\n        groups = (Array.isArray(groups)) ? groups : Object.values(groups)\n        const foundGroups = {}\n        for (const group of groups) {\n            if ((!groupId || group.id === groupId) && (!groupType || group.type === groupType)) {\n                order++\n                const level = group.nestId.split('_').length\n                foundGroups[group.nestId] = { ...group, order, level }\n            }\n            if (group.groups?.length > 0) {\n                const groups = this.getNestedGroups(group.groups, data)\n                if (groups) Object.assign(foundGroups, groups)\n            }\n        }\n        return (Object.keys(foundGroups).length > 0) ? foundGroups : null\n    }\n\n    /**\n     * Get group by nest id\n     * @public\n     * @param {object} groups The groups\n     * @param {string} data   The search data\n     * @returns {object}\n     */\n    static async getGroupByNestId (groups, data = {}) {\n        const nestId = (typeof data === 'string' ? data : data?.nestId)\n        const groupType = data?.type\n        if (!nestId) return\n\n        const parts = nestId.split('_')\n        return await findGroup(groups, parts)\n\n        async function findGroup (groups, parts) {\n            groups = (Array.isArray(groups)) ? groups : Object.values(groups)\n            for (const group of groups) {\n                if (group.id === parts[0]) {\n                    if (parts.length === 1) {\n                        if (!group.type || !groupType || group.type === groupType) return group\n                        return\n                    }\n                    parts.shift()\n                    for (const groupStyle of Object.values(group.groups)) {\n                        if (groupStyle.length === 0) continue\n                        const foundGroup = await findGroup(groupStyle, parts)\n                        if (foundGroup) return foundGroup\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n     * Delete group by nest id\n     * @public\n     * @param {object} groups The groups\n     * @param {string} data   The search data\n     */\n    static async deleteGroupByNestId (groups, data = {}) {\n        const nestId = (typeof data === 'string' ? data : data?.nestId)\n        if (!nestId) return\n\n        const parts = nestId.split('_')\n        return await findGroup(groups, parts)\n\n        async function findGroup (groups, parts) {\n            groups = (Array.isArray(groups)) ? groups : Object.values(groups)\n            for (const [index, group] of groups.entries()) {\n                if (group.id === parts[0]) {\n                    if (parts.length === 1) {\n                        groups.splice(index, 1)\n                        return\n                    }\n                    if (group.groups.length === 0) return\n                    parts.shift()\n                    const foundGroup = await findGroup(group.groups, parts)\n                    if (foundGroup) return\n                }\n            }\n        }\n    }\n\n    /**\n     * Delete groups by id\n     * @public\n     * @param {object} groups The groups\n     * @param {string} data   The search data\n     */\n    static async deleteGroupsById (groups, data = {}) {\n        const id = (typeof data === 'string' ? data : data?.id)\n        if (!id) return\n\n        for (let i = groups.length - 1; i >= 0; i--) {\n            if (groups[i].id === id) {\n                groups.splice(i, 1)\n            } else if (groups[i].groups?.length > 0) {\n                this.deleteGroupsById(groups[i].groups, data)\n            }\n        }\n    }\n}\n","import { MODULE } from './constants.js'\nimport { Logger, Utils } from './utils.js'\n\n/**\n * Get file parts\n * @param {string} file The file\n * @returns {object}    The file parts\n */\nfunction getFileParts (file) {\n    const parts = file.split('/')\n    const filename = parts.pop()\n    const folder = parts.join('/')\n    const id = filename.split('.')[0]\n    return { folder, filename, id }\n}\n\nexport function isPersistentStorage () {\n    return (game.version >= '11.305' && typeof ForgeVTT === 'undefined')\n}\n\nexport class DataHandler {\n    async init () {\n        this.path = DataHandler.getPath()\n        this.fileMap = await DataHandler.getFilePathsAsGm()\n    }\n\n    /**\n     * Create directories\n     */\n    static async createDirectories () {\n        const DATA_FOLDER = 'data'\n        const moduleDirectory = (isPersistentStorage())\n            ? `modules/${MODULE.ID}/storage`\n            : MODULE.ID\n\n        const directoriesToCreate = [\n            moduleDirectory,\n            `${moduleDirectory}/${game.world.id}`,\n            `${moduleDirectory}/${game.world.id}/actor`,\n            `${moduleDirectory}/${game.world.id}/user`\n        ]\n\n        for (const directory of directoriesToCreate) {\n            await FilePicker.browse(DATA_FOLDER, directory).catch(async (_) => {\n                if (!(await FilePicker.createDirectory(DATA_FOLDER, directory, {}))) {\n                    Logger.debug('Failed to create directory: ' + directory)\n                }\n            })\n        }\n    }\n\n    /**\n     * Get base path to the layout files\n     * @returns {string} The path\n     */\n    static getPath () {\n        return (isPersistentStorage())\n            ? `modules/${MODULE.ID}/storage/${game.world.id}/`\n            : `${MODULE.ID}/${game.world.id}/`\n    }\n\n    /**\n     * Get file paths as GM\n     * @returns {object} The file paths\n     */\n    static async getFilePathsAsGm () {\n        if (!game.user.hasPermission('FILES_BROWSE') && !Utils.isGmActive()) {\n            Logger.info('Cannot get file paths without a GM present', true)\n            return new Map() // Return an empty map if no permissions and no GM\n        }\n\n        const files = game.user.hasPermission('FILES_BROWSE')\n            ? await DataHandler.getFilePaths()\n            : await game.tokenActionHud.socket.executeAsGM('getFilePaths')\n\n        return new Map(files.map(file => {\n            const { id } = getFileParts(file)\n            return [id, file]\n        }))\n    }\n\n    /**\n     * Get file paths\n     */\n    static async getFilePaths () {\n        const dataHandler = game?.tokenActionHud?.dataHandler\n        const [actorFiles, userFiles] = await Promise.all([\n            FilePicker.browse('data', `${dataHandler.path}actor/`),\n            FilePicker.browse('data', `${dataHandler.path}user/`)\n        ])\n\n        return [...(actorFiles?.files ?? []), ...(userFiles?.files ?? [])]\n    }\n\n    /**\n     * Whether the user can save data\n     * @returns {boolean} Whether the user can save data\n     */\n    static canSaveData () {\n        return (game.user.hasPermission('FILES_UPLOAD') || Utils.isGmActive())\n    }\n\n    /**\n     * Save data the GM\n     * @public\n     * @param {string} type The type: actor or user\n     * @param {string} id   The actor or user id\n     * @param {object} data The data\n     */\n    static async saveDataAsGm (type, id, data) {\n        if (game.user.hasPermission('FILES_UPLOAD')) {\n            return await DataHandler.saveData(type, id, data)\n        }\n\n        if (!Utils.isGmActive()) {\n            Logger.info('Cannot save data without a GM present', true)\n            return\n        }\n\n        await game.tokenActionHud.socket.executeAsGM('saveData', type, id, data)\n    }\n\n    /**\n     * Save data\n     * @param {string} type The type: actor or user\n     * @param {string} id   The actor or user id\n     * @param {object} data The data\n     */\n    static async saveData (type, id, data) {\n        const dataHandler = game?.tokenActionHud?.dataHandler\n\n        try {\n            // Get the folder path\n            const folder = `${dataHandler.path}${type}`\n\n            // Generate the system-safe filename\n            const fileName = encodeURI(`${id}.json`)\n\n            // Create the file and contents\n            const file = new File([JSON.stringify(data, null, '')], fileName, { type: 'application/json' })\n\n            // Upload the file\n            const response = await FilePicker.upload('data', folder, file, {}, { notify: false })\n\n            if (response.path) {\n                if (!dataHandler.fileMap.has(id)) {\n                    dataHandler.fileMap.set(id, response.path)\n                }\n            } else {\n                Logger.debug(`Failed to save data to: ${fileName}\\nReason: ${response.error || 'Unknown error'}`)\n            }\n        } catch (error) {\n            Logger.error(`An error occurred while saving data for ${id}.json: ${error.message}`)\n        }\n    }\n\n    /**\n     * Whether the user can get data\n     * @returns {boolean} Whether the user can get data\n     */\n    static canGetData () {\n        return (game.user.hasPermission('FILES_BROWSE') || Utils.isGmActive())\n    }\n\n    /**\n     * Get data as GM\n     * @public\n     * @param {object} options The options: file, type, id\n     * @returns {object}       The data\n     */\n    static async getDataAsGm (options) {\n        try {\n            if (!game.user.hasPermission('FILES_BROWSE') && !Utils.isGmActive()) {\n                Logger.info('Cannot get data without a GM present', true)\n                return\n            }\n\n            return (game.user.hasPermission('FILES_BROWSE'))\n                ? await DataHandler.getData(options)\n                : await game.tokenActionHud.socket.executeAsGM('getData', options)\n        } catch (error) {\n            Logger.error(`An error occurred while getting data: ${error.message}`)\n            return null\n        }\n    }\n\n    /**\n     * Get data\n     * @param {string} options The options: file, type, id\n     * @returns {object}       The data\n     */\n    static async getData (options) {\n        const dataHandler = game.tokenActionHud.dataHandler\n\n        const { id } = options\n\n        // Check if the file is available in the fileMap\n        const foundFile = dataHandler.fileMap.get(id) ?? null\n\n        // If not found, return null\n        if (!foundFile) {\n            return null\n        }\n\n        try {\n            const ms = Date.now()\n            const response = await fetch(`${foundFile}?ms=${ms}`)\n\n            // Check if the fetch was successful\n            if (response.ok) {\n                return await response.json()\n            } else {\n                return null\n            }\n        } catch (error) {\n            console.error(error)\n            return null\n        }\n    }\n\n    /**\n     * Save data\n     * @param {string} type The type: actor or user\n     * @param {string} id   The actor or user id\n     * @param {object} data The data\n     */\n    static async saveDataMigrate (type, id, data) {\n        // Get the folder path\n        const folderPath = `${MODULE.ID}/${game.world.id}/${type}`\n        // Generate the system safe filename\n        const fileName = encodeURI(`${id}.json`)\n        // Create the File and contents\n        const file = new File([JSON.stringify(data, null, '')], fileName, { type: 'application/json' })\n        const response = await FilePicker.upload('data', folderPath, file, {}, { notify: false })\n        if (!response.path) {\n            Logger.debug(`Failed to save data to: ${fileName}\\nReason: ${response}`)\n        }\n    }\n\n    /**\n     * Get data\n     * @param {string} type The type: actor or user\n     * @param {string} id   The actor or user id\n     * @returns {object}    The data\n     */\n    static async getDataMigrate (type, id) {\n        const folderPath = `${MODULE.ID}/${game.world.id}/${type}`\n        const fileName = encodeURI(`${id}.json`)\n        try {\n            const foundFolderPath = await FilePicker.browse('data', folderPath)\n            const foundFilePath = foundFolderPath.files.find(file => file.endsWith(fileName))\n            if (foundFilePath) {\n                const ms = Date.now()\n                return await fetch(`${foundFilePath}?ms=${ms}`)\n                    .then(response => {\n                        if (response.ok) {\n                            return response.json()\n                        } else {\n                            return null\n                        }\n                    })\n                    .catch(error => {\n                        console.error(error)\n                    })\n            } else {\n                return null\n            }\n        } catch {\n            return null\n        }\n    }\n}\n","import { DELIMITER, GROUP_TYPE } from '../constants.js'\nimport { Utils } from '../utils.js'\n\n/**\n * Handler for building the HUD's generic actions.\n */\nexport class GenericActionHandler {\n    actionHandler\n\n    constructor (actionHandler) {\n        this.actionHandler = actionHandler\n        this.actor = actionHandler.actor\n        this.token = actionHandler.token\n    }\n\n    /**\n     * Build generic actions\n     * @public\n     * @param {object} character The actor and/or token\n     */\n    buildGenericActions () {\n        this.#buildUtilities()\n    }\n\n    /**\n     * Build utilities\n     * @private\n     */\n    #buildUtilities () {\n        if (this.actor) return this.#buildSingleTokenUtilities()\n        this.#buildMultipleTokenUtilities()\n    }\n\n    /**\n     * Build utilities for a single token\n     * @private\n     */\n    #buildSingleTokenUtilities () {\n        if (!this.token) return\n        const actionsData = []\n\n        const actionType = 'utility'\n\n        // Build Toggle Combat action\n        const toggleCombatId = 'toggleCombat'\n        const toggleCombatName = this.token?.inCombat\n            ? Utils.i18n('tokenActionHud.removeFromCombat')\n            : Utils.i18n('tokenActionHud.addToCombat')\n        const toggleCombatEncodedValue = [\n            actionType,\n            toggleCombatId\n        ].join(DELIMITER)\n        const toggleCombatAction = {\n            id: toggleCombatId,\n            name: toggleCombatName,\n            encodedValue: toggleCombatEncodedValue\n        }\n        actionsData.push(toggleCombatAction)\n\n        // Build Toggle Visibility action\n        if (game.user.isGM) {\n            const toggleVisibilityId = 'toggleVisibility'\n            const toggleVisibilityName = this.token?.document?.hidden\n                ? Utils.i18n('tokenActionHud.makeVisible')\n                : Utils.i18n('tokenActionHud.makeInvisible')\n            const toggleVisbilityEncodedValue = [\n                actionType,\n                toggleVisibilityId\n            ].join(DELIMITER)\n            const toggleVisibilityAction = {\n                id: toggleVisibilityId,\n                name: toggleVisibilityName,\n                encodedValue: toggleVisbilityEncodedValue\n            }\n            actionsData.push(toggleVisibilityAction)\n        }\n\n        const groupData = { id: 'token', type: GROUP_TYPE.SYSTEM }\n\n        // Add actions to HUD\n        this.actionHandler.addActions(actionsData, groupData)\n    }\n\n    /**\n     * Build utilities for multiple tokens\n     * @private\n     */\n    #buildMultipleTokenUtilities () {\n        const tokens = Utils.getControlledTokens()\n        const actionsData = []\n\n        const actionType = 'utility'\n\n        // Toggle Combat\n        const toggleCombatId = 'toggleCombat'\n        const toggleCombatName = tokens.every((token) => token.inCombat)\n            ? Utils.i18n('tokenActionHud.removeFromCombat')\n            : Utils.i18n('tokenActionHud.addToCombat')\n        const toggleCombatEncodedValue = [actionType, toggleCombatId].join(DELIMITER)\n        const toggleCombatAction = {\n            id: toggleCombatId,\n            name: toggleCombatName,\n            encodedValue: toggleCombatEncodedValue\n        }\n        actionsData.push(toggleCombatAction)\n\n        // Toggle Visibility\n        if (game.user.isGM) {\n            const toggleVisibilityId = 'toggleVisibility'\n            const toggleVisibilityname = tokens.every((token) => token.document?.hidden)\n                ? Utils.i18n('tokenActionHud.makeVisible')\n                : Utils.i18n('tokenActionHud.makeInvisible')\n            const toggleVisbilityEncodedValue = [actionType, toggleVisibilityId].join(DELIMITER)\n            const toggleVisibilityAction = {\n                id: toggleVisibilityId,\n                name: toggleVisibilityname,\n                encodedValue: toggleVisbilityEncodedValue\n            }\n            actionsData.push(toggleVisibilityAction)\n        }\n\n        const groupData = { id: 'token', type: GROUP_TYPE.SYSTEM }\n\n        // Add actions to HUD\n        this.actionHandler.addActions(actionsData, groupData)\n    }\n}\n","import { ACTION_TYPE, COMPENDIUM_PACK_TYPES, DELIMITER } from '../constants.js'\nimport { Utils } from '../utils.js'\n\n/**\n * Handler for building the HUD's compendium actions.\n */\nexport class CompendiumActionHandler {\n    actionHandler\n    compendiumActions\n    packIds\n\n    constructor (actionHandler) {\n        this.actionHandler = actionHandler\n        this.compendiumActions = new Map()\n        this.packIds = []\n    }\n\n    /**\n     * Build compendium actions\n     */\n    async buildCompendiumActions () {\n        if (this.compendiumActions.size === 0) {\n            this.packIds = game.packs\n                .filter(\n                    (pack) =>\n                        COMPENDIUM_PACK_TYPES.includes(pack.documentName) &&\n              (game.version.startsWith('11') ? pack.visible : !pack.private || game.user.isGM)\n                )\n                .map((pack) => pack.metadata.id)\n\n            if (this.packIds.length === 0) return\n\n            await Promise.all(this.packIds.map(packId => this.#setCompendiumActions(packId)))\n        }\n\n        for (const pack of this.compendiumActions.values()) {\n            this.actionHandler.addActions(pack.actionsData, pack.groupData)\n        }\n    }\n\n    /**\n     * Set compendium actions into the compendiumActions map\n     * @param {string} packId The pack id\n     */\n    async #setCompendiumActions (packId) {\n        const pack = game.packs.get(packId)\n        const entries = pack ? pack.index.size > 0 ? pack.index : await pack.getIndex() : null\n        if (!entries) return\n        const actionType = this.#getCompendiumActionType(pack?.documentName)\n        const actionsData = entries.map((entry) => ({\n            id: entry._id,\n            name: entry.name,\n            encodedValue: [actionType, packId, entry._id].join(DELIMITER),\n            img: Utils.getImage(entry),\n            listName: `${Utils.i18n(ACTION_TYPE[actionType])}: ${entry.name}`\n        }))\n        const groupData = { id: this.#getGroupId(packId), type: 'core' }\n        this.compendiumActions.set(packId, { actionsData, groupData })\n    }\n\n    /**\n     * Get compendium action type based on documentName\n     * @param {string} documentName The pack document name\n     * @returns {string}            The compendium action type\n     */\n    #getCompendiumActionType (documentName) {\n        switch (documentName) {\n        case 'Macro':\n            return 'compendiumMacro'\n        case 'Playlist':\n            return 'compendiumPlaylist'\n        default:\n            return 'compendiumEntry'\n        }\n    }\n\n    /**\n     * @param {string} packId The pack id\n     * @returns {string}      The group id\n     */\n    #getGroupId (packId) {\n        return packId.replace('.', '-')\n    }\n\n    /**\n     * Whether the compendium is linked\n     * @public\n     * @param {string} packId The pack id\n     * @returns {boolean}     Whether the compendium is linked\n     */\n    isLinkedCompendium (packId) {\n        return (this.packIds.length)\n            ? this.packIds?.includes(packId)\n            : false\n    }\n}\n","import { DELIMITER, ACTION_TYPE } from '../constants.js'\nimport { Utils } from '../utils.js'\n\n/**\n * Handler for building the HUD's macro actions.\n */\nexport class MacroActionHandler {\n    actionHandler\n    macroActions\n\n    constructor (actionHandler) {\n        this.actionHandler = actionHandler\n        this.macroActions = null\n    }\n\n    /**\n     * Build macro actions\n     * @override\n     */\n    async buildMacroActions () {\n        if (!this.macroActions) {\n            const groupData = { id: 'macros', type: 'core' }\n            const actionsData = await this.#getActions()\n            this.macroActions = { actionsData, groupData }\n        }\n\n        this.actionHandler.addActions(this.macroActions.actionsData, this.macroActions.groupData)\n    }\n\n    /**\n     * Get actions\n     * @private\n     * @returns {object} The actions\n     */\n    async #getActions () {\n        const actionType = 'macro'\n        const macros = game.macros.filter((macro) => {\n            const permissions = macro.ownership\n            if (permissions[game.userId]) return permissions[game.userId] > 0\n            return permissions.default > 0\n        })\n        return macros.map((macro) => {\n            const id = macro.id\n            const name = macro.name\n            const actionTypeName = `${Utils.i18n(ACTION_TYPE[actionType])}: ` ?? ''\n            const listName = `${actionTypeName}${name}`\n            const encodedValue = [actionType, macro.id].join(DELIMITER)\n            const img = Utils.getImage(macro)\n            return {\n                id,\n                name,\n                listName,\n                encodedValue,\n                img\n            }\n        })\n    }\n}\n","import { DataHandler } from '../data-handler.js'\nimport { GenericActionHandler } from './generic-action-handler.js'\nimport { CompendiumActionHandler } from './compendium-action-handler.js'\nimport { MacroActionHandler } from './macro-action-handler.js'\nimport { COMPENDIUM_PACK_TYPES, DELIMITER, GROUP_TYPE } from '../constants.js'\nimport { Logger, Utils } from '../utils.js'\n\n/**\n * Handler for building the HUD.\n */\nexport class ActionHandler {\n    characterName = null\n    actor = null\n    token = null\n    furtherActionHandlers = []\n    delimiter = DELIMITER\n\n    constructor () {\n        this.genericActionHandler = new GenericActionHandler(this)\n        this.compendiumActionHandler = new CompendiumActionHandler(this)\n        this.macroActionHandler = new MacroActionHandler(this)\n        this.hud = []\n        this.defaultGroups = {}\n        this.defaultLayout = {}\n        this.groups = {}\n        this.actorGroups = {}\n        this.userGroups = {}\n        this.actions = []\n        this.availableActionsMap = new Map()\n        this.customLayoutSetting = Utils.getSetting('customLayout')\n        this.userCustomLayoutSetting = Utils.getSetting('userCustomLayout')\n        this.enableCustomizationSetting = Utils.getSetting('enableCustomization')\n        this.displayCharacterNameSetting = Utils.getSetting('displayCharacterName')\n        this.sortActionsSetting = Utils.getSetting('sortActions')\n        this.tooltipsSetting = Utils.getSetting('tooltips')\n    }\n\n    /**\n     * Reset action handler variables except actorGroups and userGroups\n     * @public\n     */\n    softResetActionHandler () {\n        this.genericActionHandler = new GenericActionHandler(this)\n        this.hud = []\n        this.defaultGroups = {}\n        this.defaultLayout = {}\n        this.groups = {}\n        this.actions = []\n        this.availableActionsMap = new Map()\n    }\n\n    /**\n     * Reset all action handler variables\n     * @public\n     */\n    hardResetActionHandler () {\n        this.softResetActionHandler()\n        this.customLayoutSetting = Utils.getSetting('customLayout')\n        this.userCustomLayoutSetting = Utils.getSetting('userCustomLayout')\n        this.customLayout = null\n        this.actorGroups = {}\n        this.userGroups = {}\n    }\n\n    /**\n     * Register default categories from the Token Action Hud system module\n     * @public\n     */\n    async registerDefaultCategories () {}\n\n    /**\n     * Build the HUD\n     * @public\n     * @returns {object} The HUD\n     */\n    async buildHud (options) {\n        Logger.debug('Building HUD...', { actor: this.actor, token: this.token })\n        if (this.previousActor?.id === this.actor?.id) {\n            this.isSameActor = true\n        } else {\n            this.previousActor = this.actor\n            this.isSameActor = false\n        }\n        this.softResetActionHandler()\n        await Promise.all([\n            this.#getDefaultGroups(),\n            this.#getDefaultLayout(),\n            this.#getCustomLayout()\n        ])\n        if (!DataHandler.canGetData() && !this.isGmInactiveUserNotified) {\n            Logger.info('Cannot retrieve HUD layout without GM present', true)\n            this.isGmInactiveUserNotified = true\n        }\n        await Promise.all([\n            this.#getSavedUserGroups(),\n            this.#getSavedActorGroups()\n        ])\n        this.hud = await this.#prepareHud()\n        await Promise.all([\n            this.#buildSystemActions(),\n            this.#buildGenericActions(),\n            this.#buildCompendiumActions(),\n            this.#buildMacroActions()\n        ])\n        this.buildFurtherActions()\n        this.#updateNonPresetActions()\n        this.#setHasActions()\n        this.#setCharacterLimit()\n        await this.saveGroups(options)\n        Logger.debug('HUD built', { hud: this.hud, actor: this.actor, token: this.token })\n        return this.hud\n    }\n\n    /**\n     * Prepare the HUD\n     * @private\n     * @returns {object} The HUD\n     */\n    async #prepareHud () {\n        Logger.debug('Preparing HUD...', { actor: this.actor, token: this.token })\n\n        const title = (this.displayCharacterNameSetting)\n            ? this.characterName ?? 'Multiple'\n            : ''\n        const actorId = this.actor?.id ?? 'multi'\n        const tokenId = this.token?.id ?? 'multi'\n        const hud = {\n            title,\n            tokenId,\n            actorId,\n            groups: []\n        }\n\n        if (Object.keys(this.userGroups).length) {\n            const userGroups = this.#getUserGroups()\n            for (const userGroup of userGroups) {\n                if (userGroup.level === 1) {\n                    const group = this.#createGroup(userGroup)\n                    hud.groups.push(group)\n                    this.groups[group.nestId] = group\n                } else {\n                    const parentNestId = userGroup.nestId.split('_', userGroup.level - 1).join('_')\n                    const parentGroup = await Utils.getGroupByNestId(hud.groups, { nestId: parentNestId })\n                    if (parentGroup) {\n                        const group = this.#createGroup(userGroup)\n                        if (group.settings.style === 'tab') {\n                            parentGroup.groups.tabs.push(group)\n                        } else {\n                            parentGroup.groups.lists.push(group)\n                        }\n                        this.groups[group.nestId] = group\n                    }\n                }\n            }\n        }\n\n        if (Object.keys(this.actorGroups).length) {\n            const actorGroups = this.#getActorGroups()\n            for (const actorGroup of actorGroups) {\n                const parentNestId = actorGroup.nestId.split('_', actorGroup.level - 1).join('_')\n                const existingGroup = await Utils.getGroupByNestId(hud.groups, { nestId: actorGroup.nestId })\n                if (existingGroup) {\n                    if (actorGroup.actions?.length) {\n                        existingGroup.actions = actorGroup.actions\n                        this.actions.push(...existingGroup.actions)\n                        for (const action of existingGroup.actions) {\n                            action.selected = false\n                        }\n                    }\n                } else {\n                    const parentGroup = await Utils.getGroupByNestId(hud.groups, { nestId: parentNestId })\n                    if (parentGroup && actorGroup.type === 'system-derived') {\n                        const group = this.#createGroup(actorGroup)\n                        if (actorGroup.actions?.length) {\n                            group.actions = actorGroup.actions\n                            this.actions.push(...group.actions)\n                            for (const action of group.actions) {\n                                action.selected = false\n                            }\n                        }\n                        if (group.settings.style === 'tab') {\n                            parentGroup.groups.tabs.push(group)\n                        } else {\n                            parentGroup.groups.lists.push(group)\n                        }\n                        this.groups[group.nestId] = group\n                    }\n                }\n            }\n        }\n\n        Logger.debug('HUD prepared', { hud, actor: this.actor, token: this.token })\n        return hud\n    }\n\n    /**\n     * Placeholder function for the system module\n     * @public\n     */\n    async buildSystemActions (groupIds) {}\n\n    /**\n     * Build system-specific actions\n     * @private\n     */\n    async #buildSystemActions () {\n        Logger.debug('Building system actions...', { actor: this.actor, token: this.token })\n        const groupIds = Object.values(this.groups).map(group => group.id)\n        await this.buildSystemActions(groupIds)\n        Logger.debug('System actions built', { hud: this.hud, actor: this.actor, token: this.token })\n    }\n\n    /**\n     * Build compendium-specific actions\n     * @private\n     */\n    async #buildCompendiumActions () {\n        Logger.debug('Building compendium actions...')\n        await this.compendiumActionHandler.buildCompendiumActions()\n        Logger.debug('Compendium actions built', { hud: this.hud })\n    }\n\n    /**\n     * Build generic actions\n     * @private\n     */\n    #buildGenericActions () {\n        Logger.debug('Building generic actions...', { actor: this.actor, token: this.token })\n        this.genericActionHandler.buildGenericActions()\n        Logger.debug('Generic actions built', { hud: this.hud, actor: this.actor, token: this.token })\n    }\n\n    /**\n     * Build macro-specific actions\n     * @private\n     */\n    async #buildMacroActions () {\n        Logger.debug('Building macro actions...')\n        await this.macroActionHandler.buildMacroActions()\n        Logger.debug('Macro actions built', { hud: this.hud })\n    }\n\n    /**\n     * Build further actions\n     * @private\n     */\n    buildFurtherActions () {\n        this.furtherActionHandlers.forEach(handler => handler.extendActionList())\n    }\n\n    /**\n     * Update non-preset actions\n     * @private\n     */\n    #updateNonPresetActions () {\n        const nonPresetActions = this.actions.filter(action => !action?.isPreset)\n\n        for (const nonPresetAction of nonPresetActions) {\n            const availableAction = this.availableActionsMap.get(nonPresetAction.id)\n\n            if (availableAction) {\n                const systemSelected = availableAction.systemSelected ?? nonPresetAction.systemSelected\n                const userSelected = nonPresetAction.userSelected ?? availableAction.userSelected\n                Object.assign(nonPresetAction, this.#createAction({ ...availableAction, systemSelected, userSelected }))\n            }\n        }\n    }\n\n    /**\n     * Set property to indicate whether a group has actions within it\n     * @private\n     */\n    #setHasActions () {\n        for (const group of Object.values(this.groups)) {\n            if (group.actions.some(action => action.selected)) {\n                group.hasActions = true\n            } else {\n                group.hasActions = false\n            }\n        }\n    }\n\n    /**\n     * Get the default groups\n     * @private\n     */\n    #getDefaultGroups () {\n        const defaultGroups = (game.tokenActionHud.defaults?.groups?.length)\n            ? game.tokenActionHud.defaults?.groups\n            : game.tokenActionHud.defaults?.subcategories\n        if (!defaultGroups) return {}\n        for (const defaultGroup of defaultGroups) {\n            this.defaultGroups[defaultGroup.id] = defaultGroup\n        }\n    }\n\n    /**\n     * Get the default layout\n     * @private\n     */\n    async #getDefaultLayout () {\n        if (Object.keys(this.defaultLayout).length) return\n        const defaultLayout = (game.tokenActionHud.defaults?.layout?.length)\n            ? game.tokenActionHud.defaults?.layout\n            : game.tokenActionHud.defaults?.categories\n        if (!defaultLayout) return {}\n        this.defaultLayout = await Utils.getNestedGroups(defaultLayout)\n    }\n\n    /**\n     * Get custom layout\n     * @private\n     */\n    async #getCustomLayout () {\n        if (this.customLayout) return\n        const file = this.userCustomLayoutSetting || this.customLayoutSetting || null\n        this.customLayout = (file) ? await DataHandler.getDataAsGm({ file }) : null\n    }\n\n    /**\n     * Export layout to file\n     */\n    async exportLayout () {\n        const data = await DataHandler.getDataAsGm({ type: 'user', id: game.userId }) ?? this.customLayout ?? this.defaultLayout\n        if (data) {\n            saveDataToFile(JSON.stringify(data, null, 2), 'text/json', 'token-action-hud-layout.json')\n        }\n    }\n\n    /**\n     * Get the saved groups from the actor flag\n     * @private\n     */\n    async #getSavedActorGroups () {\n        if (!this.actor) return\n\n        if (!this.enableCustomizationSetting) {\n            this.actorGroups = {}\n            return\n        }\n\n        if (this.isSameActor && Object.entries(this.actorGroups).length) return\n\n        if (!DataHandler.canGetData()) {\n            this.actorGroups = {}\n            return\n        }\n\n        Logger.debug('Retrieving groups from actor...', { actor: this.actor })\n        this.actorGroups = {}\n        const actorGroups = await DataHandler.getDataAsGm({ type: 'actor', id: this.actor.id }) ?? null\n        if (!actorGroups) return\n        for (const group of Object.entries(actorGroups)) {\n            group[1].nestId = group[0]\n        }\n        this.actorGroups = actorGroups\n        Logger.debug('Groups from actor retrieved', { actorGroups: this.actorGroups, actor: this.actor })\n    }\n\n    /**\n     * Get the saved groups from the user flag\n     * @private\n     */\n    async #getSavedUserGroups () {\n        const user = game.user\n        const layout = this.customLayout ?? this.defaultLayout\n\n        const getUserGroups = (data) => {\n            const userGroups = Object.keys(data).length ? data : layout\n            for (const group of Object.entries(userGroups)) {\n                group[1].nestId = group[0]\n            }\n            return userGroups\n        }\n\n        if (!this.enableCustomizationSetting) {\n            this.userGroups = getUserGroups(layout)\n            return\n        }\n\n        if (Object.entries(this.userGroups).length) return\n\n        if (!DataHandler.canGetData()) {\n            this.userGroups = getUserGroups(layout)\n            return\n        }\n\n        Logger.debug('Retrieving groups from user...', { user })\n        this.userGroups = {}\n        const savedUserData = await DataHandler.getDataAsGm({ type: 'user', id: user.id }) ?? {}\n        this.userGroups = getUserGroups(savedUserData)\n        Logger.debug('Groups retrieved from user', { userGroups: this.userGroups, user })\n    }\n\n    /**\n     * Get first matching action group based on criteria\n     * @public\n     * @param {object} [data = {}] The search data\n     * @returns {array}            The groups\n     */\n    getGroup (data = {}) {\n        if (data?.nestId) {\n            return this.groups[data.nestId]\n        } else {\n            return Object.values(this.groups).find(\n                group =>\n                    (!data.id || group.id === data.id) &&\n                    (!data.type || group.type === data.type) &&\n                    (!data.level || group.level === data.level)\n            )\n        }\n    }\n\n    /**\n     * Get groups based on criteria\n     * @private\n     * @param {object} [data = {}] The search data\n     * @returns {array}            The groups\n     */\n    #getGroups (data = {}) {\n        return Object.values(this.groups).filter(\n            group =>\n                (!data.id || group.id === data.id) &&\n                (!data.nestId || group.nestId.startsWith(data.nestId)) &&\n                (!data.type || group.type === data.type) &&\n                (!data.level || group.level === data.level) &&\n                (!data.selected || group.selected === data.selected)\n        )\n    }\n\n    /**\n     * Get actor-related groups based on criteria\n     * @private\n     * @param {object} [data = {}] The search data\n     * @returns {array}            The groups\n     */\n    #getActorGroups (data = {}) {\n        return Object.values(this.actorGroups)\n            .filter(group =>\n                (!data.id || group.id === data.id) &&\n                (!data.nestId || group.nestId.startsWith(data.nestId)) &&\n                (!data.type || group.type === data.type) &&\n                (!data.level || group.level === data.level)\n            )\n            .sort((a, b) => {\n                if (a.level === b.level) {\n                    return a.order - b.order\n                } else {\n                    return a.level - b.level\n                }\n            })\n    }\n\n    /**\n     * Get user-related groups based on criteria\n     * @private\n     * @param {object} [data = {}] The search data\n     * @returns {array}            The groups\n     */\n    #getUserGroups (data = {}) {\n        return Object.values(this.userGroups)\n            .filter(group =>\n                (!data.id || group.id === data.id) &&\n                (!data.nestId || group.nestId.startsWith(data.nestId)) &&\n                (!data.type || group.type === data.type) &&\n                (!data.level || group.level === data.level)\n            )\n            .sort((a, b) => {\n                if (a.level === b.level) {\n                    return a.order - b.order\n                } else {\n                    return a.level - b.level\n                }\n            })\n    }\n\n    /**\n     * Get advanced options\n     * @public\n     * @param {object} groupData The group data\n     * @returns {object}         The group settings\n     */\n    getGroupSettings (groupData) {\n        const group = this.getGroup(groupData)\n        return group?.settings ?? null\n    }\n\n    /**\n     * Save group settings\n     * @param {object} groupData The group data\n     */\n    saveGroupSettings (groupData) {\n        const group = this.getGroup(groupData)\n        group.settings = { ...group.settings, ...groupData.settings }\n        this.saveGroups({ saveActor: true, saveUser: true })\n    }\n\n    /**\n     * Create group\n     * @private\n     * @param {object} groupData The group data\n     * @returns {object}         The group\n     */\n    #createGroup (groupData, keepData = false) {\n        const groupDataClone = Utils.deepClone(groupData)\n        const nestIdParts = groupData.nestId.split('_')\n        const level = nestIdParts.length ?? 1\n\n        const tooltip = this.#getTooltip(groupData?.tooltip, groupDataClone?.name)\n\n        const actions = (keepData) ? (groupData?.actions ?? []) : []\n        const groups = (keepData) ? (groupData?.groups ?? { lists: [], tabs: [] }) : { lists: [], tabs: [] }\n\n        const defaultSettings = { showTitle: true, style: (level === 1) ? 'tab' : 'list' }\n        const groupSettings = groupDataClone?.settings ?? {}\n        groupSettings.showTitle ??= defaultSettings.showTitle\n        groupSettings.style ??= defaultSettings.style\n\n        groupDataClone.subtitleClass = (groupSettings.showTitle) ? '' : 'tah-hidden'\n\n        const commonProps =\n            {\n                actions,\n                class: groupDataClone?.class ?? groupDataClone?.cssClass ?? '',\n                groups,\n                id: groupDataClone?.id,\n                info1: groupDataClone?.info1 ?? '',\n                info2: groupDataClone?.info2 ?? '',\n                info3: groupDataClone?.info3 ?? '',\n                level: groupDataClone.level ?? level ?? 1,\n                listName: groupDataClone?.listName ?? groupDataClone?.name,\n                name: groupDataClone?.name,\n                nestId: groupDataClone?.nestId ?? groupDataClone?.id,\n                order: groupDataClone.order,\n                selected: groupDataClone?.selected ?? groupDataClone?.isSelected ?? groupDataClone?.defaultSelected ?? true,\n                settings: groupSettings,\n                tooltip,\n                type: groupDataClone?.type ?? GROUP_TYPE.CUSTOM\n            }\n\n        if (level === 1) {\n            return {\n                ...commonProps\n            }\n        } else {\n            return {\n                ...commonProps,\n                subtitleClass: groupDataClone?.subtitleClass ?? ''\n            }\n        }\n    }\n\n    /**\n     * Update groups\n     * @public\n     * @param {array|object} groupsData         The groups data\n     * @param {object} [parentGroupData = null] The parent group data\n     */\n    updateGroups (groupsData, parentGroupData) {\n        if (!Array.isArray(groupsData)) groupsData = [groupsData]\n\n        const level = (parentGroupData?.level ?? 0) + 1\n        const childGroupData = { level }\n        if (parentGroupData?.nestId) childGroupData.nestId = parentGroupData.nestId\n\n        const existingGroups = this.#getGroups(childGroupData)\n\n        // Remove any groups that are no longer present\n        for (const existingGroup of existingGroups) {\n            if (existingGroup.type === 'system-derived') {\n                existingGroup.selected = false\n            } else {\n                if (!groupsData.find(groupData => groupData.id === existingGroup.id)) {\n                    delete this.groups[existingGroup.nestId]\n                }\n            }\n        }\n\n        // Add or update groups\n        let order = 0\n        for (const groupData of groupsData) {\n            groupData.nestId = (parentGroupData?.nestId)\n                ? `${parentGroupData.nestId}_${groupData.id}`\n                : groupData.id\n            groupData.selected = groupData.selected ?? true\n            groupData.order = order\n\n            const existingGroup = this.getGroup(groupData)\n\n            if (existingGroup) {\n                Object.assign(existingGroup, groupData)\n            } else {\n                const group = this.#createGroup(groupData)\n                this.groups[groupData.nestId] = group\n            }\n            order++\n        }\n\n        // Update parent group settings\n        if (parentGroupData?.settings) {\n            const existingParentGroup = this.getGroup(parentGroupData)\n            if (existingParentGroup) {\n                existingParentGroup.settings = parentGroupData.settings\n            }\n        }\n    }\n\n    /**\n     * Save groups\n     * @public\n     */\n    async saveGroups (options = { saveActor: false, saveUser: false }) {\n        if (!this.enableCustomizationSetting) return\n        Logger.debug('Saving groups...')\n        if (options?.saveActor) await this.#saveActorGroups()\n        if (options?.saveUser) await this.#saveUserGroups()\n        Logger.debug('Groups saved', { groups: this.groups })\n    }\n\n    /**\n     * Save groups to the actor flag\n     * @private\n     */\n    async #saveActorGroups () {\n        if (!Object.keys(this.groups).length) return\n        Logger.debug('Saving actor groups...')\n        const actorGroups = {}\n        this.actorGroups = {}\n        for (const group of Object.values(this.groups)) {\n            this.actorGroups[group.nestId] = group\n            actorGroups[group.nestId] = this.#getReducedGroupData(group, true)\n        }\n        if (DataHandler.canSaveData()) {\n            await DataHandler.saveDataAsGm('actor', this.actor.id, actorGroups)\n            Logger.debug('Actor groups saved', { actorGroups })\n        } else {\n            Logger.debug('Actor groups not saved as no GM present')\n        }\n    }\n\n    /**\n     * Save groups to the user flag\n     * @private\n     */\n    async #saveUserGroups () {\n        if (!Object.keys(this.groups).length) return\n        Logger.debug('Saving user groups...')\n        const userGroups = {}\n        this.userGroups = {}\n        for (const group of Object.values(this.groups)) {\n            if (group.type !== 'system-derived') {\n                this.userGroups[group.nestId] = group\n                userGroups[group.nestId] = this.#getReducedGroupData(group, false)\n            }\n        }\n        if (DataHandler.canSaveData()) {\n            await DataHandler.saveDataAsGm('user', game.userId, userGroups)\n            Logger.debug('User groups saved', { userGroups })\n        } else {\n            Logger.debug('User groups not saved as no GM present')\n        }\n    }\n\n    /**\n     * Get reduced groups data for saving to flags\n     * @param {object} groupData    The group data\n     * @param {boolean} keepActions Whether to keep action data\n     * @returns                     The reduced group data\n     */\n    #getReducedGroupData (groupData, keepActions = false) {\n        const data = {\n            id: groupData.id,\n            name: groupData.name,\n            listName: groupData.listName,\n            selected: groupData.selected,\n            level: groupData.level,\n            order: groupData.order,\n            settings: groupData.settings,\n            type: groupData.type\n        }\n        if (keepActions) {\n            data.actions = groupData.actions.map(action => {\n                return {\n                    id: action.id,\n                    isPreset: action.isPreset,\n                    userSelected: action.userSelected\n                }\n            })\n        }\n        return data\n    }\n\n    /**\n     * Get actions by id\n     * @private\n     * @param {object} actionData The action data\n     * @returns {array}           The actions\n     */\n    #getActions (actionData) {\n        return this.actions.filter(action => action.id === actionData.id)\n    }\n\n    /**\n     * Get tooltip based on module setting\n     * @param {string} tooltip The tooltip\n     * @param {string} name    The name\n     * @returns {string}       The tooltip\n     */\n    #getTooltip (tooltip, name) {\n        if (this.tooltipsSetting === 'none') return null\n        if (this.tooltipsSetting === 'nameOnly') return name\n        if (this.tooltipsSetting === 'full' && tooltip) {\n            return (tooltip.includes('tah-tooltip-wrapper'))\n                ? tooltip\n                : `<div class=\"tah-tooltip-wrapper\">${tooltip}</div>`\n        }\n        return name\n    }\n\n    /**\n     * Create action\n     * @private\n     * @param {object} actionData The action data\n     * @returns {object}          The action\n     */\n    #createAction (actionData) {\n        const fullName = actionData.fullName ?? actionData.name\n        const tooltip = this.#getTooltip(actionData?.tooltip, fullName)\n        return {\n            encodedValue: actionData.encodedValue,\n            id: actionData.id,\n            name: actionData.name,\n            fullName,\n            listName: actionData.listName ?? actionData.name,\n            cssClass: actionData.cssClass ?? '',\n            icons: actionData.icon ?? {},\n            icon1: actionData.icon1 ?? '',\n            icon2: actionData.icon2 ?? '',\n            icon3: actionData.icon3 ?? '',\n            img: actionData.img ?? '',\n            info1: {\n                class: actionData?.info1?.class ?? '',\n                icon: actionData?.info1?.icon ?? '',\n                text: actionData?.info1?.text ?? '',\n                title: actionData?.info1?.title ?? ''\n            },\n            info2: {\n                class: actionData?.info2?.class ?? '',\n                icon: actionData?.info2?.icon ?? '',\n                text: actionData?.info2?.text ?? '',\n                title: actionData?.info2?.title ?? ''\n            },\n            info3: {\n                class: actionData?.info3?.class ?? '',\n                icon: actionData?.info3?.icon ?? '',\n                text: actionData?.info3?.text ?? '',\n                title: actionData?.info3?.title ?? ''\n            },\n            isAction: true,\n            isItem: actionData.isitem ?? null,\n            isPreset: actionData.isPreset ?? false,\n            userSelected: actionData.userSelected ?? true,\n            systemSelected: actionData.systemSelected ?? true,\n            selected: (!actionData.systemSelected)\n                ? false\n                : actionData.userSelected ?? actionData.systemSelected ?? true,\n            tooltip,\n            useRawHtmlName: actionData.useRawHtmlName ?? false\n        }\n    }\n\n    /**\n     * Update actions\n     * @public\n     * @param {array} actionsData The actions data\n     * @param {object} groupData  The group data\n     */\n    updateActions (actionsData, groupData) {\n        const group = this.getGroup(groupData)\n        const actions = group.actions\n\n        const reorderedActions = []\n\n        // Set 'selected' to true for selected actions\n        // Reorder actions based on order in dialog\n        for (const actionData of actionsData) {\n            if (actionData.id.includes('itemMacro')) continue\n            const existingAction = group.actions.find(action => action.id === actionData.id)\n            if (existingAction) {\n                const actionClone = { ...existingAction, userSelected: true }\n                reorderedActions.push(actionClone)\n            } else {\n                const availableAction = this.availableActionsMap.get(actionData.id)\n                if (availableAction) {\n                    const actionClone = { ...availableAction, userSelected: true }\n                    reorderedActions.push(actionClone)\n                }\n            }\n        }\n        // Set 'selected' to false for unselected actions\n        for (const action of actions) {\n            if (!action.id || action?.id.includes('itemMacro')) continue\n\n            const actionData = actionsData.find(actionData => actionData.id === action.id)\n            if (!actionData && action.isPreset) {\n                const actionClone = { ...action, userSelected: false }\n                reorderedActions.push(actionClone)\n            }\n        }\n\n        // Sort actions alphabetically\n        if (groupData?.settings?.sort || (typeof groupData?.settings?.sort === 'undefined' && this.sortActionsSetting)) {\n            reorderedActions.sort((a, b) => a.name.localeCompare(b.name))\n        }\n\n        // Replace group actions\n        group.actions = reorderedActions\n    }\n\n    /**\n     * Add to available actions\n     * @private\n     * @param {array} actionsMap The actions\n     */\n    #addToAvailableActions (actionsMap) {\n        actionsMap.forEach((action, actionId) => {\n            if (!this.availableActionsMap.has(actionId)) this.availableActionsMap.set(actionId, action)\n        })\n    }\n\n    /**\n     * Get available actions as Tagify entries\n     * @public\n     * @param {object} groupData The group data\n     * @returns {array}          The available actions\n     */\n    getAvailableActions () {\n        return [...this.availableActionsMap.values()].map(action => this.#toActionTagifyEntry(action)).sort((a, b) => a.value.localeCompare(b.value))\n    }\n\n    /**\n     * Get selected actions as Tagify entries\n     * @public\n     * @param {object} groupData The group data\n     * @returns {array}          The selected actions\n     */\n    getSelectedActions (groupData) {\n        const group = this.getGroup(groupData)\n        if (!group) return\n        return group.actions\n            .filter(action => action.selected === true)\n            .map(action => this.#toActionTagifyEntry(action))\n    }\n\n    /**\n     * Get selected groups as Tagify entries\n     * @public\n     * @param {object} groupData The group data\n     * @returns {object}         The selected groups\n     */\n    getSelectedGroups (groupData = {}) {\n        groupData.selected = true\n        groupData.level = (groupData.level || 0) + 1\n        const groups = this.#getGroups(groupData)\n        return groups?.map(group => this.#toGroupTagifyEntry(group)) ?? []\n    }\n\n    /**\n     * Get available groups as Tagify entries\n     * @public\n     * @param {object} groupData The group data\n     * @returns {object}         The groups\n     */\n    async getAvailableGroups (groupData) {\n        const derivedGroups = await this.#getDerivedGroups(groupData)\n        const systemGroups = await this.#getSystemGroups()\n        const compendiumGroups = await this.#getCompendiumGroups()\n        const macroGroups = await this.#getMacroGroups()\n        return [...derivedGroups, ...systemGroups, ...compendiumGroups, ...macroGroups]\n    }\n\n    /**\n     * Get compendium groups as Tagify entries\n     * @private\n     * @returns {object} The compendium groups\n     */\n    #getCompendiumGroups () {\n        const packs = game.packs.filter(pack =>\n            COMPENDIUM_PACK_TYPES.includes(pack.documentName) &&\n            (game.version.startsWith('11') ? pack.visible : (!pack.private || game.user.isGM))\n        )\n        const groups = packs.map(pack => {\n            return {\n                id: pack.metadata.id.replace('.', '-'),\n                listName: `Group: ${pack.metadata.label}`,\n                name: pack.metadata.label,\n                type: 'core'\n            }\n        })\n        return groups.map(group => this.#toGroupTagifyEntry(group))\n    }\n\n    /**\n     * Get derived groups as Tagify entries\n     * @private\n     * @param {object} groupData The group data\n     * @returns {object}         The derived groups\n     */\n    #getDerivedGroups (groupData) {\n        const derivedGroups = this.#getGroups({\n            nestId: groupData?.nestId,\n            type: GROUP_TYPE.SYSTEM_DERIVED\n        })\n        return derivedGroups?.map(group => this.#toGroupTagifyEntry(group)) ?? []\n    }\n\n    /**\n     * Get macro groups as Tagify entries\n     * @private\n     * @returns {object} The macro groups\n     */\n    #getMacroGroups () {\n        return [this.#toGroupTagifyEntry({\n            id: 'macros',\n            listName: `Group: ${Utils.i18n('tokenActionHud.macros')}`,\n            name: Utils.i18n('tokenActionHud.macros'),\n            type: 'core'\n        })]\n    }\n\n    /**\n     * Get system groups as Tagify entries\n     * @private\n     * @returns {object} The system groups\n     */\n    #getSystemGroups () {\n        return Object.values(this.defaultGroups).map(group => this.#toGroupTagifyEntry(group))\n    }\n\n    /**\n     * Add group to the HUD\n     * @public\n     * @param {object} groupData         The group data\n     * @param {object} parentGroupData   The parent group data\n     * @param {boolean} [update = false] Whether to update an existing group\n     */\n    addGroup (groupData, parentGroupData, update = false) {\n        groupData.type = groupData?.type ?? 'system-derived'\n        groupData.style = groupData?.style ?? 'list'\n\n        if (!parentGroupData?.id && !parentGroupData?.nestId) return\n\n        const parentGroups = this.#getGroups(parentGroupData)\n        if (!parentGroups?.length) return\n\n        for (const parentGroup of parentGroups) {\n            const nestId = `${parentGroup.nestId}_${groupData.id}`\n            const existingGroups = this.#getGroups({ ...groupData, nestId })\n\n            if (existingGroups.length) {\n                if (update) {\n                    for (const existingGroup of existingGroups) {\n                        // Temporary fix until info1-3 properties are grouped into info object\n                        if (groupData.info) {\n                            Object.assign(groupData, { ...groupData.info })\n                            delete groupData.info\n                        }\n\n                        Object.assign(existingGroup, this.#createGroup({ ...existingGroup, ...groupData }, true))\n                    }\n                } else {\n                    for (const existingGroup of existingGroups) {\n                        const tooltip = this.#getTooltip(groupData.tooltip, existingGroup.name)\n                        Object.assign(existingGroup, { tooltip })\n                    }\n                }\n            } else {\n                const group = this.#createGroup({ ...groupData, nestId })\n                if (group.settings.style === 'tab') {\n                    parentGroup.groups.tabs.push(group)\n                } else {\n                    parentGroup.groups.lists.push(group)\n                }\n                this.groups[group.nestId] = group\n            }\n        }\n    }\n\n    /**\n     * Update group in the HUD\n     * @public\n     * @param {object} groupData                The group data\n     * @param {object} [parentGroupData = null] The parent group data\n     */\n    updateGroup (groupData, parentGroupData = null) {\n        groupData.type = groupData?.type ?? 'system-derived'\n\n        const updateExistingGroups = (existingGroups) => {\n            for (const existingGroup of existingGroups) {\n                // Temporary fix until info1-3 properties are grouped into info object\n                if (groupData.info) {\n                    Object.assign(groupData, { ...groupData.info })\n                    delete groupData.info\n                }\n\n                Object.assign(existingGroup, this.#createGroup({ ...existingGroup, ...groupData }, true))\n            }\n        }\n\n        if (parentGroupData) {\n            const parentGroups = this.#getGroups(parentGroupData)\n            for (const parentGroup of parentGroups) {\n                const nestId = `${parentGroup.nestId}_${groupData.id}`\n                const existingGroups = this.#getGroups({ ...groupData, nestId })\n\n                updateExistingGroups(existingGroups)\n            }\n        } else {\n            const existingGroups = this.#getGroups(groupData)\n\n            updateExistingGroups(existingGroups)\n        }\n    }\n\n    /**\n     * Remove group from HUD\n     * @public\n     * @param {object} groupData The group data\n     */\n    removeGroup (groupData) {\n        if (!groupData?.nestId && groupData?.id) {\n            Utils.deleteGroupsById(this.hud.groups, groupData.id)\n        }\n\n        const groups = this.#getGroups(groupData)\n        if (!groups?.length) return\n\n        for (const group of groups) {\n            delete this.groups[group.nestId]\n            if (groupData?.nestId) {\n                Utils.deleteGroupByNestId(this.hud.groups, group.nestId)\n            }\n        }\n    }\n\n    /**\n     * Add info to group in the HUD\n     * @public\n     * @param {string} groupData The group data\n     */\n    addGroupInfo (groupData) {\n        const groupId = groupData?.id\n        const groupInfo = groupData?.info\n\n        if (!groupId || !groupInfo) return\n\n        const groups = this.#getGroups(groupData)\n\n        groups.forEach(group => {\n            group.info1 = groupInfo.info1\n            group.info2 = groupInfo.info2\n            group.info3 = groupInfo.info3\n        })\n    }\n\n    /**\n     * Add actions to the HUD\n     * @public\n     * @param {object} actionsData The actions data\n     * @param {object} groupData   The group data\n     */\n    addActions (actionsData, groupData) {\n        if (!actionsData.length) return\n\n        // Create actions\n        const actions = new Map(actionsData.map(actionData => [actionData.id, this.#createAction(actionData)]))\n        this.#addToAvailableActions(actions)\n\n        if (!groupData?.id) return\n\n        const groups = this.#getGroups(groupData)\n\n        if (!groups) return\n\n        for (const group of groups) {\n            // Get existing actions\n            const existingActions = new Map(group.actions.map(action => [action.id, action]))\n\n            const reorderedActions = []\n\n            // Loop the previously saved actions in the group\n            existingActions.forEach((existingAction, existingActionId) => {\n                const action = actions.get(existingActionId)\n                if (action) {\n                    const systemSelected = action.systemSelected ?? existingAction.systemSelected\n                    const userSelected = existingAction.userSelected ?? action.userSelected\n                    const selected = (!systemSelected)\n                        ? false\n                        : userSelected ?? systemSelected ?? true\n                    Object.assign(existingAction, { ...action, isPreset: true, selected, systemSelected, userSelected })\n                } else if (!existingAction.selected && existingAction.isPreset) {\n                    const systemSelected = false\n                    Object.assign(existingAction, this.#createAction({ ...existingAction, systemSelected }))\n                }\n            })\n\n            // Loop the generated actions and add any not previously saved\n            actions.forEach((action, actionId) => {\n                const existingAction = existingActions.get(actionId)\n                if (!existingAction) reorderedActions.push(this.#createAction({ ...action, isPreset: true }))\n            })\n\n            // Sort actions alphabetically\n            if (groupData?.settings?.sort || (typeof groupData?.settings?.sort === 'undefined' && this.sortActionsSetting)) {\n                reorderedActions.sort((a, b) => a.name.localeCompare(b.name))\n            }\n\n            // Add actions to group\n            group.actions.push(...reorderedActions)\n        }\n    }\n\n    /**\n     * Set character limit for action names based on the 'Character per Word' setting\n     * @private\n     */\n    #setCharacterLimit () {\n        const topLevelGroups = this.#getGroups({ level: 1 })\n\n        for (const topLevelGroup of topLevelGroups) {\n            const topLevelGroupCharacterCount = topLevelGroup?.settings?.characterCount\n\n            const groups = this.#getGroups({ nestId: topLevelGroup.nestId })\n\n            for (const group of groups) {\n                const actions = group.actions\n\n                if (!actions || actions?.length === 0) continue\n\n                const groupCharacterCount = group?.settings?.characterCount\n                const characterCount = (groupCharacterCount >= 0)\n                    ? topLevelGroupCharacterCount\n                    : groupCharacterCount\n\n                // Exit if character limit is not defined\n                if ((!characterCount && characterCount !== 0) || characterCount < 0) continue\n\n                for (const action of actions) {\n                    if (action.name.length <= characterCount) continue\n                    if (characterCount === 0) {\n                        action.name = ''\n                        continue\n                    }\n                    // Set each word to the character limit\n                    action.name = action.name\n                        .split(' ')\n                        .map(word => word.slice(0, characterCount))\n                        .join(' ')\n                }\n            }\n        }\n    }\n\n    /**\n     * Add further action handler\n     * @public\n     * @param {object} handler The handler\n     */\n    addFurtherActionHandler (handler) {\n        Logger.debug('Adding further action handler...', { handler })\n        this.furtherActionHandlers.push(handler)\n    }\n\n    /**\n     * Convert group into Tagify entry\n     * @private\n     * @param {object} data\n     * @returns {object}\n     */\n    #toGroupTagifyEntry (data) {\n        return {\n            id: data.id,\n            name: data.name,\n            type: data.type,\n            value: data.listName ?? data.name\n        }\n    }\n\n    /**\n     * Convert action into Tagify entry\n     * @private\n     * @param {object} data The data\n     * @returns {object}    Tagify entry\n     */\n    #toActionTagifyEntry (data) {\n        return {\n            id: data.id,\n            name: data.name,\n            type: 'action',\n            value: data.listName ?? data.name\n        }\n    }\n\n    /** DEPRECATED */\n\n    addActionsToActionList (actionsData, groupData) {\n        globalThis.logger.warn('Token Action HUD | ActionHandler.addActionsToActionList is deprecated. Use ActionHandler.addActions')\n        this.addActions(actionsData, groupData)\n    }\n\n    addSubcategoryInfo (groupData) {\n        globalThis.logger.warn('Token Action HUD | ActionHandler.addSubcategoryInfo is deprecated. Use ActionHandler.addGroupInfo')\n        this.addGroupInfo(groupData)\n    }\n\n    addSubcategoryToActionList (parentGroupData, groupData, update = false) {\n        globalThis.logger.warn('Token Action HUD | ActionHandler.addSubcategoryToActionList is deprecated. Use ActionHandler.addGroup')\n        this.addGroup(groupData, parentGroupData, update)\n    }\n\n    sortItems (items) {\n        globalThis.logger.warn('ActionHandler.sortItems is deprecated. Use Utils.sortItems')\n        return Utils.sortItems(items)\n    }\n\n    sortItemsByName (items) {\n        globalThis.logger.warn('ActionHandler.sortItemsByName is deprecated. Use Utils.sortItemsByName')\n        return Utils.sortItemsByName(items)\n    }\n}\n","import { ActionHandler } from './action-handler.js'\n\n/**\n * An extension of the base ActionHandler which extends the HUD via core or system modules.\n */\nexport class ActionListExtender extends ActionHandler {\n    extendActionList () {}\n}\n","import { MODULE } from './constants.js'\nimport { isPersistentStorage, DataHandler } from './data-handler.js'\nimport { Logger, Utils } from './utils.js'\n\n/**\n * Manages migrations between module versions\n */\nexport class MigrationManager {\n    constructor (socket) {\n        this.socket = socket\n    }\n\n    /**\n     * Initialise migrations\n     * @public\n     */\n    async init () {\n        if (!game.user.isGM) return\n\n        const moduleVersion = game.modules.get('token-action-hud-core').version\n        const migrationVersion = Utils.getSetting('migrationVersion')\n        if (moduleVersion === migrationVersion) return\n\n        let isSuccess = true\n        isSuccess = (!migrationVersion || migrationVersion < '1.4.10') ? await this.#unsetOldFlags() : true\n        isSuccess = (isPersistentStorage() && (!migrationVersion || migrationVersion < '1.4.11')) ? await this.#migrateFiles() : true\n\n        if (isSuccess) {\n            Utils.setSetting('migrationVersion', moduleVersion)\n        }\n    }\n\n    /**\n     * Unset old flags\n     * @private\n     */\n    async #unsetOldFlags () {\n        try {\n            const users = game.users.filter(user => user.getFlag(MODULE.ID, 'categories'))\n            for (const user of users) {\n                user.unsetFlag(MODULE.ID, 'categories')\n                user.unsetFlag(MODULE.ID, 'defaults')\n            }\n\n            const actors = game.actors.filter(actor => actor.getFlag(MODULE.ID, 'categories'))\n            for (const actor of actors) {\n                actor.unsetFlag(MODULE.ID, 'categories')\n            }\n\n            const tokens = game.canvas.tokens.objects.children.filter(token => token.actor?.getFlag(MODULE.ID, 'categories'))\n            for (const token of tokens) {\n                token.actor?.unsetFlag(MODULE.ID, 'categories')\n            }\n\n            for (const scene of game.scenes) {\n                const tokens = scene.tokens.filter(token => token.actor?.getFlag(MODULE.ID, 'categories'))\n                for (const token of tokens) {\n                    token.actor?.unsetFlag(MODULE.ID, 'categories')\n                }\n            }\n\n            return true\n        } catch (err) {\n            Logger.debug(err.message, err)\n\n            return false\n        }\n    }\n\n    async #migrateFiles () {\n        try {\n            Logger.info('Migrating files to persistent storage...', true)\n            for (const user of game.users) {\n                const data = await DataHandler.getDataMigrate('user', user.id)\n                if (data) {\n                    await DataHandler.saveData('user', user.id, data)\n                }\n            }\n\n            for (const actor of game.actors) {\n                const data = await DataHandler.getDataMigrate('actor', actor.id)\n                if (data) {\n                    await DataHandler.saveData('actor', actor.id, data)\n                }\n            }\n            Logger.info('Successfully migrated files to persistent storage', true)\n            return true\n        } catch {\n            Logger.info('Failed to migrate files to persistent storage', true)\n            return false\n        }\n    }\n}\n","import { DELIMITER } from '../constants.js'\nimport { Logger, Utils } from '../utils.js'\n\n/**\n * Resolves core actions triggered from the HUD\n */\nexport class RollHandler {\n    actor = null\n    token = null\n    delimiter = DELIMITER\n    preRollHandlers = []\n\n    /**\n     * Throw error\n     * @public\n     * @param {*} err The error\n     */\n    throwInvalidValueErr (err) {\n        throw new Error(\n            `Error handling button click: ${err}`\n        )\n    }\n\n    /**\n     * Handle action events\n     * @public\n     * @param {object} event        The event\n     * @param {string} encodedValue The encoded value\n     */\n    async handleActionEvent (event, encodedValue, actionHandler) {\n        Logger.debug(`Handling event for action [${encodedValue}]`, { event })\n        // Update variables with current action context\n        this.actor = actionHandler.actor\n        this.token = actionHandler.token\n\n        this.registerKeyPresses(event)\n\n        let handled = false\n        this.preRollHandlers.forEach((handler) => {\n            if (handled) return\n\n            handled = handler.prehandleActionEvent(event, encodedValue, actionHandler)\n        })\n\n        if (handled) return\n\n        if (this.#isGenericAction(encodedValue)) {\n            await this.#handleGenericAction(encodedValue)\n        } else {\n            this.doHandleActionEvent(event, encodedValue)\n        }\n    }\n\n    /**\n     * Overide for the TAH system module\n     * @param {object} event        The event\n     * @param {string} encodedValue The encoded value\n     */\n    doHandleActionEvent (event, encodedValue) {}\n\n    /**\n     * Add a pre-roll handler\n     * @public\n     * @param {object} handler The roll handler\n     */\n    addPreRollHandler (handler) {\n        Logger.debug(`Adding pre-roll handler ${handler.constructor.name}`)\n        this.preRollHandlers.push(handler)\n    }\n\n    /**\n     * Registers key presses\n     * @public\n     * @param {object} event The events\n     */\n    registerKeyPresses (event) {\n        this.rightClick = this.isRightClick(event)\n        this.ctrl = this.isCtrl(event)\n        this.alt = this.isAlt(event)\n        this.shift = this.isShift(event)\n    }\n\n    /**\n     * Renders the item sheet\n     * @public\n     * @param {object} actor  The actor\n     * @param {string} itemId The item id\n     */\n    doRenderItem (actor, itemId) {\n        if (!actor) actor = this.actor\n        const item = Utils.getItem(actor, itemId)\n        item.sheet.render(true)\n    }\n\n    /**\n     * Whether the item sheet should be rendered\n     * @public\n     * @returns {boolean}\n     */\n    isRenderItem () {\n        return (\n            Utils.getSetting('renderItemOnRightClick') &&\n            this.rightClick &&\n            !(this.alt || this.ctrl || this.shift)\n        )\n    }\n\n    /**\n     * Whether the button was right-clicked\n     * @public\n     * @param {object} event The event\n     * @returns {boolean}\n     */\n    isRightClick (event) {\n        return event?.originalEvent?.button === 2\n    }\n\n    /**\n     * Whether the ALT key was pressed when the button was clicked\n     * @public\n     * @param {object} event The event\n     * @returns {boolean}\n     */\n    isAlt (event) {\n        const isModiferActive = game.keyboard.isModifierActive(KeyboardManager.MODIFIER_KEYS.ALT)\n        if (event.altKey && !isModiferActive) {\n            Logger.debug('Emulating LEFT ALT key press')\n            KeyboardManager.emulateKeypress(false, 'AltLeft', { altKey: true, force: true })\n            game.keyboard.downKeys.add('AltLeft')\n            return true\n        }\n        return isModiferActive\n    }\n\n    /**\n     * Whether the CTRL key was pressed when the button was clicked\n     * @public\n     * @param {object} event The event\n     * @returns {boolean}\n     */\n    isCtrl (event) {\n        const isModiferActive = game.keyboard.isModifierActive(KeyboardManager.MODIFIER_KEYS.CONTROL)\n        if (event.ctrlKey && !isModiferActive) {\n            Logger.debug('Emulating LEFT CTRL key press')\n            KeyboardManager.emulateKeypress(false, 'ControlLeft', { ctrlKey: true, force: true })\n            game.keyboard.downKeys.add('ControlLeft')\n            return true\n        }\n        return isModiferActive\n    }\n\n    /**\n     * Whether the SHIFT key was pressed when the button was clicked\n     * @public\n     * @param {object} event The event\n     * @returns {boolean}\n     */\n    isShift (event) {\n        const isModiferActive = game.keyboard.isModifierActive(KeyboardManager.MODIFIER_KEYS.SHIFT)\n        if (event.shiftKey && !isModiferActive) {\n            Logger.debug('Emulating LEFT SHIFT key press')\n            KeyboardManager.emulateKeypress(false, 'ShiftLeft', { shiftKey: true, force: true })\n            game.keyboard.downKeys.add('ShiftLeft')\n            return true\n        }\n        return isModiferActive\n    }\n\n    /**\n     * Whether the action is a generic action\n     * @private\n     * @param {string} encodedValue The encoded value\n     * @returns {boolean}           Whether the action is a generic action\n     */\n    #isGenericAction (encodedValue) {\n        const payload = encodedValue.split(DELIMITER)\n\n        const actionType = payload[0]\n        const actionId = payload[1]\n\n        return actionType === 'utility' && actionId.includes('toggle')\n    }\n\n    /**\n     * Handle generic action\n     * @private\n     * @param {string} encodedValue The encoded value\n     */\n    async #handleGenericAction (encodedValue) {\n        const payload = encodedValue.split(DELIMITER)\n        const actionId = payload[1]\n\n        const firstControlledToken = Utils.getFirstControlledToken()\n\n        if (actionId === 'toggleVisibility') await firstControlledToken.toggleVisibility()\n        if (actionId === 'toggleCombat') await firstControlledToken.toggleCombat()\n\n        Hooks.callAll('forceUpdateTokenActionHud')\n    }\n}\n","import { RollHandler } from './roll-handler.js'\n\n/*\n * Used for adding support for actions not part of the core functions.\n * Returns true from prehandleActionEvent() if it can perform an action and stops\n * further actions being performed.\n */\nexport class PreRollHandler extends RollHandler {\n    prehandleActionEvent (event, encodedValue) {\n        return false\n    }\n}\n","import { CUSTOM_STYLE, MODULE, TEMPLATE } from '../constants.js'\nimport { Utils } from '../utils.js'\n\nexport class CustomStyleForm extends FormApplication {\n    static get defaultOptions () {\n        return mergeObject(super.defaultOptions, {\n            title: Utils.i18n('tokenActionHud.settings.customStyle.form.title'),\n            template: TEMPLATE.customStyleForm,\n            id: 'token-action-hud-core-settings',\n            width: 600,\n            height: 600,\n            popOut: true,\n            resizable: true,\n            closeOnSubmit: true\n        })\n    }\n\n    constructor (...args) {\n        super(args)\n    }\n\n    getData () {\n        this.data = {\n            backgroundColor: Utils.getSetting('backgroundColor', CUSTOM_STYLE.backgroundColor.default),\n            buttonHeight: Utils.getSetting('buttonHeight', CUSTOM_STYLE.buttonHeight.default),\n            buttonBackgroundColor: Utils.getSetting('buttonBackgroundColor', CUSTOM_STYLE.buttonBackgroundColor.default),\n            buttonHoverBackgroundColor: Utils.getSetting('buttonHoverBackgroundColor', CUSTOM_STYLE.buttonHoverBackgroundColor.default),\n            buttonToggleActiveBackgroundColor: Utils.getSetting('buttonToggleActiveBackgroundColor', CUSTOM_STYLE.buttonToggleActiveBackgroundColor.default),\n            buttonToggleHoverBackgroundColor: Utils.getSetting('buttonToggleHoverBackgroundColor', CUSTOM_STYLE.buttonToggleHoverBackgroundColor.default),\n            buttonTextColor: Utils.getSetting('buttonTextColor', CUSTOM_STYLE.buttonTextColor.default),\n            buttonHoverTextColor: Utils.getSetting('buttonHoverTextColor', CUSTOM_STYLE.buttonHoverTextColor.default),\n            buttonToggleActiveTextColor: Utils.getSetting('buttonToggleActiveTextColor', CUSTOM_STYLE.buttonToggleActiveTextColor.default),\n            buttonToggleHoverTextColor: Utils.getSetting('buttonToggleHoverTextColor', CUSTOM_STYLE.buttonToggleHoverTextColor.default),\n            buttonBorderPrimaryColor: Utils.getSetting('buttonBorderPrimaryColor', CUSTOM_STYLE.buttonBorderPrimaryColor.default),\n            buttonBorderSecondaryColor: Utils.getSetting('buttonBorderSecondaryColor', CUSTOM_STYLE.buttonBorderSecondaryColor.default),\n            buttonHoverBorderPrimaryColor: Utils.getSetting('buttonHoverBorderPrimaryColor', CUSTOM_STYLE.buttonHoverBorderPrimaryColor.default),\n            buttonHoverBorderSecondaryColor: Utils.getSetting('buttonHoverBorderSecondaryColor', CUSTOM_STYLE.buttonHoverBorderSecondaryColor.default),\n            buttonToggleActiveBorderPrimaryColor: Utils.getSetting('buttonToggleActiveBorderPrimaryColor', CUSTOM_STYLE.buttonToggleActiveBorderPrimaryColor.default),\n            buttonToggleActiveBorderSecondaryColor: Utils.getSetting('buttonToggleActiveBorderSecondaryColor', CUSTOM_STYLE.buttonToggleActiveBorderSecondaryColor.default),\n            buttonToggleHoverBorderPrimaryColor: Utils.getSetting('buttonToggleHoverBorderPrimaryColor', CUSTOM_STYLE.buttonToggleHoverBorderPrimaryColor.default),\n            buttonToggleHoverBorderSecondaryColor: Utils.getSetting('buttonToggleHoverBorderSecondaryColor', CUSTOM_STYLE.buttonToggleHoverBorderSecondaryColor.default),\n            textPrimaryColor: Utils.getSetting('textPrimaryColor', CUSTOM_STYLE.textPrimaryColor.default),\n            textSecondaryColor: Utils.getSetting('textSecondaryColor', CUSTOM_STYLE.textSecondaryColor.default),\n            textTertiaryColor: Utils.getSetting('textTertiaryColor', CUSTOM_STYLE.textTertiaryColor.default),\n            textHoverPrimaryColor: Utils.getSetting('textHoverPrimaryColor', CUSTOM_STYLE.textHoverPrimaryColor.default),\n            textHoverSecondaryColor: Utils.getSetting('textHoverSecondaryColor', CUSTOM_STYLE.textHoverSecondaryColor.default),\n            textHoverTertiaryColor: Utils.getSetting('textHoverTertiaryColor', CUSTOM_STYLE.textHoverTertiaryColor.default)\n        }\n        return this.data\n    }\n\n    activateListeners (html) {\n        super.activateListeners(html)\n\n        const resetButtonElement = html.find('#tah-custom-style-reset-button')\n        resetButtonElement.on('click', this._reset.bind(this))\n\n        if (typeof ColorPicker !== 'undefined') { ColorPicker.install() }\n    }\n\n    _reset () {\n        for (const [key, value] of Object.entries(CUSTOM_STYLE)) {\n            Utils.setSetting(key, value.default)\n            document.querySelector(':root').style.setProperty(value.cssProperty, value.default)\n        }\n        this.render(true)\n    }\n\n    _updateObject (event, formData) {\n        for (const [key, value] of Object.entries(formData)) {\n            const customStyle = CUSTOM_STYLE[key]\n            if (value !== this.data[key]) {\n                Utils.setSetting(key, value)\n                document.querySelector(':root').style.setProperty(customStyle.cssProperty, value)\n            }\n        }\n    }\n}\n","import { CUSTOM_STYLE, MODULE, LAYOUT_SETTING, TEMPLATE } from '../constants.js'\nimport { Utils } from '../utils.js'\n\nexport class TahSettingsForm extends FormApplication {\n    static get defaultOptions () {\n        return mergeObject(super.defaultOptions, {\n            template: TEMPLATE.settings,\n            id: 'token-action-hud-core-settings',\n            width: 600,\n            height: 'auto',\n            closeOnSubmit: true\n        })\n    }\n\n    constructor (...args) {\n        super(args)\n    }\n\n    async getData () {\n        const settings = []\n        for (const [key, setting] of Object.entries(this.settings)) {\n            if (setting?.scope === 'world' && !game.user.isGM) continue\n            const id = key\n            const hint = Utils.i18n(setting.hint)\n            const icon = setting.icon\n            const label = Utils.i18n(setting.label)\n            const name = Utils.i18n(setting.name)\n            const value = (setting?.scope) ? await Utils.getSetting(key) : ''\n            const type = setting.type instanceof Function ? setting.type.name : 'String'\n            const isButton = setting.inputType === 'button'\n            const onClick = setting.onClick\n            const isCheckbox = setting.inputType === 'checkbox'\n            const isFilePicker = setting.inputType === 'filePicker'\n            const filePickerType = (setting.inputType === 'filePicker') ? type ?? 'any' : ''\n            const isNumber = setting.inputType === 'number'\n            const isRange = (setting.inputType === 'range') && setting.range\n            const isSelect = setting.choices !== undefined\n            settings.push({\n                id,\n                hint,\n                icon,\n                label,\n                name,\n                value,\n                type,\n                isButton,\n                onClick,\n                isCheckbox,\n                isFilePicker,\n                filePickerType,\n                isNumber,\n                isRange,\n                isSelect\n            })\n        }\n        return { settings }\n    }\n\n    activateListeners (html) {\n        super.activateListeners(html)\n\n        super.activateListeners(html)\n        const cancel = html.find('#tah-form-cancel')\n        cancel.on('click', this.close.bind(this))\n    }\n\n    _updateObject (event, formData) {\n        for (const [key, value] of Object.entries(formData)) {\n            if (this.settings[key].scope) {\n                Utils.setSetting(key, value)\n                game.tokenActionHud.updateSettings(key, value)\n            }\n        }\n        game.tokenActionHud.update()\n    }\n}\n\nexport class TahSettingsFormLayout extends TahSettingsForm {\n    constructor () {\n        super()\n        this.settings = LAYOUT_SETTING\n    }\n\n    static get defaultOptions () {\n        return mergeObject(super.defaultOptions, {\n            title: Utils.i18n('tokenActionHud.settings.layout.form.title')\n        })\n    }\n}\n","import { CustomStyleForm } from './forms/custom-style-form.js'\nimport { TahSettingsFormLayout } from './forms/settings-form.js'\nimport { CUSTOM_STYLE, MODULE } from './constants.js'\nimport { Logger, Utils } from './utils.js'\n\nfunction onChangeFunction (setting, value) { if (game.tokenActionHud) game.tokenActionHud.updateSettings(setting, value) }\n\n// Register key bindings\nHooks.on('init', async () => {\n    game.keybindings.register(MODULE.ID, 'toggleHud', {\n        name: Utils.i18n('tokenActionHud.toggleHud'),\n        editable: [],\n        onDown: () => { game.tokenActionHud.toggleHud() }\n    })\n})\n\n/**\n * Register module settings\n * @param {object} systemManager The SystemManager class\n * @param {array} rollHandlers   The available roll handlers\n */\nexport const registerSettings = function (systemManager, rollHandlers) {\n    game.settings.registerMenu(MODULE.ID, 'customStyle', {\n        hint: Utils.i18n('tokenActionHud.settings.customStyle.hint'),\n        label: Utils.i18n('tokenActionHud.settings.customStyle.label'),\n        name: Utils.i18n('tokenActionHud.settings.customStyle.name'),\n        icon: 'fas fa-palette',\n        type: CustomStyleForm,\n        restricted: false,\n        scope: 'client'\n    })\n\n    game.settings.registerMenu(MODULE.ID, 'layout', {\n        hint: Utils.i18n('tokenActionHud.settings.layout.hint'),\n        label: Utils.i18n('tokenActionHud.settings.layout.label'),\n        name: Utils.i18n('tokenActionHud.settings.layout.name'),\n        icon: 'fas fa-table-layout',\n        type: TahSettingsFormLayout,\n        restricted: false,\n        scope: 'client'\n    })\n\n    game.settings.register(MODULE.ID, 'startup', {\n        name: 'One-Time Startup Prompt',\n        scope: 'world',\n        config: false,\n        type: Boolean,\n        default: false\n    })\n\n    game.settings.register(MODULE.ID, 'migrationVersion', {\n        name: 'Migration Version',\n        scope: 'world',\n        config: false,\n        type: String,\n        default: '0.0'\n    })\n\n    game.settings.register(MODULE.ID, 'style', {\n        name: Utils.i18n('tokenActionHud.settings.style.name'),\n        hint: Utils.i18n('tokenActionHud.settings.style.hint'),\n        scope: 'client',\n        config: true,\n        type: String,\n        default: 'foundryVTT',\n        choices: {\n            foundryVTT: 'Foundry VTT Dark',\n            foundryVttLight: 'Foundry VTT Light',\n            compact: 'Foundry VTT Compact Dark',\n            dorakoUI: 'Dorako UI',\n            highContrast: 'High Contrast',\n            pathfinder: 'Pathfinder',\n            custom: 'Custom'\n        },\n        onChange: (value) => {\n            Utils.switchCSS(value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'customLayout', {\n        name: Utils.i18n('tokenActionHud.settings.customLayout.name'),\n        hint: Utils.i18n('tokenActionHud.settings.customLayout.hint'),\n        scope: 'world',\n        config: false,\n        type: String\n    })\n\n    game.settings.register(MODULE.ID, 'userCustomLayout', {\n        name: Utils.i18n('tokenActionHud.settings.userCustomLayout.name'),\n        hint: Utils.i18n('tokenActionHud.settings.userCustomLayout.hint'),\n        scope: 'client',\n        config: false,\n        type: String\n    })\n\n    game.settings.register(MODULE.ID, 'direction', {\n        name: Utils.i18n('tokenActionHud.settings.direction.name'),\n        hint: Utils.i18n('tokenActionHud.settings.direction.hint'),\n        scope: 'client',\n        config: true,\n        type: String,\n        default: 'auto',\n        choices: {\n            auto: Utils.i18n('tokenActionHud.settings.direction.choice.auto'),\n            up: Utils.i18n('tokenActionHud.settings.direction.choice.up'),\n            down: Utils.i18n('tokenActionHud.settings.direction.choice.down')\n        },\n        onChange: (value) => {\n            onChangeFunction('direction', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'grid', {\n        name: Utils.i18n('tokenActionHud.settings.grid.name'),\n        hint: Utils.i18n('tokenActionHud.settings.grid.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: false,\n        onChange: (value) => {\n            onChangeFunction('grid', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'scale', {\n        name: Utils.i18n('tokenActionHud.settings.scale.name'),\n        hint: Utils.i18n('tokenActionHud.settings.scale.hint'),\n        scope: 'client',\n        config: true,\n        type: Number,\n        range: {\n            min: 0.5,\n            max: 2,\n            step: 0.05\n        },\n        default: 1,\n        onChange: (value) => {\n            onChangeFunction('scale', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'drag', {\n        name: Utils.i18n('tokenActionHud.settings.drag.name'),\n        hint: Utils.i18n('tokenActionHud.settings.drag.hint'),\n        scope: 'client',\n        config: true,\n        type: String,\n        default: 'whenUnlocked',\n        choices: {\n            always: Utils.i18n('tokenActionHud.settings.drag.choices.always'),\n            whenUnlocked: Utils.i18n('tokenActionHud.settings.drag.choices.whenUnlocked'),\n            never: Utils.i18n('tokenActionHud.settings.drag.choices.never')\n        },\n        onChange: (value) => {\n            onChangeFunction('drag', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'enable', {\n        name: Utils.i18n('tokenActionHud.settings.enable.name'),\n        hint: Utils.i18n('tokenActionHud.settings.enable.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: true,\n        onChange: (value) => {\n            onChangeFunction('enable', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'rollHandler', {\n        name: Utils.i18n('tokenActionHud.settings.rollHandler.name'),\n        hint: Utils.i18n('tokenActionHud.settings.rollHandler.hint'),\n        scope: 'world',\n        config: true,\n        type: String,\n        choices: rollHandlers,\n        default: 'core',\n        onChange: (value) => {\n            onChangeFunction('rollHandler', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'allow', {\n        name: Utils.i18n('tokenActionHud.settings.allow.name'),\n        hint: Utils.i18n('tokenActionHud.settings.allow.hint'),\n        scope: 'world',\n        config: true,\n        type: String,\n        choices: {\n            4: Utils.i18n('tokenActionHud.settings.allow.choice.4'),\n            3: Utils.i18n('tokenActionHud.settings.allow.choice.3'),\n            2: Utils.i18n('tokenActionHud.settings.allow.choice.2'),\n            1: Utils.i18n('tokenActionHud.settings.allow.choice.1')\n        },\n        default: 1,\n        requiresReload: true\n    })\n\n    game.settings.register(MODULE.ID, 'enableCustomization', {\n        name: Utils.i18n('tokenActionHud.settings.enableCustomization.name'),\n        hint: Utils.i18n('tokenActionHud.settings.enableCustomization.hint'),\n        scope: 'world',\n        config: true,\n        type: Boolean,\n        default: true,\n        onChange: (value) => {\n            onChangeFunction('enableCustomization', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'alwaysShowHud', {\n        name: Utils.i18n('tokenActionHud.settings.alwaysShowHud.name'),\n        hint: Utils.i18n('tokenActionHud.settings.alwaysShowHud.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: true,\n        onChange: (value) => {\n            onChangeFunction('alwaysShowHud', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'displayCharacterName', {\n        name: Utils.i18n('tokenActionHud.settings.displayCharacterName.name'),\n        hint: Utils.i18n('tokenActionHud.settings.displayCharacterName.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: true,\n        onChange: (value) => {\n            onChangeFunction('displayCharacterName', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'sortActions', {\n        name: Utils.i18n('tokenActionHud.settings.sortActions.name'),\n        hint: Utils.i18n('tokenActionHud.settings.sortActions.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: false,\n        onChange: (value) => {\n            onChangeFunction('sortActions', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'displayIcons', {\n        name: Utils.i18n('tokenActionHud.settings.displayIcons.name'),\n        hint: Utils.i18n('tokenActionHud.settings.displayIcons.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: true,\n        onChange: (value) => {\n            onChangeFunction('displayIcons', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'tooltips', {\n        name: Utils.i18n('tokenActionHud.settings.tooltips.name'),\n        hint: Utils.i18n('tokenActionHud.settings.tooltips.hint'),\n        scope: 'client',\n        config: true,\n        type: String,\n        default: 'full',\n        choices: {\n            full: Utils.i18n('tokenActionHud.settings.tooltips.choices.full'),\n            nameOnly: Utils.i18n('tokenActionHud.settings.tooltips.choices.nameOnly'),\n            none: Utils.i18n('tokenActionHud.settings.tooltips.choices.none')\n        },\n        onChange: (value) => {\n            onChangeFunction('tooltips', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'tooltipDelay', {\n        name: Utils.i18n('tokenActionHud.settings.tooltipDelay.name'),\n        hint: Utils.i18n('tokenActionHud.settings.tooltipDelay.hint'),\n        scope: 'client',\n        config: true,\n        type: Number,\n        default: 1500,\n        onChange: (value) => {\n            setTooltipDelay(value)\n        }\n    })\n\n    const tooltipDelay = Utils.getSetting('tooltipDelay') || 1500\n    setTooltipDelay(tooltipDelay)\n\n    function setTooltipDelay (ms) {\n        const root = document.querySelector(':root')\n        root.style.setProperty('--tah-tooltip-delay', `${ms}ms`)\n    }\n\n    game.settings.register(MODULE.ID, 'clickOpenCategory', {\n        name: Utils.i18n('tokenActionHud.settings.clickOpenCategory.name'),\n        hint: Utils.i18n('tokenActionHud.settings.clickOpenCategory.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: false,\n        onChange: (value) => {\n            onChangeFunction('clickOpenCategory', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'renderItemOnRightClick', {\n        name: Utils.i18n('tokenActionHud.settings.renderItemOnRightClick.name'),\n        hint: Utils.i18n('tokenActionHud.settings.renderItemOnRightClick.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: true,\n        onChange: (value) => {\n            onChangeFunction('renderItemOnRightClick', value)\n        }\n    })\n\n    if (Utils.isModuleActive('itemacro') && !Utils.isModuleActive('midi-qol')) {\n        game.settings.register(MODULE.ID, 'itemMacro', {\n            name: Utils.i18n('tokenActionHud.settings.itemMacro.name'),\n            hint: Utils.i18n('tokenActionHud.settings.itemMacro.hint'),\n            scope: 'client',\n            config: true,\n            type: String,\n            choices: {\n                both: Utils.i18n('tokenActionHud.settings.itemMacro.choices.both'),\n                itemMacro: Utils.i18n('tokenActionHud.settings.itemMacro.choices.itemMacro'),\n                original: Utils.i18n('tokenActionHud.settings.itemMacro.choices.original')\n            },\n            default: 'both',\n            onChange: (value) => {\n                onChangeFunction('itemMacro', value)\n            }\n        })\n    }\n\n    game.settings.register(MODULE.ID, 'activeCssAsText', {\n        name: Utils.i18n('tokenActionHud.settings.activeCssAsText.name'),\n        hint: Utils.i18n('tokenActionHud.settings.activeCssAsText.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: false,\n        onChange: (value) => {\n            onChangeFunction('activeCssAsText', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'debug', {\n        name: Utils.i18n('tokenActionHud.settings.debug.name'),\n        hint: Utils.i18n('tokenActionHud.settings.debug.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: false,\n        onChange: (value) => {\n            onChangeFunction('debug', value)\n        }\n    })\n\n    registerCustomStyleSettings()\n\n    systemManager.doRegisterSettings(onChangeFunction)\n\n    Logger.debug('Available roll handlers', { rollHandlers })\n}\n\n/**\n * Register color settings\n */\nfunction registerCustomStyleSettings () {\n    for (const [key, value] of Object.entries(CUSTOM_STYLE)) {\n        game.settings.register(MODULE.ID, key, {\n            scope: 'client',\n            config: false,\n            type: value.type,\n            default: value.default\n        })\n    }\n}\n","import { ActionListExtender } from './action-list-extender.js'\nimport { DELIMITER, ITEM_MACRO_ICON } from '../constants.js'\nimport { Utils } from '../utils.js'\n\n/**\n * Handler for building actions related to the Item Macro module.\n */\nexport class ItemMacroActionListExtender extends ActionListExtender {\n    constructor (actionHandler) {\n        super(actionHandler)\n        this.actionHandler = actionHandler\n        this.actor = this.actionHandler.actor\n        this.token = this.actionHandler.token\n    }\n\n    /**\n     * Extend the action list\n     * @override\n     */\n    extendActionList () {\n        // Update actor and token with current action handler context\n        this.actor = this.actionHandler.actor\n        this.token = this.actionHandler.token\n\n        if (!this.actor) return\n        const items = this.actor.items.filter((item) => item.flags?.itemacro?.macro?.command)\n\n        let itemIds\n        if (Utils.isModuleActive('midi-qol')) {\n            itemIds = items\n                .filter(this.#isUnsupportedByMidiQoL)\n                .map((item) => item.id)\n        } else {\n            itemIds = items.map((item) => item.id)\n        }\n\n        if (!itemIds) return\n\n        if (itemIds.length === 0) return\n\n        const itemMacroSetting = Utils.getSetting('itemMacro')\n\n        if (itemMacroSetting === 'original') return\n\n        const replace = itemMacroSetting === 'itemMacro'\n\n        Object.keys(this.actionHandler.groups).forEach(groupKey => {\n            const group = this.actionHandler.groups[groupKey]\n            this.#addGroupActions(itemIds, group, replace)\n        })\n    }\n\n    /**\n     * Add group actions\n     * @private\n     * @param {array} itemIds   The list of item IDs\n     * @param {object} group    The group\n     * @param {boolean} replace Whether to replace the action or not\n     */\n    #addGroupActions (itemIds, group, replace) {\n        // Exit if no actions exist\n        if (!group?.actions?.length) return\n\n        const actions = []\n        group.actions.forEach(existingAction => {\n            if (!itemIds.includes(existingAction.id)) return\n\n            const existingItemMacroAction = group.actions.find(action => action.id === `itemMacro+${existingAction.id}`)\n            const actionToReplace = existingItemMacroAction ?? existingAction\n\n            if (existingItemMacroAction) {\n                replace = true\n            }\n\n            const macroAction = this.#createItemMacroAction(existingAction, actionToReplace, replace)\n\n            if (!replace) actions.push(macroAction)\n        })\n\n        this.#addActions(actions, group)\n    }\n\n    /**\n     * Create item macro action\n     * @private\n     * @param {object} existingAction  The existing action\n     * @param {object} actionToReplace The action to replace\n     * @param {boolean} replace        Whether to replace the action or not\n     * @returns {object}               The item macro action\n     */\n    #createItemMacroAction (existingAction, actionToReplace, replace) {\n        const action = (replace) ? actionToReplace : Utils.deepClone(existingAction)\n        action.encodedValue = `itemMacro${existingAction.encodedValue?.substr(existingAction.encodedValue.indexOf(DELIMITER))}`\n        action.id = `itemMacro+${existingAction.id}`\n        action.fullName = existingAction.fullName\n        action.listName = `Item Macro: ${existingAction.fullName}`\n        action.name = existingAction.name\n        action.itemMacroIcon = `<i class=\"${ITEM_MACRO_ICON.ICON}\" data-tooltip=\"${ITEM_MACRO_ICON.TOOLTIP}\"></i>`\n        return action\n    }\n\n    /**\n     * Add actions to the group\n     * @private\n     * @param {object} actions The actions\n     * @param {object} group   The group\n     */\n    #addActions (actions, group) {\n        actions.forEach(macroAction => {\n            const index = group.actions.findIndex(action => action.id === macroAction.id) + 1\n            group.actions.splice(index, 0, macroAction)\n        })\n    }\n\n    /**\n     * Whether the item is supported by MidiQoL or not\n     * @private\n     * @param {object} item The item\n     * @returns {boolean}\n     */\n    #isUnsupportedByMidiQoL (item) {\n        const flag = item.getFlag('midi-qol', 'onUseMacroName')\n        return !flag\n    }\n}\n","import { PreRollHandler } from './pre-roll-handler.js'\nimport { COMPENDIUM_ACTION_TYPES, DELIMITER } from '../constants.js'\n\nexport class CompendiumMacroPreHandler extends PreRollHandler {\n    /** @override */\n    prehandleActionEvent (event, encodedValue) {\n        const payload = encodedValue.split(DELIMITER)\n\n        if (payload.length < 2) return false\n\n        let actionType = null\n        let key = null\n        let actionId = null\n\n        if (payload.length === 2) {\n            actionType = payload[0]\n            actionId = payload[1]\n        }\n        if (payload.length === 3) {\n            actionType = payload[0]\n            key = payload[1]\n            actionId = payload[2]\n        }\n\n        if (!COMPENDIUM_ACTION_TYPES.includes(actionType)) return false\n\n        switch (actionType) {\n        case 'compendiumEntry':\n            this.#handleCompendium(key, actionId)\n            break\n        case 'compendiumMacro':\n            this.#handleMacroCompendium(key, actionId)\n            break\n        case 'compendiumPlaylist':\n            this.#handlePlaylistCompendium(key, actionId)\n            break\n        case 'macro':\n            this.#handleMacro(actionId)\n            break\n        default:\n            return false\n        }\n\n        return true\n    }\n\n    /**\n     * Handle compendium\n     * @private\n     * @param {string} compendiumKey The compendium key\n     * @param {string} actionId      The action id\n     */\n    #handleCompendium (compendiumKey, actionId) {\n        const pack = game.packs.get(compendiumKey)\n        pack.getDocument(actionId).then((entity) => entity.sheet.render(true))\n    }\n\n    /**\n     * Handle macro compendium\n     * @private\n     * @param {string} compendiumKey The compendium key\n     * @param {string} actionId      The action id\n     */\n    #handleMacroCompendium (compendiumKey, actionId) {\n        const pack = game.packs.get(compendiumKey)\n        pack.getDocument(actionId).then((entity) => entity.execute())\n    }\n\n    /**\n     * Handle playlist compendium\n     * @private\n     * @param {string} compendiumKey The compendium key\n     * @param {string} actionId      The action id\n     */\n    async #handlePlaylistCompendium (compendiumKey, actionId) {\n        const pack = game.packs.get(compendiumKey)\n        const actionPayload = actionId.split('>')\n        const playlistId = actionPayload[0]\n        const soundId = actionPayload[1]\n        const playlist = await pack.getDocument(playlistId)\n        const sound = playlist.sounds.find((sound) => sound._id === soundId)\n        AudioHelper.play({ src: sound.path }, {})\n    }\n\n    /**\n     * Handle macro\n     * @private\n     * @param {string} actionId The action id\n     */\n    #handleMacro (actionId) {\n        game.macros.get(actionId).execute()\n    }\n}\n","import { PreRollHandler } from './pre-roll-handler.js'\nimport { DELIMITER } from '../constants.js'\nimport { Logger, Utils } from '../utils.js'\n\nexport class ItemMacroPreRollHandler extends PreRollHandler {\n    /** @override */\n    prehandleActionEvent (event, encodedValue, actionHandler) {\n        // Update variables with current action context\n        this.actor = actionHandler.actor\n        const payload = encodedValue.split(DELIMITER)\n\n        if (payload.length !== 2) return false\n\n        const actionType = payload[0]\n        const actionId = payload[1]\n\n        if (actionType !== 'itemMacro') return false\n\n        if (this.isRenderItem()) {\n            this.doRenderItem(this.actor, actionId)\n            return true\n        }\n\n        return this.#tryExecuteItemMacro(actionId)\n    }\n\n    /**\n     * Try to execute item macro\n     * @private\n     * @param {string} actionId The action id\n     * @returns {boolean}       Whether the item macro executed\n     */\n    #tryExecuteItemMacro (actionId) {\n        const item = Utils.getItem(this.actor, actionId)\n\n        try {\n            item.executeMacro()\n        } catch (e) {\n            Logger.debug('ItemMacro Error', e)\n            return false\n        }\n\n        return true\n    }\n}\n","import { registerSettings } from './settings.js'\nimport { ItemMacroActionListExtender } from './action-handlers/item-macro-extender.js'\nimport { CompendiumMacroPreHandler } from './roll-handlers/compendium-macro-pre-handler.js'\nimport { ItemMacroPreRollHandler } from './roll-handlers/pre-item-macro.js'\nimport { MODULE } from './constants.js'\nimport { Logger, Utils } from './utils.js'\n\nexport class SystemManager {\n    constructor () {\n        this.coreModuleId = MODULE.ID\n    }\n\n    /** ACTION HANDLERS */\n    /** OVERRIDDEN BY SYSTEM */\n\n    doGetActionHandler () {}\n    doGetRollHandler (handlerId) {}\n    getAvailableRollHandlers () {}\n    doRegisterSettings (updateFunc) {}\n    async doRegisterDefaultFlags () {}\n\n    /**\n     * Register default flags\n     * @public\n     */\n    async registerDefaults () {\n        const defaults = await this.doRegisterDefaultFlags() ?? []\n        Hooks.callAll('tokenActionHudCoreRegisterDefaults', defaults)\n        if (defaults) {\n            if (defaults?.categories) {\n                globalThis.logger.warn('Token Action HUD | SystemManager.doRegisterDefaultFlags expects \\'layout\\' to be returned instead of \\'categories\\'')\n            }\n            if (defaults?.subcategories) {\n                globalThis.logger.warn('Token Action HUD | SystemManager.doRegisterDefaultFlags expects \\'groups\\' to be returned instead of \\'subcategories\\'')\n            }\n            game.tokenActionHud.defaults = defaults\n        }\n    }\n\n    /**\n     * Initialise the action handler\n     * @public\n     * @returns {ActionHandler}\n     */\n    async getActionHandler () {\n        const actionHandler = this.doGetActionHandler()\n        this.addActionExtenders(actionHandler)\n        return actionHandler\n    }\n\n    /**\n     * Initialise action list extenders\n     * @public\n     * @param {ActionHandler} actionHandler The ActionHandler class\n     */\n    addActionExtenders (actionHandler) {\n        if (Utils.isModuleActive('itemacro') && !Utils.isModuleActive('midi-qol')) {\n            actionHandler.addFurtherActionHandler(new ItemMacroActionListExtender(actionHandler))\n        }\n    }\n\n    /**\n     * Get the roll handler\n     * @public\n     * @returns {object} The roll handler\n     */\n    getRollHandler () {\n        let rollHandlerId = Utils.getSetting('rollHandler')\n\n        if (!(rollHandlerId === 'core' || Utils.isModuleActive(rollHandlerId))) {\n            Logger.error(rollHandlerId, Utils.i18n('tokenActionHud.handlerNotFound'))\n            rollHandlerId = 'core'\n            Utils.setSetting('rollHandler', rollHandlerId)\n        }\n\n        const rollHandler = this.doGetRollHandler(rollHandlerId)\n        this.addPreHandlers(rollHandler)\n        return rollHandler\n    }\n\n    /**\n     * Add pre-handlers\n     * @public\n     * @param {object} rollHandler\n     */\n    addPreHandlers (rollHandler) {\n        rollHandler.addPreRollHandler(new CompendiumMacroPreHandler())\n\n        if (Utils.isModuleActive('itemacro') && !Utils.isModuleActive('midi-qol')) { rollHandler.addPreRollHandler(new ItemMacroPreRollHandler()) }\n    }\n\n    /**\n     * Register module settings\n     * @public\n     */\n    registerSettings () {\n        const rollHandlers = this.getAvailableRollHandlers()\n        registerSettings(this, rollHandlers)\n    }\n\n    /**\n     * Add handler\n     * @param {array} choices The choices\n     * @param {string} id     The module id\n     */\n    static addHandler (choices, id) {\n        if (Utils.isModuleActive(id)) {\n            const title = Utils.getModuleTitle(id)\n            mergeObject(choices, { [id]: title })\n        }\n    }\n\n    /** DEPRECATED */\n\n    addActionsToActionList (actionsData, groupData) {\n        globalThis.logger.warn('Token Action HUD | ActionHandler.addActionsToActionList is deprecated. Use ActionHandler.addActions')\n        this.addActions(actionsData, groupData)\n    }\n}\n","!function(t,e){var s=s||{};\"function\"==typeof s&&s.amd?s([],e):\"object\"==typeof exports&&\"object\"==typeof module?module.exports=e():\"object\"==typeof exports?exports.DragSort=e():t.DragSort=e()}(this,(function(){var t,e=0,s={},i={},r=(t=window.MutationObserver||window.WebKitMutationObserver,function(e,s){e&&1===e.nodeType&&(t?new t((function(t,e){s(t)})).observe(e,{childList:!0,subtree:!1}):window.addEventListener&&e.addEventListener(\"DOMNodeInserted\",s,!1))});function a(t,e){if(!t)return this;e=e||{},this.parentElm=t,this.uid=e.uid,this.settings={selector:\"*\",callbacks:{}},Object.assign(this.settings,e),this.setup(),r(this.parentElm,this.setup.bind(this)),this.bindEvents()}return a.prototype={namespace:\"dragsort\",setup(){[...this.parentElm.childNodes].forEach((t=>{if(1!=t.nodeType)return t.parentNode.removeChild(t);t.matches(this.settings.selector)&&(t.draggable=!0)})),this.gap=this.getItemsGap(this.parentElm.firstElementChild)},throttle(t,e){var s=!1,i=this;return function(r){s||(t.call(i,r),s=!0,setTimeout((()=>s=!1),e))}},getDraggableElm(t){if(!t.closest)return null;var e=t.closest('[draggable=\"true\"]');return this.uid==s.uid?e:null},dragstart(t,e){s=this;var i,r=this.getDraggableElm(e);r?(this.source=this.getInitialState(),this.target=this.getInitialState(),i=r.getBoundingClientRect(),this.source.elm=r,this.source.idx=this.getNodeIndex(r),this.source.size.width=i.width,this.source.size.height=i.height,t.dataTransfer.effectAllowed=\"move\",this.settings.callbacks.dragStart&&this.settings.callbacks.dragStart(this.source.elm,t),setTimeout(this.afterDragStart.bind(this))):s={}},afterDragStart(){var t=\"vertical\"==this.settings.mode?\"height\":\"width\";this.parentElm.classList.add(`${this.namespace}--dragStart`),this.source.elm.style[t]=this.source.size[t]+\"px\",this.source.elm.classList.add(`${this.namespace}--dragElem`)},dragover(t){t.preventDefault(),t.stopPropagation();var e=t.target;if((e=this.getDraggableElm(e))&&this.target){var s=this.target.elm,i=this.target.hoverDirection;t.dataTransfer.dropEffect=\"move\",this.target.hoverDirection=this.getTargetDirection(t),s==e&&i==this.target.hoverDirection||this.directionAwareDragEnter(t,e)}},dragenter(t,e){(e=this.getDraggableElm(e))&&this.target&&this.isValidElm(e)&&this.source.elm!=e&&this.source.elm&&(this.target.bounding=e.getBoundingClientRect())},directionAwareDragEnter(t,e){var s;t.preventDefault(),t.stopPropagation(),t.dataTransfer.dropEffect=\"none\",this.isValidElm(e)&&this.source.elm!=e&&this.source.elm&&(t.dataTransfer.dropEffect=\"move\",this.cleanupLastTarget(),this.target.elm=e,this.target.idx=this.getNodeIndex(e),e.classList.add(\"over\"),s=Math.abs(this.target.idx-this.source.idx),this.source.elm.classList.toggle(`${this.namespace}--hide`,s>0),\"vertical\"==this.settings.mode?this.target.elm.style[this.target.hoverDirection?\"marginBottom\":\"marginTop\"]=this.source.size.height+this.gap+\"px\":this.target.elm.style[this.target.hoverDirection?\"marginRight\":\"marginLeft\"]=this.source.size.width+this.gap+\"px\")},dragend(t){if(clearTimeout(this.dragoverTimeout),this.dragoverTimeout=null,this.parentElm.classList.remove(`${this.namespace}--dragStart`),!this.isValidElm(this.target.elm))return this.cleanup();var e=this.target.hoverDirection?this.target.elm.nextElementSibling:this.target.elm;return this.source.elm!=this.target.elm&&this.target.elm&&(this.target.elm.classList.add(`${this.namespace}--noAnim`),this.cleanup(),this.parentElm.insertBefore(this.source.elm,e)),this.source.elm&&this.source.elm.classList.remove(`${this.namespace}--dragElem`,`${this.namespace}--hide`),this.settings.callbacks.dragEnd&&this.settings.callbacks.dragEnd(this.source.elm),this},isTargetLastChild(){return this.parentElm.lastElementChild==this.target.elm},getTargetDirection(t){if(this.target.bounding)return\"vertical\"==this.settings.mode?t.pageY>this.target.bounding.top+this.target.bounding.height/2?1:0:t.pageX>this.target.bounding.left+this.target.bounding.width/2?1:0},getNodeIndex(t){for(var e=0;t=t.previousSibling;)3==t.nodeType&&/^\\s*$/.test(t.data)||e++;return e},isValidElm(t){return t&&t.nodeType&&t.parentNode==this.parentElm},cleanup(){s={},[...this.parentElm.children].forEach((t=>{t.removeAttribute(\"style\"),setTimeout((()=>{t.classList.remove(`${this.namespace}--over`,`${this.namespace}--noAnim`,`${this.namespace}--dragElem`)}),50)}))},cleanupLastTarget(){this.target.elm&&(this.target.elm.classList.remove(`${this.namespace}--hide`,`${this.namespace}--over`),this.target.elm.removeAttribute(\"style\"))},getInitialState:()=>({elm:null,size:{}}),getItemsGap(t){var e=getComputedStyle(t),s=getComputedStyle(t.parentNode),i=\"vertical\"==this.settings.mode,r=parseInt(s.gap)||0;return parseInt(e[\"margin\"+(i?\"Top\":\"Left\")])+parseInt(e[\"margin\"+(i?\"Bottom\":\"Right\")])+r},bindEvents(t){for(var e in this.listeners=this.listeners||{dragstart:t=>this.dragstart(t,t.target),dragenter:t=>this.dragenter(t,t.target),dragend:t=>this.dragend(t,t.target),dragover:this.throttle(this.dragover,350)},this.listeners)this.parentElm[t?\"removeEventListener\":\"addEventListener\"](e,this.listeners[e])},destroy(){this.cleanup(),this.bindEvents(!0),delete i[this.uid]}},function(t,s){return i[++e]=t.DragSort?i[t.DragSort]:new a(t,{...s,uid:e}),t.DragSort=e,i[e]}}));","/**\n * Tagify (v 4.17.8) - tags input component\n * By undefined\n * https://github.com/yairEO/tagify\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal\r\n * in the Software without restriction, including without limitation the rights\r\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n * copies of the Software, and to permit persons to whom the Software is\r\n * furnished to do so, subject to the following conditions:\r\n * \r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n * \r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n * THE SOFTWARE.\r\n * \r\n * THE SOFTWARE IS NOT PERMISSIBLE TO BE SOLD.\n */\n\n!function(t,e){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define(e):(t=\"undefined\"!=typeof globalThis?globalThis:t||self).Tagify=e()}(this,(function(){\"use strict\";function t(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function e(e){for(var s=1;s<arguments.length;s++){var a=null!=arguments[s]?arguments[s]:{};s%2?t(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(t,e,i){return(e=function(t){var e=function(t,e){if(\"object\"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,e||\"default\");if(\"object\"!=typeof s)return s;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===e?String:Number)(t)}(t,\"string\");return\"symbol\"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const s=(t,e,i,s)=>(t=\"\"+t,e=\"\"+e,s&&(t=t.trim(),e=e.trim()),i?t==e:t.toLowerCase()==e.toLowerCase()),a=(t,e)=>t&&Array.isArray(t)&&t.map((t=>n(t,e)));function n(t,e){var i,s={};for(i in t)e.indexOf(i)<0&&(s[i]=t[i]);return s}function o(t){var e=document.createElement(\"div\");return t.replace(/\\&#?[0-9a-z]+;/gi,(function(t){return e.innerHTML=t,e.innerText}))}function r(t){return(new DOMParser).parseFromString(t.trim(),\"text/html\").body.firstElementChild}function l(t,e){for(e=e||\"previous\";t=t[e+\"Sibling\"];)if(3==t.nodeType)return t}function d(t){return\"string\"==typeof t?t.replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\").replace(/\"/g,\"&quot;\").replace(/`|'/g,\"&#039;\"):t}function h(t){var e=Object.prototype.toString.call(t).split(\" \")[1].slice(0,-1);return t===Object(t)&&\"Array\"!=e&&\"Function\"!=e&&\"RegExp\"!=e&&\"HTMLUnknownElement\"!=e}function g(t,e,i){function s(t,e){for(var i in e)if(e.hasOwnProperty(i)){if(h(e[i])){h(t[i])?s(t[i],e[i]):t[i]=Object.assign({},e[i]);continue}if(Array.isArray(e[i])){t[i]=Object.assign([],e[i]);continue}t[i]=e[i]}}return t instanceof Object||(t={}),s(t,e),i&&s(t,i),t}function p(){const t=[],e={};for(let i of arguments)for(let s of i)h(s)?e[s.value]||(t.push(s),e[s.value]=1):t.includes(s)||t.push(s);return t}function c(t){return String.prototype.normalize?\"string\"==typeof t?t.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g,\"\"):void 0:t}var u=()=>/(?=.*chrome)(?=.*android)/i.test(navigator.userAgent);function m(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)))}function v(t){return t&&t.classList&&t.classList.contains(this.settings.classNames.tag)}function f(t,e){var i=window.getSelection();return e=e||i.getRangeAt(0),\"string\"==typeof t&&(t=document.createTextNode(t)),e&&(e.deleteContents(),e.insertNode(t)),t}function T(t,e,i){return t?(e&&(t.__tagifyTagData=i?e:g({},t.__tagifyTagData||{},e)),t.__tagifyTagData):(console.warn(\"tag element doesn't exist\",t,e),e)}var w={delimiters:\",\",pattern:null,tagTextProp:\"value\",maxTags:1/0,callbacks:{},addTagOnBlur:!0,onChangeAfterBlur:!0,duplicates:!1,whitelist:[],blacklist:[],enforceWhitelist:!1,userInput:!0,keepInvalidTags:!1,createInvalidTags:!0,mixTagsAllowedAfter:/,|\\.|\\:|\\s/,mixTagsInterpolator:[\"[[\",\"]]\"],backspace:!0,skipInvalid:!1,pasteAsTags:!0,editTags:{clicks:2,keepInvalid:!0},transformTag:()=>{},trim:!0,a11y:{focusableTags:!1},mixMode:{insertAfterTag:\" \"},autoComplete:{enabled:!0,rightKey:!1},classNames:{namespace:\"tagify\",mixMode:\"tagify--mix\",selectMode:\"tagify--select\",input:\"tagify__input\",focus:\"tagify--focus\",tagNoAnimation:\"tagify--noAnim\",tagInvalid:\"tagify--invalid\",tagNotAllowed:\"tagify--notAllowed\",scopeLoading:\"tagify--loading\",hasMaxTags:\"tagify--hasMaxTags\",hasNoTags:\"tagify--noTags\",empty:\"tagify--empty\",inputInvalid:\"tagify__input--invalid\",dropdown:\"tagify__dropdown\",dropdownWrapper:\"tagify__dropdown__wrapper\",dropdownHeader:\"tagify__dropdown__header\",dropdownFooter:\"tagify__dropdown__footer\",dropdownItem:\"tagify__dropdown__item\",dropdownItemActive:\"tagify__dropdown__item--active\",dropdownItemHidden:\"tagify__dropdown__item--hidden\",dropdownInital:\"tagify__dropdown--initial\",tag:\"tagify__tag\",tagText:\"tagify__tag-text\",tagX:\"tagify__tag__removeBtn\",tagLoading:\"tagify__tag--loading\",tagEditing:\"tagify__tag--editable\",tagFlash:\"tagify__tag--flash\",tagHide:\"tagify__tag--hide\"},dropdown:{classname:\"\",enabled:2,maxItems:10,searchKeys:[\"value\",\"searchBy\"],fuzzySearch:!0,caseSensitive:!1,accentedSearch:!0,includeSelectedTags:!1,highlightFirst:!1,closeOnSelect:!0,clearOnSelect:!0,position:\"all\",appendTarget:null},hooks:{beforeRemoveTag:()=>Promise.resolve(),beforePaste:()=>Promise.resolve(),suggestionClick:()=>Promise.resolve()}};function b(){this.dropdown={};for(let t in this._dropdown)this.dropdown[t]=\"function\"==typeof this._dropdown[t]?this._dropdown[t].bind(this):this._dropdown[t];this.dropdown.refs()}var y={refs(){this.DOM.dropdown=this.parseTemplate(\"dropdown\",[this.settings]),this.DOM.dropdown.content=this.DOM.dropdown.querySelector(\"[data-selector='tagify-suggestions-wrapper']\")},getHeaderRef(){return this.DOM.dropdown.querySelector(\"[data-selector='tagify-suggestions-header']\")},getFooterRef(){return this.DOM.dropdown.querySelector(\"[data-selector='tagify-suggestions-footer']\")},getAllSuggestionsRefs(){return[...this.DOM.dropdown.content.querySelectorAll(this.settings.classNames.dropdownItemSelector)]},show(t){var e,i,a,n=this.settings,o=\"mix\"==n.mode&&!n.enforceWhitelist,r=!n.whitelist||!n.whitelist.length,l=\"manual\"==n.dropdown.position;if(t=void 0===t?this.state.inputText:t,!(r&&!o&&!n.templates.dropdownItemNoMatch||!1===n.dropdown.enable||this.state.isLoading||this.settings.readonly)){if(clearTimeout(this.dropdownHide__bindEventsTimeout),this.suggestedListItems=this.dropdown.filterListItems(t),t&&!this.suggestedListItems.length&&(this.trigger(\"dropdown:noMatch\",t),n.templates.dropdownItemNoMatch&&(a=n.templates.dropdownItemNoMatch.call(this,{value:t}))),!a){if(this.suggestedListItems.length)t&&o&&!this.state.editing.scope&&!s(this.suggestedListItems[0].value,t)&&this.suggestedListItems.unshift({value:t});else{if(!t||!o||this.state.editing.scope)return this.input.autocomplete.suggest.call(this),void this.dropdown.hide();this.suggestedListItems=[{value:t}]}i=\"\"+(h(e=this.suggestedListItems[0])?e.value:e),n.autoComplete&&i&&0==i.indexOf(t)&&this.input.autocomplete.suggest.call(this,e)}this.dropdown.fill(a),n.dropdown.highlightFirst&&this.dropdown.highlightOption(this.DOM.dropdown.content.querySelector(n.classNames.dropdownItemSelector)),this.state.dropdown.visible||setTimeout(this.dropdown.events.binding.bind(this)),this.state.dropdown.visible=t||!0,this.state.dropdown.query=t,this.setStateSelection(),l||setTimeout((()=>{this.dropdown.position(),this.dropdown.render()})),setTimeout((()=>{this.trigger(\"dropdown:show\",this.DOM.dropdown)}))}},hide(t){var e=this.DOM,i=e.scope,s=e.dropdown,a=\"manual\"==this.settings.dropdown.position&&!t;if(s&&document.body.contains(s)&&!a)return window.removeEventListener(\"resize\",this.dropdown.position),this.dropdown.events.binding.call(this,!1),i.setAttribute(\"aria-expanded\",!1),s.parentNode.removeChild(s),setTimeout((()=>{this.state.dropdown.visible=!1}),100),this.state.dropdown.query=this.state.ddItemData=this.state.ddItemElm=this.state.selection=null,this.state.tag&&this.state.tag.value.length&&(this.state.flaggedTags[this.state.tag.baseOffset]=this.state.tag),this.trigger(\"dropdown:hide\",s),this},toggle(t){this.dropdown[this.state.dropdown.visible&&!t?\"hide\":\"show\"]()},render(){var t,e,i,s=(t=this.DOM.dropdown,(i=t.cloneNode(!0)).style.cssText=\"position:fixed; top:-9999px; opacity:0\",document.body.appendChild(i),e=i.clientHeight,i.parentNode.removeChild(i),e),a=this.settings;return\"number\"==typeof a.dropdown.enabled&&a.dropdown.enabled>=0?(this.DOM.scope.setAttribute(\"aria-expanded\",!0),document.body.contains(this.DOM.dropdown)||(this.DOM.dropdown.classList.add(a.classNames.dropdownInital),this.dropdown.position(s),a.dropdown.appendTarget.appendChild(this.DOM.dropdown),setTimeout((()=>this.DOM.dropdown.classList.remove(a.classNames.dropdownInital)))),this):this},fill(t){t=\"string\"==typeof t?t:this.dropdown.createListHTML(t||this.suggestedListItems);var e,i=this.settings.templates.dropdownContent.call(this,t);this.DOM.dropdown.content.innerHTML=(e=i)?e.replace(/\\>[\\r\\n ]+\\</g,\"><\").replace(/(<.*?>)|\\s+/g,((t,e)=>e||\" \")):\"\"},fillHeaderFooter(){var t=this.dropdown.filterListItems(this.state.dropdown.query),e=this.parseTemplate(\"dropdownHeader\",[t]),i=this.parseTemplate(\"dropdownFooter\",[t]),s=this.dropdown.getHeaderRef(),a=this.dropdown.getFooterRef();e&&s?.parentNode.replaceChild(e,s),i&&a?.parentNode.replaceChild(i,a)},refilter(t){t=t||this.state.dropdown.query||\"\",this.suggestedListItems=this.dropdown.filterListItems(t),this.dropdown.fill(),this.suggestedListItems.length||this.dropdown.hide(),this.trigger(\"dropdown:updated\",this.DOM.dropdown)},position(t){var e=this.settings.dropdown;if(\"manual\"!=e.position){var i,s,a,n,o,r,l=this.DOM.dropdown,d=e.placeAbove,h=e.appendTarget===document.body,g=h?window.pageYOffset:e.appendTarget.scrollTop,p=document.fullscreenElement||document.webkitFullscreenElement||document.documentElement,c=p.clientHeight,u=Math.max(p.clientWidth||0,window.innerWidth||0)>480?e.position:\"all\",m=this.DOM[\"input\"==u?\"input\":\"scope\"];if(t=t||l.clientHeight,this.state.dropdown.visible){if(\"text\"==u?(a=(i=function(){const t=document.getSelection();if(t.rangeCount){const e=t.getRangeAt(0),i=e.startContainer,s=e.startOffset;let a,n;if(s>0)return n=document.createRange(),n.setStart(i,s-1),n.setEnd(i,s),a=n.getBoundingClientRect(),{left:a.right,top:a.top,bottom:a.bottom};if(i.getBoundingClientRect)return i.getBoundingClientRect()}return{left:-9999,top:-9999}}()).bottom,s=i.top,n=i.left,o=\"auto\"):(r=function(t){for(var e=0,i=0;t&&t!=p;)e+=t.offsetLeft||0,i+=t.offsetTop||0,t=t.parentNode;return{left:e,top:i}}(e.appendTarget),s=(i=m.getBoundingClientRect()).top-r.top,a=i.bottom-1-r.top,n=i.left-r.left,o=i.width+\"px\"),!h){let t=function(){for(var t=0,i=e.appendTarget.parentNode;i;)t+=i.scrollTop||0,i=i.parentNode;return t}();s+=t,a+=t}s=Math.floor(s),a=Math.ceil(a),d=void 0===d?c-i.bottom<t:d,l.style.cssText=\"left:\"+(n+window.pageXOffset)+\"px; width:\"+o+\";\"+(d?\"top: \"+(s+g)+\"px\":\"top: \"+(a+g)+\"px\"),l.setAttribute(\"placement\",d?\"top\":\"bottom\"),l.setAttribute(\"position\",u)}}},events:{binding(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];var e=this.dropdown.events.callbacks,i=this.listeners.dropdown=this.listeners.dropdown||{position:this.dropdown.position.bind(this,null),onKeyDown:e.onKeyDown.bind(this),onMouseOver:e.onMouseOver.bind(this),onMouseLeave:e.onMouseLeave.bind(this),onClick:e.onClick.bind(this),onScroll:e.onScroll.bind(this)},s=t?\"addEventListener\":\"removeEventListener\";\"manual\"!=this.settings.dropdown.position&&(document[s](\"scroll\",i.position,!0),window[s](\"resize\",i.position),window[s](\"keydown\",i.onKeyDown)),this.DOM.dropdown[s](\"mouseover\",i.onMouseOver),this.DOM.dropdown[s](\"mouseleave\",i.onMouseLeave),this.DOM.dropdown[s](\"mousedown\",i.onClick),this.DOM.dropdown.content[s](\"scroll\",i.onScroll)},callbacks:{onKeyDown(t){if(this.state.hasFocus&&!this.state.composing){var e=this.DOM.dropdown.querySelector(this.settings.classNames.dropdownItemActiveSelector),i=this.dropdown.getSuggestionDataByNode(e);switch(t.key){case\"ArrowDown\":case\"ArrowUp\":case\"Down\":case\"Up\":t.preventDefault();var s=this.dropdown.getAllSuggestionsRefs(),a=\"ArrowUp\"==t.key||\"Up\"==t.key;e&&(e=this.dropdown.getNextOrPrevOption(e,!a)),e&&e.matches(this.settings.classNames.dropdownItemSelector)||(e=s[a?s.length-1:0]),this.dropdown.highlightOption(e,!0);break;case\"Escape\":case\"Esc\":this.dropdown.hide();break;case\"ArrowRight\":if(this.state.actions.ArrowLeft)return;case\"Tab\":if(\"mix\"!=this.settings.mode&&e&&!this.settings.autoComplete.rightKey&&!this.state.editing){t.preventDefault();var n=this.dropdown.getMappedValue(i);return this.input.autocomplete.set.call(this,n),!1}return!0;case\"Enter\":t.preventDefault(),this.settings.hooks.suggestionClick(t,{tagify:this,tagData:i,suggestionElm:e}).then((()=>{if(e)return this.dropdown.selectOption(e),e=this.dropdown.getNextOrPrevOption(e,!a),void this.dropdown.highlightOption(e);this.dropdown.hide(),\"mix\"!=this.settings.mode&&this.addTags(this.state.inputText.trim(),!0)})).catch((t=>t));break;case\"Backspace\":{if(\"mix\"==this.settings.mode||this.state.editing.scope)return;const t=this.input.raw.call(this);\"\"!=t&&8203!=t.charCodeAt(0)||(!0===this.settings.backspace?this.removeTags():\"edit\"==this.settings.backspace&&setTimeout(this.editTag.bind(this),0))}}}},onMouseOver(t){var e=t.target.closest(this.settings.classNames.dropdownItemSelector);e&&this.dropdown.highlightOption(e)},onMouseLeave(t){this.dropdown.highlightOption()},onClick(t){if(0==t.button&&t.target!=this.DOM.dropdown&&t.target!=this.DOM.dropdown.content){var e=t.target.closest(this.settings.classNames.dropdownItemSelector),i=this.dropdown.getSuggestionDataByNode(e);this.state.actions.selectOption=!0,setTimeout((()=>this.state.actions.selectOption=!1),50),this.settings.hooks.suggestionClick(t,{tagify:this,tagData:i,suggestionElm:e}).then((()=>{e?this.dropdown.selectOption(e,t):this.dropdown.hide()})).catch((t=>console.warn(t)))}},onScroll(t){var e=t.target,i=e.scrollTop/(e.scrollHeight-e.parentNode.clientHeight)*100;this.trigger(\"dropdown:scroll\",{percentage:Math.round(i)})}}},getSuggestionDataByNode(t){var e=t&&t.getAttribute(\"value\");return this.suggestedListItems.find((t=>t.value==e))||null},getNextOrPrevOption(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var i=this.dropdown.getAllSuggestionsRefs(),s=i.findIndex((e=>e===t));return e?i[s+1]:i[s-1]},highlightOption(t,e){var i,s=this.settings.classNames.dropdownItemActive;if(this.state.ddItemElm&&(this.state.ddItemElm.classList.remove(s),this.state.ddItemElm.removeAttribute(\"aria-selected\")),!t)return this.state.ddItemData=null,this.state.ddItemElm=null,void this.input.autocomplete.suggest.call(this);i=this.dropdown.getSuggestionDataByNode(t),this.state.ddItemData=i,this.state.ddItemElm=t,t.classList.add(s),t.setAttribute(\"aria-selected\",!0),e&&(t.parentNode.scrollTop=t.clientHeight+t.offsetTop-t.parentNode.clientHeight),this.settings.autoComplete&&(this.input.autocomplete.suggest.call(this,i),this.dropdown.position())},selectOption(t,e){var i=this.settings.dropdown,s=i.clearOnSelect,a=i.closeOnSelect;if(!t)return this.addTags(this.state.inputText,!0),void(a&&this.dropdown.hide());e=e||{};var n=t.getAttribute(\"value\"),o=\"noMatch\"==n,r=this.suggestedListItems.find((t=>(t.value??t)==n));this.trigger(\"dropdown:select\",{data:r,elm:t,event:e}),n&&(r||o)?(this.state.editing?this.onEditTagDone(null,g({__isValid:!0},this.normalizeTags([r])[0])):this[\"mix\"==this.settings.mode?\"addMixTags\":\"addTags\"]([r||this.input.raw.call(this)],s),this.DOM.input.parentNode&&(setTimeout((()=>{this.DOM.input.focus(),this.toggleFocusClass(!0)})),a&&setTimeout(this.dropdown.hide.bind(this)),t.addEventListener(\"transitionend\",(()=>{this.dropdown.fillHeaderFooter(),setTimeout((()=>t.remove()),100)}),{once:!0}),t.classList.add(this.settings.classNames.dropdownItemHidden))):a&&setTimeout(this.dropdown.hide.bind(this))},selectAll(t){this.suggestedListItems.length=0,this.dropdown.hide(),this.dropdown.filterListItems(\"\");var e=this.dropdown.filterListItems(\"\");return t||(e=this.state.dropdown.suggestions),this.addTags(e,!0),this},filterListItems(t,e){var i,s,a,n,o,r=this.settings,l=r.dropdown,d=(e=e||{},[]),g=[],p=r.whitelist,u=l.maxItems>=0?l.maxItems:1/0,m=l.searchKeys,v=0;if(!(t=\"select\"==r.mode&&this.value.length&&this.value[0][r.tagTextProp]==t?\"\":t)||!m.length)return d=l.includeSelectedTags?p:p.filter((t=>!this.isTagDuplicate(h(t)?t.value:t))),this.state.dropdown.suggestions=d,d.slice(0,u);function f(t,e){return e.toLowerCase().split(\" \").every((e=>t.includes(e.toLowerCase())))}for(o=l.caseSensitive?\"\"+t:(\"\"+t).toLowerCase();v<p.length;v++){let t,r;i=p[v]instanceof Object?p[v]:{value:p[v]};let u=!Object.keys(i).some((t=>m.includes(t)))?[\"value\"]:m;l.fuzzySearch&&!e.exact?(a=u.reduce(((t,e)=>t+\" \"+(i[e]||\"\")),\"\").toLowerCase().trim(),l.accentedSearch&&(a=c(a),o=c(o)),t=0==a.indexOf(o),r=a===o,s=f(a,o)):(t=!0,s=u.some((t=>{var s=\"\"+(i[t]||\"\");return l.accentedSearch&&(s=c(s),o=c(o)),l.caseSensitive||(s=s.toLowerCase()),r=s===o,e.exact?s===o:0==s.indexOf(o)}))),n=!l.includeSelectedTags&&this.isTagDuplicate(h(i)?i.value:i),s&&!n&&(r&&t?g.push(i):\"startsWith\"==l.sortby&&t?d.unshift(i):d.push(i))}return this.state.dropdown.suggestions=g.concat(d),\"function\"==typeof l.sortby?l.sortby(g.concat(d),o):g.concat(d).slice(0,u)},getMappedValue(t){var e=this.settings.dropdown.mapValueTo;return e?\"function\"==typeof e?e(t):t[e]||t.value:t.value},createListHTML(t){return g([],t).map(((t,i)=>{\"string\"!=typeof t&&\"number\"!=typeof t||(t={value:t});var s=this.dropdown.getMappedValue(t);return s=\"string\"==typeof s?d(s):s,this.settings.templates.dropdownItem.apply(this,[e(e({},t),{},{mappedValue:s}),this])})).join(\"\")}};const x=\"@yaireo/tagify/\";var O,D={empty:\"empty\",exceed:\"number of tags exceeded\",pattern:\"pattern mismatch\",duplicate:\"already exists\",notAllowed:\"not allowed\"},M={wrapper:(t,e)=>`<tags class=\"${e.classNames.namespace} ${e.mode?`${e.classNames[e.mode+\"Mode\"]}`:\"\"} ${t.className}\"\\n                    ${e.readonly?\"readonly\":\"\"}\\n                    ${e.disabled?\"disabled\":\"\"}\\n                    ${e.required?\"required\":\"\"}\\n                    ${\"select\"===e.mode?\"spellcheck='false'\":\"\"}\\n                    tabIndex=\"-1\">\\n            <span ${!e.readonly&&e.userInput?\"contenteditable\":\"\"} tabIndex=\"0\" data-placeholder=\"${e.placeholder||\"&#8203;\"}\" aria-placeholder=\"${e.placeholder||\"\"}\"\\n                class=\"${e.classNames.input}\"\\n                role=\"textbox\"\\n                aria-autocomplete=\"both\"\\n                aria-multiline=\"${\"mix\"==e.mode}\"></span>\\n                &#8203;\\n        </tags>`,tag(t,e){let i=e.settings;return`<tag title=\"${t.title||t.value}\"\\n                    contenteditable='false'\\n                    spellcheck='false'\\n                    tabIndex=\"${i.a11y.focusableTags?0:-1}\"\\n                    class=\"${i.classNames.tag} ${t.class||\"\"}\"\\n                    ${this.getAttributes(t)}>\\n            <x title='' class=\"${i.classNames.tagX}\" role='button' aria-label='remove tag'></x>\\n            <div>\\n                <span class=\"${i.classNames.tagText}\">${t[i.tagTextProp]||t.value}</span>\\n            </div>\\n        </tag>`},dropdown(t){var e=t.dropdown,i=\"manual\"==e.position,s=`${t.classNames.dropdown}`;return`<div class=\"${i?\"\":s} ${e.classname}\" role=\"listbox\" aria-labelledby=\"dropdown\">\\n                    <div data-selector='tagify-suggestions-wrapper' class=\"${t.classNames.dropdownWrapper}\"></div>\\n                </div>`},dropdownContent(t){var e=this.settings,i=this.state.dropdown.suggestions;return`\\n            ${e.templates.dropdownHeader.call(this,i)}\\n            ${t}\\n            ${e.templates.dropdownFooter.call(this,i)}\\n        `},dropdownItem(t){return`<div ${this.getAttributes(t)}\\n                    class='${this.settings.classNames.dropdownItem} ${t.class?t.class:\"\"}'\\n                    tabindex=\"0\"\\n                    role=\"option\">${t.mappedValue||t.value}</div>`},dropdownHeader(t){return`<header data-selector='tagify-suggestions-header' class=\"${this.settings.classNames.dropdownHeader}\"></header>`},dropdownFooter(t){var e=t.length-this.settings.dropdown.maxItems;return e>0?`<footer data-selector='tagify-suggestions-footer' class=\"${this.settings.classNames.dropdownFooter}\">\\n                ${e} more items. Refine your search.\\n            </footer>`:\"\"},dropdownItemNoMatch:null};var I={customBinding(){this.customEventsList.forEach((t=>{this.on(t,this.settings.callbacks[t])}))},binding(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];var e,i=this.events.callbacks,s=t?\"addEventListener\":\"removeEventListener\";if(!this.state.mainEvents||!t){for(var a in this.state.mainEvents=t,t&&!this.listeners.main&&(this.events.bindGlobal.call(this),this.settings.isJQueryPlugin&&jQuery(this.DOM.originalInput).on(\"tagify.removeAllTags\",this.removeAllTags.bind(this))),e=this.listeners.main=this.listeners.main||{focus:[\"input\",i.onFocusBlur.bind(this)],keydown:[\"input\",i.onKeydown.bind(this)],click:[\"scope\",i.onClickScope.bind(this)],dblclick:[\"scope\",i.onDoubleClickScope.bind(this)],paste:[\"input\",i.onPaste.bind(this)],drop:[\"input\",i.onDrop.bind(this)],compositionstart:[\"input\",i.onCompositionStart.bind(this)],compositionend:[\"input\",i.onCompositionEnd.bind(this)]})this.DOM[e[a][0]][s](a,e[a][1]);clearInterval(this.listeners.main.originalInputValueObserverInterval),this.listeners.main.originalInputValueObserverInterval=setInterval(i.observeOriginalInputValue.bind(this),500);var n=this.listeners.main.inputMutationObserver||new MutationObserver(i.onInputDOMChange.bind(this));n.disconnect(),\"mix\"==this.settings.mode&&n.observe(this.DOM.input,{childList:!0})}},bindGlobal(t){var e,i=this.events.callbacks,s=t?\"removeEventListener\":\"addEventListener\";if(this.listeners&&(t||!this.listeners.global))for(e of(this.listeners.global=this.listeners.global||[{type:this.isIE?\"keydown\":\"input\",target:this.DOM.input,cb:i[this.isIE?\"onInputIE\":\"onInput\"].bind(this)},{type:\"keydown\",target:window,cb:i.onWindowKeyDown.bind(this)},{type:\"blur\",target:this.DOM.input,cb:i.onFocusBlur.bind(this)},{type:\"click\",target:document,cb:i.onClickAnywhere.bind(this)}],this.listeners.global))e.target[s](e.type,e.cb)},unbindGlobal(){this.events.bindGlobal.call(this,!0)},callbacks:{onFocusBlur(t){var e=this.settings,i=t.target?this.trim(t.target.textContent):\"\",s=this.value?.[0]?.[e.tagTextProp],a=t.type,n=e.dropdown.enabled>=0,o={relatedTarget:t.relatedTarget},r=this.state.actions.selectOption&&(n||!e.dropdown.closeOnSelect),l=this.state.actions.addNew&&n,d=t.relatedTarget&&v.call(this,t.relatedTarget)&&this.DOM.scope.contains(t.relatedTarget);if(\"blur\"==a){if(t.relatedTarget===this.DOM.scope)return this.dropdown.hide(),void this.DOM.input.focus();this.postUpdate(),e.onChangeAfterBlur&&this.triggerChangeEvent()}if(!r&&!l)if(this.state.hasFocus=\"focus\"==a&&+new Date,this.toggleFocusClass(this.state.hasFocus),\"mix\"!=e.mode){if(\"focus\"==a)return this.trigger(\"focus\",o),void(0!==e.dropdown.enabled&&e.userInput||this.dropdown.show(this.value.length?\"\":void 0));\"blur\"==a&&(this.trigger(\"blur\",o),this.loading(!1),\"select\"==e.mode&&(d&&(this.removeTags(),i=\"\"),s===i&&(i=\"\")),i&&!this.state.actions.selectOption&&e.addTagOnBlur&&this.addTags(i,!0)),this.DOM.input.removeAttribute(\"style\"),this.dropdown.hide()}else\"focus\"==a?this.trigger(\"focus\",o):\"blur\"==t.type&&(this.trigger(\"blur\",o),this.loading(!1),this.dropdown.hide(),this.state.dropdown.visible=void 0,this.setStateSelection())},onCompositionStart(t){this.state.composing=!0},onCompositionEnd(t){this.state.composing=!1},onWindowKeyDown(t){var e,i=document.activeElement,s=v.call(this,i)&&this.DOM.scope.contains(document.activeElement),a=s&&i.hasAttribute(\"readonly\");if(s&&!a)switch(e=i.nextElementSibling,t.key){case\"Backspace\":this.settings.readonly||(this.removeTags(i),(e||this.DOM.input).focus());break;case\"Enter\":setTimeout(this.editTag.bind(this),0,i)}},onKeydown(t){var e=this.settings;if(!this.state.composing&&e.userInput){\"select\"==e.mode&&e.enforceWhitelist&&this.value.length&&\"Tab\"!=t.key&&t.preventDefault();var i=this.trim(t.target.textContent);if(this.trigger(\"keydown\",{event:t}),\"mix\"==e.mode){switch(t.key){case\"Left\":case\"ArrowLeft\":this.state.actions.ArrowLeft=!0;break;case\"Delete\":case\"Backspace\":if(this.state.editing)return;var s=document.getSelection(),a=\"Delete\"==t.key&&s.anchorOffset==(s.anchorNode.length||0),n=s.anchorNode.previousSibling,r=1==s.anchorNode.nodeType||!s.anchorOffset&&n&&1==n.nodeType&&s.anchorNode.previousSibling;o(this.DOM.input.innerHTML);var d,h,g,p=this.getTagElms();if(\"edit\"==e.backspace&&r)return d=1==s.anchorNode.nodeType?null:s.anchorNode.previousElementSibling,setTimeout(this.editTag.bind(this),0,d),void t.preventDefault();if(u()&&r instanceof Element)return g=l(r),r.hasAttribute(\"readonly\")||r.remove(),this.DOM.input.focus(),void setTimeout((()=>{this.placeCaretAfterNode(g),this.DOM.input.click()}));if(\"BR\"==s.anchorNode.nodeName)return;if((a||r)&&1==s.anchorNode.nodeType?h=0==s.anchorOffset?a?p[0]:null:p[Math.min(p.length,s.anchorOffset)-1]:a?h=s.anchorNode.nextElementSibling:r instanceof Element&&(h=r),3==s.anchorNode.nodeType&&!s.anchorNode.nodeValue&&s.anchorNode.previousElementSibling&&t.preventDefault(),(r||a)&&!e.backspace)return void t.preventDefault();if(\"Range\"!=s.type&&!s.anchorOffset&&s.anchorNode==this.DOM.input&&\"Delete\"!=t.key)return void t.preventDefault();if(\"Range\"!=s.type&&h&&h.hasAttribute(\"readonly\"))return void this.placeCaretAfterNode(l(h));clearTimeout(O),O=setTimeout((()=>{var t=document.getSelection();o(this.DOM.input.innerHTML),!a&&t.anchorNode.previousSibling,this.value=[].map.call(p,((t,e)=>{var i=T(t);if(t.parentNode||i.readonly)return i;this.trigger(\"remove\",{tag:t,index:e,data:i})})).filter((t=>t))}),20)}return!0}switch(t.key){case\"Backspace\":\"select\"==e.mode&&e.enforceWhitelist&&this.value.length?this.removeTags():this.state.dropdown.visible&&\"manual\"!=e.dropdown.position||\"\"!=t.target.textContent&&8203!=i.charCodeAt(0)||(!0===e.backspace?this.removeTags():\"edit\"==e.backspace&&setTimeout(this.editTag.bind(this),0));break;case\"Esc\":case\"Escape\":if(this.state.dropdown.visible)return;t.target.blur();break;case\"Down\":case\"ArrowDown\":this.state.dropdown.visible||this.dropdown.show();break;case\"ArrowRight\":{let t=this.state.inputSuggestion||this.state.ddItemData;if(t&&e.autoComplete.rightKey)return void this.addTags([t],!0);break}case\"Tab\":{let s=\"select\"==e.mode;if(!i||s)return!0;t.preventDefault()}case\"Enter\":if(this.state.dropdown.visible&&\"manual\"!=e.dropdown.position)return;t.preventDefault(),setTimeout((()=>{this.state.dropdown.visible||this.state.actions.selectOption||this.addTags(i,!0)}))}}},onInput(t){this.postUpdate();var e=this.settings;if(\"mix\"==e.mode)return this.events.callbacks.onMixTagsInput.call(this,t);var i=this.input.normalize.call(this),s=i.length>=e.dropdown.enabled,a={value:i,inputElm:this.DOM.input},n=this.validateTag({value:i});\"select\"==e.mode&&this.toggleScopeValidation(n),a.isValid=n,this.state.inputText!=i&&(this.input.set.call(this,i,!1),-1!=i.search(e.delimiters)?this.addTags(i)&&this.input.set.call(this):e.dropdown.enabled>=0&&this.dropdown[s?\"show\":\"hide\"](i),this.trigger(\"input\",a))},onMixTagsInput(t){var e,i,s,a,n,o,r,l,d=this.settings,h=this.value.length,p=this.getTagElms(),c=document.createDocumentFragment(),m=window.getSelection().getRangeAt(0),v=[].map.call(p,(t=>T(t).value));if(\"deleteContentBackward\"==t.inputType&&u()&&this.events.callbacks.onKeydown.call(this,{target:t.target,key:\"Backspace\"}),this.value.slice().forEach((t=>{t.readonly&&!v.includes(t.value)&&c.appendChild(this.createTagElem(t))})),c.childNodes.length&&(m.insertNode(c),this.setRangeAtStartEnd(!1,c.lastChild)),p.length!=h)return this.value=[].map.call(this.getTagElms(),(t=>T(t))),void this.update({withoutChangeEvent:!0});if(this.hasMaxTags())return!0;if(window.getSelection&&(o=window.getSelection()).rangeCount>0&&3==o.anchorNode.nodeType){if((m=o.getRangeAt(0).cloneRange()).collapse(!0),m.setStart(o.focusNode,0),s=(e=m.toString().slice(0,m.endOffset)).split(d.pattern).length-1,(i=e.match(d.pattern))&&(a=e.slice(e.lastIndexOf(i[i.length-1]))),a){if(this.state.actions.ArrowLeft=!1,this.state.tag={prefix:a.match(d.pattern)[0],value:a.replace(d.pattern,\"\")},this.state.tag.baseOffset=o.baseOffset-this.state.tag.value.length,l=this.state.tag.value.match(d.delimiters))return this.state.tag.value=this.state.tag.value.replace(d.delimiters,\"\"),this.state.tag.delimiters=l[0],this.addTags(this.state.tag.value,d.dropdown.clearOnSelect),void this.dropdown.hide();n=this.state.tag.value.length>=d.dropdown.enabled;try{r=(r=this.state.flaggedTags[this.state.tag.baseOffset]).prefix==this.state.tag.prefix&&r.value[0]==this.state.tag.value[0],this.state.flaggedTags[this.state.tag.baseOffset]&&!this.state.tag.value&&delete this.state.flaggedTags[this.state.tag.baseOffset]}catch(t){}(r||s<this.state.mixMode.matchedPatternCount)&&(n=!1)}else this.state.flaggedTags={};this.state.mixMode.matchedPatternCount=s}setTimeout((()=>{this.update({withoutChangeEvent:!0}),this.trigger(\"input\",g({},this.state.tag,{textContent:this.DOM.input.textContent})),this.state.tag&&this.dropdown[n?\"show\":\"hide\"](this.state.tag.value)}),10)},onInputIE(t){var e=this;setTimeout((function(){e.events.callbacks.onInput.call(e,t)}))},observeOriginalInputValue(){this.DOM.originalInput.parentNode||this.destroy(),this.DOM.originalInput.value!=this.DOM.originalInput.tagifyValue&&this.loadOriginalValues()},onClickAnywhere(t){t.target==this.DOM.scope||this.DOM.scope.contains(t.target)||(this.toggleFocusClass(!1),this.state.hasFocus=!1)},onClickScope(t){var e=this.settings,i=t.target.closest(\".\"+e.classNames.tag),s=+new Date-this.state.hasFocus;if(t.target!=this.DOM.scope){if(!t.target.classList.contains(e.classNames.tagX))return i?(this.trigger(\"click\",{tag:i,index:this.getNodeIndex(i),data:T(i),event:t}),void(1!==e.editTags&&1!==e.editTags.clicks||this.events.callbacks.onDoubleClickScope.call(this,t))):void(t.target==this.DOM.input&&(\"mix\"==e.mode&&this.fixFirefoxLastTagNoCaret(),s>500)?this.state.dropdown.visible?this.dropdown.hide():0===e.dropdown.enabled&&\"mix\"!=e.mode&&this.dropdown.show(this.value.length?\"\":void 0):\"select\"!=e.mode||0!==e.dropdown.enabled||this.state.dropdown.visible||this.dropdown.show());this.removeTags(t.target.parentNode)}else this.DOM.input.focus()},onPaste(t){t.preventDefault();var e,i,s=this.settings;if(\"select\"==s.mode&&s.enforceWhitelist||!s.userInput)return!1;s.readonly||(e=t.clipboardData||window.clipboardData,i=e.getData(\"Text\"),s.hooks.beforePaste(t,{tagify:this,pastedText:i,clipboardData:e}).then((e=>{void 0===e&&(e=i),e&&(this.injectAtCaret(e,window.getSelection().getRangeAt(0)),\"mix\"==this.settings.mode?this.events.callbacks.onMixTagsInput.call(this,t):this.settings.pasteAsTags?this.addTags(this.state.inputText+e,!0):this.state.inputText=e)})).catch((t=>t)))},onDrop(t){t.preventDefault()},onEditTagInput(t,e){var i=t.closest(\".\"+this.settings.classNames.tag),s=this.getNodeIndex(i),a=T(i),n=this.input.normalize.call(this,t),o={[this.settings.tagTextProp]:n,__tagId:a.__tagId},r=this.validateTag(o);this.editTagChangeDetected(g(a,o))||!0!==t.originalIsValid||(r=!0),i.classList.toggle(this.settings.classNames.tagInvalid,!0!==r),a.__isValid=r,i.title=!0===r?a.title||a.value:r,n.length>=this.settings.dropdown.enabled&&(this.state.editing&&(this.state.editing.value=n),this.dropdown.show(n)),this.trigger(\"edit:input\",{tag:i,index:s,data:g({},this.value[s],{newValue:n}),event:e})},onEditTagPaste(t,e){var i=(e.clipboardData||window.clipboardData).getData(\"Text\");e.preventDefault();var s=f(i);this.setRangeAtStartEnd(!1,s)},onEditTagFocus(t){this.state.editing={scope:t,input:t.querySelector(\"[contenteditable]\")}},onEditTagBlur(t){if(this.state.hasFocus||this.toggleFocusClass(),this.DOM.scope.contains(t)){var e,i,s=this.settings,a=t.closest(\".\"+s.classNames.tag),n=T(a),o=this.input.normalize.call(this,t),r={[s.tagTextProp]:o,__tagId:n.__tagId},l=n.__originalData,d=this.editTagChangeDetected(g(n,r)),h=this.validateTag(r);if(o)if(d){if(e=this.hasMaxTags(),i=g({},l,{[s.tagTextProp]:this.trim(o),__isValid:h}),s.transformTag.call(this,i,l),!0!==(h=(!e||!0===l.__isValid)&&this.validateTag(i))){if(this.trigger(\"invalid\",{data:i,tag:a,message:h}),s.editTags.keepInvalid)return;s.keepInvalidTags?i.__isValid=h:i=l}else s.keepInvalidTags&&(delete i.title,delete i[\"aria-invalid\"],delete i.class);this.onEditTagDone(a,i)}else this.onEditTagDone(a,l);else this.onEditTagDone(a)}},onEditTagkeydown(t,e){if(!this.state.composing)switch(this.trigger(\"edit:keydown\",{event:t}),t.key){case\"Esc\":case\"Escape\":e.parentNode.replaceChild(e.__tagifyTagData.__originalHTML,e),this.state.editing=!1;case\"Enter\":case\"Tab\":t.preventDefault(),t.target.blur()}},onDoubleClickScope(t){var e,i,s=t.target.closest(\".\"+this.settings.classNames.tag),a=T(s),n=this.settings;s&&n.userInput&&!1!==a.editable&&(e=s.classList.contains(this.settings.classNames.tagEditing),i=s.hasAttribute(\"readonly\"),\"select\"==n.mode||n.readonly||e||i||!this.settings.editTags||this.editTag(s),this.toggleFocusClass(!0),this.trigger(\"dblclick\",{tag:s,index:this.getNodeIndex(s),data:T(s)}))},onInputDOMChange(t){t.forEach((t=>{t.addedNodes.forEach((t=>{if(\"<div><br></div>\"==t.outerHTML)t.replaceWith(document.createElement(\"br\"));else if(1==t.nodeType&&t.querySelector(this.settings.classNames.tagSelector)){let e=document.createTextNode(\"\");3==t.childNodes[0].nodeType&&\"BR\"!=t.previousSibling.nodeName&&(e=document.createTextNode(\"\\n\")),t.replaceWith(e,...[...t.childNodes].slice(0,-1)),this.placeCaretAfterNode(e)}else if(v.call(this,t)&&(3!=t.previousSibling?.nodeType||t.previousSibling.textContent||t.previousSibling.remove(),t.previousSibling&&\"BR\"==t.previousSibling.nodeName)){t.previousSibling.replaceWith(\"\\n​\");let e=t.nextSibling,i=\"\";for(;e;)i+=e.textContent,e=e.nextSibling;i.trim()&&this.placeCaretAfterNode(t.previousSibling)}})),t.removedNodes.forEach((t=>{t&&\"BR\"==t.nodeName&&v.call(this,e)&&(this.removeTags(e),this.fixFirefoxLastTagNoCaret())}))}));var e=this.DOM.input.lastChild;e&&\"\"==e.nodeValue&&e.remove(),e&&\"BR\"==e.nodeName||this.DOM.input.appendChild(document.createElement(\"br\"))}}};function N(t,e){if(!t){console.warn(\"Tagify:\",\"input element not found\",t);const e=new Proxy(this,{get:()=>()=>e});return e}if(t.__tagify)return console.warn(\"Tagify: \",\"input element is already Tagified - Same instance is returned.\",t),t.__tagify;var i;g(this,function(t){var e=document.createTextNode(\"\");function i(t,i,s){s&&i.split(/\\s+/g).forEach((i=>e[t+\"EventListener\"].call(e,i,s)))}return{off(t,e){return i(\"remove\",t,e),this},on(t,e){return e&&\"function\"==typeof e&&i(\"add\",t,e),this},trigger(i,s,a){var n;if(a=a||{cloneData:!0},i)if(t.settings.isJQueryPlugin)\"remove\"==i&&(i=\"removeTag\"),jQuery(t.DOM.originalInput).triggerHandler(i,[s]);else{try{var o=\"object\"==typeof s?s:{value:s};if((o=a.cloneData?g({},o):o).tagify=this,s.event&&(o.event=this.cloneEvent(s.event)),s instanceof Object)for(var r in s)s[r]instanceof HTMLElement&&(o[r]=s[r]);n=new CustomEvent(i,{detail:o})}catch(t){console.warn(t)}e.dispatchEvent(n)}}}}(this)),this.isFirefox=/firefox|fxios/i.test(navigator.userAgent)&&!/seamonkey/i.test(navigator.userAgent),this.isIE=window.document.documentMode,e=e||{},this.getPersistedData=(i=e.id,t=>{let e,s=\"/\"+t;if(1==localStorage.getItem(x+i+\"/v\",1))try{e=JSON.parse(localStorage[x+i+s])}catch(t){}return e}),this.setPersistedData=(t=>t?(localStorage.setItem(x+t+\"/v\",1),(e,i)=>{let s=\"/\"+i,a=JSON.stringify(e);e&&i&&(localStorage.setItem(x+t+s,a),dispatchEvent(new Event(\"storage\")))}):()=>{})(e.id),this.clearPersistedData=(t=>e=>{const i=x+\"/\"+t+\"/\";if(e)localStorage.removeItem(i+e);else for(let t in localStorage)t.includes(i)&&localStorage.removeItem(t)})(e.id),this.applySettings(t,e),this.state={inputText:\"\",editing:!1,composing:!1,actions:{},mixMode:{},dropdown:{},flaggedTags:{}},this.value=[],this.listeners={},this.DOM={},this.build(t),b.call(this),this.getCSSVars(),this.loadOriginalValues(),this.events.customBinding.call(this),this.events.binding.call(this),t.autofocus&&this.DOM.input.focus(),t.__tagify=this}return N.prototype={_dropdown:y,getSetTagData:T,helpers:{sameStr:s,removeCollectionProp:a,omit:n,isObject:h,parseHTML:r,escapeHTML:d,extend:g,concatWithoutDups:p,getUID:m,isNodeTag:v},customEventsList:[\"change\",\"add\",\"remove\",\"invalid\",\"input\",\"click\",\"keydown\",\"focus\",\"blur\",\"edit:input\",\"edit:beforeUpdate\",\"edit:updated\",\"edit:start\",\"edit:keydown\",\"dropdown:show\",\"dropdown:hide\",\"dropdown:select\",\"dropdown:updated\",\"dropdown:noMatch\",\"dropdown:scroll\"],dataProps:[\"__isValid\",\"__removed\",\"__originalData\",\"__originalHTML\",\"__tagId\"],trim(t){return this.settings.trim&&t&&\"string\"==typeof t?t.trim():t},parseHTML:r,templates:M,parseTemplate(t,e){return r((t=this.settings.templates[t]||t).apply(this,e))},set whitelist(t){const e=t&&Array.isArray(t);this.settings.whitelist=e?t:[],this.setPersistedData(e?t:[],\"whitelist\")},get whitelist(){return this.settings.whitelist},generateClassSelectors(t){for(let e in t){let i=e;Object.defineProperty(t,i+\"Selector\",{get(){return\".\"+this[i].split(\" \")[0]}})}},applySettings(t,i){w.templates=this.templates;var s=g({},w,\"mix\"==i.mode?{dropdown:{position:\"text\"}}:{}),a=this.settings=g({},s,i);if(a.disabled=t.hasAttribute(\"disabled\"),a.readonly=a.readonly||t.hasAttribute(\"readonly\"),a.placeholder=d(t.getAttribute(\"placeholder\")||a.placeholder||\"\"),a.required=t.hasAttribute(\"required\"),this.generateClassSelectors(a.classNames),void 0===a.dropdown.includeSelectedTags&&(a.dropdown.includeSelectedTags=a.duplicates),this.isIE&&(a.autoComplete=!1),[\"whitelist\",\"blacklist\"].forEach((e=>{var i=t.getAttribute(\"data-\"+e);i&&(i=i.split(a.delimiters))instanceof Array&&(a[e]=i)})),\"autoComplete\"in i&&!h(i.autoComplete)&&(a.autoComplete=w.autoComplete,a.autoComplete.enabled=i.autoComplete),\"mix\"==a.mode&&(a.pattern=a.pattern||/@/,a.autoComplete.rightKey=!0,a.delimiters=i.delimiters||null,a.tagTextProp&&!a.dropdown.searchKeys.includes(a.tagTextProp)&&a.dropdown.searchKeys.push(a.tagTextProp)),t.pattern)try{a.pattern=new RegExp(t.pattern)}catch(t){}if(a.delimiters){a._delimiters=a.delimiters;try{a.delimiters=new RegExp(this.settings.delimiters,\"g\")}catch(t){}}a.disabled&&(a.userInput=!1),this.TEXTS=e(e({},D),a.texts||{}),(\"select\"!=a.mode||i.dropdown?.enabled)&&a.userInput||(a.dropdown.enabled=0),a.dropdown.appendTarget=i.dropdown?.appendTarget||document.body;let n=this.getPersistedData(\"whitelist\");Array.isArray(n)&&(this.whitelist=Array.isArray(a.whitelist)?p(a.whitelist,n):n)},getAttributes(t){var e,i=this.getCustomAttributes(t),s=\"\";for(e in i)s+=\" \"+e+(void 0!==t[e]?`=\"${i[e]}\"`:\"\");return s},getCustomAttributes(t){if(!h(t))return\"\";var e,i={};for(e in t)\"__\"!=e.slice(0,2)&&\"class\"!=e&&t.hasOwnProperty(e)&&void 0!==t[e]&&(i[e]=d(t[e]));return i},setStateSelection(){var t=window.getSelection(),e={anchorOffset:t.anchorOffset,anchorNode:t.anchorNode,range:t.getRangeAt&&t.rangeCount&&t.getRangeAt(0)};return this.state.selection=e,e},getCSSVars(){var t=getComputedStyle(this.DOM.scope,null);var e;this.CSSVars={tagHideTransition:(t=>{let e=t.value;return\"s\"==t.unit?1e3*e:e})(function(t){if(!t)return{};var e=(t=t.trim().split(\" \")[0]).split(/\\d+/g).filter((t=>t)).pop().trim();return{value:+t.split(e).filter((t=>t))[0].trim(),unit:e}}((e=\"tag-hide-transition\",t.getPropertyValue(\"--\"+e))))}},build(t){var e=this.DOM;this.settings.mixMode.integrated?(e.originalInput=null,e.scope=t,e.input=t):(e.originalInput=t,e.originalInput_tabIndex=t.tabIndex,e.scope=this.parseTemplate(\"wrapper\",[t,this.settings]),e.input=e.scope.querySelector(this.settings.classNames.inputSelector),t.parentNode.insertBefore(e.scope,t),t.tabIndex=-1)},destroy(){this.events.unbindGlobal.call(this),this.DOM.scope.parentNode.removeChild(this.DOM.scope),this.DOM.originalInput.tabIndex=this.DOM.originalInput_tabIndex,delete this.DOM.originalInput.__tagify,this.dropdown.hide(!0),clearTimeout(this.dropdownHide__bindEventsTimeout),clearInterval(this.listeners.main.originalInputValueObserverInterval)},loadOriginalValues(t){var e,i=this.settings;if(this.state.blockChangeEvent=!0,void 0===t){const e=this.getPersistedData(\"value\");t=e&&!this.DOM.originalInput.value?e:i.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value}if(this.removeAllTags(),t)if(\"mix\"==i.mode)this.parseMixTags(t),(e=this.DOM.input.lastChild)&&\"BR\"==e.tagName||this.DOM.input.insertAdjacentHTML(\"beforeend\",\"<br>\");else{try{JSON.parse(t)instanceof Array&&(t=JSON.parse(t))}catch(t){}this.addTags(t,!0).forEach((t=>t&&t.classList.add(i.classNames.tagNoAnimation)))}else this.postUpdate();this.state.lastOriginalValueReported=i.mixMode.integrated?\"\":this.DOM.originalInput.value},cloneEvent(t){var e={};for(var i in t)\"path\"!=i&&(e[i]=t[i]);return e},loading(t){return this.state.isLoading=t,this.DOM.scope.classList[t?\"add\":\"remove\"](this.settings.classNames.scopeLoading),this},tagLoading(t,e){return t&&t.classList[e?\"add\":\"remove\"](this.settings.classNames.tagLoading),this},toggleClass(t,e){\"string\"==typeof t&&this.DOM.scope.classList.toggle(t,e)},toggleScopeValidation(t){var e=!0===t||void 0===t;!this.settings.required&&t&&t===this.TEXTS.empty&&(e=!0),this.toggleClass(this.settings.classNames.tagInvalid,!e),this.DOM.scope.title=e?\"\":t},toggleFocusClass(t){this.toggleClass(this.settings.classNames.focus,!!t)},triggerChangeEvent:function(){if(!this.settings.mixMode.integrated){var t=this.DOM.originalInput,e=this.state.lastOriginalValueReported!==t.value,i=new CustomEvent(\"change\",{bubbles:!0});e&&(this.state.lastOriginalValueReported=t.value,i.simulated=!0,t._valueTracker&&t._valueTracker.setValue(Math.random()),t.dispatchEvent(i),this.trigger(\"change\",this.state.lastOriginalValueReported),t.value=this.state.lastOriginalValueReported)}},events:I,fixFirefoxLastTagNoCaret(){},setRangeAtStartEnd(t,e){if(e){t=\"number\"==typeof t?t:!!t,e=e.lastChild||e;var i=document.getSelection();if(i.focusNode instanceof Element&&!this.DOM.input.contains(i.focusNode))return!0;try{i.rangeCount>=1&&[\"Start\",\"End\"].forEach((s=>i.getRangeAt(0)[\"set\"+s](e,t||e.length)))}catch(t){}}},placeCaretAfterNode(t){if(t&&t.parentNode){var e=t,i=window.getSelection(),s=i.getRangeAt(0);i.rangeCount&&(s.setStartAfter(e),s.collapse(!0),i.removeAllRanges(),i.addRange(s))}},insertAfterTag(t,e){if(e=e||this.settings.mixMode.insertAfterTag,t&&t.parentNode&&e)return e=\"string\"==typeof e?document.createTextNode(e):e,t.parentNode.insertBefore(e,t.nextSibling),e},editTagChangeDetected(t){var e=t.__originalData;for(var i in e)if(!this.dataProps.includes(i)&&t[i]!=e[i])return!0;return!1},getTagTextNode(t){return t.querySelector(this.settings.classNames.tagTextSelector)},setTagTextNode(t,e){this.getTagTextNode(t).innerHTML=d(e)},editTag(t,e){t=t||this.getLastTag(),e=e||{},this.dropdown.hide();var i=this.settings,s=this.getTagTextNode(t),a=this.getNodeIndex(t),n=T(t),o=this.events.callbacks,r=this,l=!0;if(s){if(!(n instanceof Object&&\"editable\"in n)||n.editable)return n=T(t,{__originalData:g({},n),__originalHTML:t.cloneNode(!0)}),T(n.__originalHTML,n.__originalData),s.setAttribute(\"contenteditable\",!0),t.classList.add(i.classNames.tagEditing),s.addEventListener(\"focus\",o.onEditTagFocus.bind(this,t)),s.addEventListener(\"blur\",(function(){setTimeout((()=>o.onEditTagBlur.call(r,r.getTagTextNode(t))))})),s.addEventListener(\"input\",o.onEditTagInput.bind(this,s)),s.addEventListener(\"paste\",o.onEditTagPaste.bind(this,s)),s.addEventListener(\"keydown\",(e=>o.onEditTagkeydown.call(this,e,t))),s.addEventListener(\"compositionstart\",o.onCompositionStart.bind(this)),s.addEventListener(\"compositionend\",o.onCompositionEnd.bind(this)),e.skipValidation||(l=this.editTagToggleValidity(t)),s.originalIsValid=l,this.trigger(\"edit:start\",{tag:t,index:a,data:n,isValid:l}),s.focus(),this.setRangeAtStartEnd(!1,s),this}else console.warn(\"Cannot find element in Tag template: .\",i.classNames.tagTextSelector)},editTagToggleValidity(t,e){var i;if(e=e||T(t))return(i=!(\"__isValid\"in e)||!0===e.__isValid)||this.removeTagsFromValue(t),this.update(),t.classList.toggle(this.settings.classNames.tagNotAllowed,!i),e.__isValid;console.warn(\"tag has no data: \",t,e)},onEditTagDone(t,e){e=e||{};var i={tag:t=t||this.state.editing.scope,index:this.getNodeIndex(t),previousData:T(t),data:e};this.trigger(\"edit:beforeUpdate\",i,{cloneData:!1}),this.state.editing=!1,delete e.__originalData,delete e.__originalHTML,t&&e[this.settings.tagTextProp]?(t=this.replaceTag(t,e),this.editTagToggleValidity(t,e),this.settings.a11y.focusableTags?t.focus():this.placeCaretAfterNode(t)):t&&this.removeTags(t),this.trigger(\"edit:updated\",i),this.dropdown.hide(),this.settings.keepInvalidTags&&this.reCheckInvalidTags()},replaceTag(t,e){e&&e.value||(e=t.__tagifyTagData),e.__isValid&&1!=e.__isValid&&g(e,this.getInvalidTagAttrs(e,e.__isValid));var i=this.createTagElem(e);return t.parentNode.replaceChild(i,t),this.updateValueByDOMTags(),i},updateValueByDOMTags(){this.value.length=0,[].forEach.call(this.getTagElms(),(t=>{t.classList.contains(this.settings.classNames.tagNotAllowed.split(\" \")[0])||this.value.push(T(t))})),this.update()},injectAtCaret(t,e){return!(e=e||this.state.selection?.range)&&t?(this.appendMixTags(t),this):(f(t,e),this.setRangeAtStartEnd(!1,t),this.updateValueByDOMTags(),this.update(),this)},input:{set(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"\",e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var i=this.settings.dropdown.closeOnSelect;this.state.inputText=t,e&&(this.DOM.input.innerHTML=d(\"\"+t)),!t&&i&&this.dropdown.hide.bind(this),this.input.autocomplete.suggest.call(this),this.input.validate.call(this)},raw(){return this.DOM.input.textContent},validate(){var t=!this.state.inputText||!0===this.validateTag({value:this.state.inputText});return this.DOM.input.classList.toggle(this.settings.classNames.inputInvalid,!t),t},normalize(t){var e=t||this.DOM.input,i=[];e.childNodes.forEach((t=>3==t.nodeType&&i.push(t.nodeValue))),i=i.join(\"\\n\");try{i=i.replace(/(?:\\r\\n|\\r|\\n)/g,this.settings.delimiters.source.charAt(0))}catch(t){}return i=i.replace(/\\s/g,\" \"),this.trim(i)},autocomplete:{suggest(t){if(this.settings.autoComplete.enabled){\"string\"==typeof(t=t||{value:\"\"})&&(t={value:t});var e=this.dropdown.getMappedValue(t);if(\"number\"!=typeof e){var i=e.substr(0,this.state.inputText.length).toLowerCase(),s=e.substring(this.state.inputText.length);e&&this.state.inputText&&i==this.state.inputText.toLowerCase()?(this.DOM.input.setAttribute(\"data-suggest\",s),this.state.inputSuggestion=t):(this.DOM.input.removeAttribute(\"data-suggest\"),delete this.state.inputSuggestion)}}},set(t){var e=this.DOM.input.getAttribute(\"data-suggest\"),i=t||(e?this.state.inputText+e:null);return!!i&&(\"mix\"==this.settings.mode?this.replaceTextWithNode(document.createTextNode(this.state.tag.prefix+i)):(this.input.set.call(this,i),this.setRangeAtStartEnd(!1,this.DOM.input)),this.input.autocomplete.suggest.call(this),this.dropdown.hide(),!0)}}},getTagIdx(t){return this.value.findIndex((e=>e.__tagId==(t||{}).__tagId))},getNodeIndex(t){var e=0;if(t)for(;t=t.previousElementSibling;)e++;return e},getTagElms(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var s=\".\"+[...this.settings.classNames.tag.split(\" \"),...e].join(\".\");return[].slice.call(this.DOM.scope.querySelectorAll(s))},getLastTag(){var t=this.DOM.scope.querySelectorAll(`${this.settings.classNames.tagSelector}:not(.${this.settings.classNames.tagHide}):not([readonly])`);return t[t.length-1]},isTagDuplicate(t,e,i){var a=0;if(\"select\"==this.settings.mode)return!1;for(let n of this.value){s(this.trim(\"\"+t),n.value,e)&&i!=n.__tagId&&a++}return a},getTagIndexByValue(t){var e=[];return this.getTagElms().forEach(((i,a)=>{s(this.trim(i.textContent),t,this.settings.dropdown.caseSensitive)&&e.push(a)})),e},getTagElmByValue(t){var e=this.getTagIndexByValue(t)[0];return this.getTagElms()[e]},flashTag(t){t&&(t.classList.add(this.settings.classNames.tagFlash),setTimeout((()=>{t.classList.remove(this.settings.classNames.tagFlash)}),100))},isTagBlacklisted(t){return t=this.trim(t.toLowerCase()),this.settings.blacklist.filter((e=>(\"\"+e).toLowerCase()==t)).length},isTagWhitelisted(t){return!!this.getWhitelistItem(t)},getWhitelistItem(t,e,i){e=e||\"value\";var a,n=this.settings;return(i=i||n.whitelist).some((i=>{var o=\"string\"==typeof i?i:i[e]||i.value;if(s(o,t,n.dropdown.caseSensitive,n.trim))return a=\"string\"==typeof i?{value:i}:i,!0})),a||\"value\"!=e||\"value\"==n.tagTextProp||(a=this.getWhitelistItem(t,n.tagTextProp,i)),a},validateTag(t){var e=this.settings,i=\"value\"in t?\"value\":e.tagTextProp,s=this.trim(t[i]+\"\");return(t[i]+\"\").trim()?e.pattern&&e.pattern instanceof RegExp&&!e.pattern.test(s)?this.TEXTS.pattern:!e.duplicates&&this.isTagDuplicate(s,e.dropdown.caseSensitive,t.__tagId)?this.TEXTS.duplicate:this.isTagBlacklisted(s)||e.enforceWhitelist&&!this.isTagWhitelisted(s)?this.TEXTS.notAllowed:!e.validate||e.validate(t):this.TEXTS.empty},getInvalidTagAttrs(t,e){return{\"aria-invalid\":!0,class:`${t.class||\"\"} ${this.settings.classNames.tagNotAllowed}`.trim(),title:e}},hasMaxTags(){return this.value.length>=this.settings.maxTags&&this.TEXTS.exceed},setReadonly(t,e){var i=this.settings;document.activeElement.blur(),i[e||\"readonly\"]=t,this.DOM.scope[(t?\"set\":\"remove\")+\"Attribute\"](e||\"readonly\",!0),this.setContentEditable(!t)},setContentEditable(t){this.settings.userInput&&(this.DOM.input.contentEditable=t,this.DOM.input.tabIndex=t?0:-1)},setDisabled(t){this.setReadonly(t,\"disabled\")},normalizeTags(t){var e=this.settings,i=e.whitelist,s=e.delimiters,a=e.mode,n=e.tagTextProp,o=[],r=!!i&&i[0]instanceof Object,l=Array.isArray(t),d=l&&t[0].value,h=t=>(t+\"\").split(s).filter((t=>t)).map((t=>({[n]:this.trim(t),value:this.trim(t)})));if(\"number\"==typeof t&&(t=t.toString()),\"string\"==typeof t){if(!t.trim())return[];t=h(t)}else l&&(t=[].concat(...t.map((t=>null!=t.value?t:h(t)))));return r&&!d&&(t.forEach((t=>{var e=o.map((t=>t.value)),i=this.dropdown.filterListItems.call(this,t[n],{exact:!0});this.settings.duplicates||(i=i.filter((t=>!e.includes(t.value))));var s=i.length>1?this.getWhitelistItem(t[n],n,i):i[0];s&&s instanceof Object?o.push(s):\"mix\"!=a&&(null==t.value&&(t.value=t[n]),o.push(t))})),o.length&&(t=o)),t},parseMixTags(t){var e=this.settings,i=e.mixTagsInterpolator,s=e.duplicates,a=e.transformTag,n=e.enforceWhitelist,o=e.maxTags,r=e.tagTextProp,l=[];return t=t.split(i[0]).map(((t,e)=>{var d,h,g,p=t.split(i[1]),c=p[0],u=l.length==o;try{if(c==+c)throw Error;h=JSON.parse(c)}catch(t){h=this.normalizeTags(c)[0]||{value:c}}if(a.call(this,h),u||!(p.length>1)||n&&!this.isTagWhitelisted(h.value)||!s&&this.isTagDuplicate(h.value)){if(t)return e?i[0]+t:t}else h[d=h[r]?r:\"value\"]=this.trim(h[d]),g=this.createTagElem(h),l.push(h),g.classList.add(this.settings.classNames.tagNoAnimation),p[0]=g.outerHTML,this.value.push(h);return p.join(\"\")})).join(\"\"),this.DOM.input.innerHTML=t,this.DOM.input.appendChild(document.createTextNode(\"\")),this.DOM.input.normalize(),this.getTagElms().forEach(((t,e)=>T(t,l[e]))),this.update({withoutChangeEvent:!0}),t},replaceTextWithNode(t,e){if(this.state.tag||e){e=e||this.state.tag.prefix+this.state.tag.value;var i,s,a=this.state.selection||window.getSelection(),n=a.anchorNode,o=this.state.tag.delimiters?this.state.tag.delimiters.length:0;return n.splitText(a.anchorOffset-o),-1==(i=n.nodeValue.lastIndexOf(e))?!0:(s=n.splitText(i),t&&n.parentNode.replaceChild(t,s),!0)}},selectTag(t,e){var i=this.settings;if(!i.enforceWhitelist||this.isTagWhitelisted(e.value)){this.input.set.call(this,e[i.tagTextProp]||e.value,!0),this.state.actions.selectOption&&setTimeout((()=>this.setRangeAtStartEnd(!1,this.DOM.input)));var s=this.getLastTag();return s?this.replaceTag(s,e):this.appendTag(t),this.value[0]=e,this.update(),this.trigger(\"add\",{tag:t,data:e}),[t]}},addEmptyTag(t){var e=g({value:\"\"},t||{}),i=this.createTagElem(e);T(i,e),this.appendTag(i),this.editTag(i,{skipValidation:!0})},addTags(t,e,i){var s=[],a=this.settings,n=[],o=document.createDocumentFragment();if(i=i||a.skipInvalid,!t||0==t.length)return s;switch(t=this.normalizeTags(t),a.mode){case\"mix\":return this.addMixTags(t);case\"select\":e=!1,this.removeAllTags()}return this.DOM.input.removeAttribute(\"style\"),t.forEach((t=>{var e,r={},l=Object.assign({},t,{value:t.value+\"\"});if(t=Object.assign({},l),a.transformTag.call(this,t),t.__isValid=this.hasMaxTags()||this.validateTag(t),!0!==t.__isValid){if(i)return;if(g(r,this.getInvalidTagAttrs(t,t.__isValid),{__preInvalidData:l}),t.__isValid==this.TEXTS.duplicate&&this.flashTag(this.getTagElmByValue(t.value)),!a.createInvalidTags)return void n.push(t.value)}if(\"readonly\"in t&&(t.readonly?r[\"aria-readonly\"]=!0:delete t.readonly),e=this.createTagElem(t,r),s.push(e),\"select\"==a.mode)return this.selectTag(e,t);o.appendChild(e),t.__isValid&&!0===t.__isValid?(this.value.push(t),this.trigger(\"add\",{tag:e,index:this.value.length-1,data:t})):(this.trigger(\"invalid\",{data:t,index:this.value.length,tag:e,message:t.__isValid}),a.keepInvalidTags||setTimeout((()=>this.removeTags(e,!0)),1e3)),this.dropdown.position()})),this.appendTag(o),this.update(),t.length&&e&&(this.input.set.call(this,a.createInvalidTags?\"\":n.join(a._delimiters)),this.setRangeAtStartEnd(!1,this.DOM.input)),a.dropdown.enabled&&this.dropdown.refilter(),s},addMixTags(t){if((t=this.normalizeTags(t))[0].prefix||this.state.tag)return this.prefixedTextToTag(t[0]);var e=document.createDocumentFragment();return t.forEach((t=>{var i=this.createTagElem(t);e.appendChild(i)})),this.appendMixTags(e),e},appendMixTags(t){var e=!!this.state.selection;e?this.injectAtCaret(t):(this.DOM.input.focus(),(e=this.setStateSelection()).range.setStart(this.DOM.input,e.range.endOffset),e.range.setEnd(this.DOM.input,e.range.endOffset),this.DOM.input.appendChild(t),this.updateValueByDOMTags(),this.update())},prefixedTextToTag(t){var e,i=this.settings,s=this.state.tag.delimiters;if(i.transformTag.call(this,t),t.prefix=t.prefix||this.state.tag?this.state.tag.prefix:(i.pattern.source||i.pattern)[0],e=this.createTagElem(t),this.replaceTextWithNode(e)||this.DOM.input.appendChild(e),setTimeout((()=>e.classList.add(this.settings.classNames.tagNoAnimation)),300),this.value.push(t),this.update(),!s){var a=this.insertAfterTag(e)||e;setTimeout(this.placeCaretAfterNode,0,a)}return this.state.tag=null,this.trigger(\"add\",g({},{tag:e},{data:t})),e},appendTag(t){var e=this.DOM,i=e.input;e.scope.insertBefore(t,i)},createTagElem(t,i){t.__tagId=m();var s,a=g({},t,e({value:d(t.value+\"\")},i));return function(t){for(var e,i=document.createNodeIterator(t,NodeFilter.SHOW_TEXT,null,!1);e=i.nextNode();)e.textContent.trim()||e.parentNode.removeChild(e)}(s=this.parseTemplate(\"tag\",[a,this])),T(s,t),s},reCheckInvalidTags(){var t=this.settings;this.getTagElms(t.classNames.tagNotAllowed).forEach(((e,i)=>{var s=T(e),a=this.hasMaxTags(),n=this.validateTag(s),o=!0===n&&!a;if(\"select\"==t.mode&&this.toggleScopeValidation(n),o)return s=s.__preInvalidData?s.__preInvalidData:{value:s.value},this.replaceTag(e,s);e.title=a||n}))},removeTags(t,e,i){var s,a=this.settings;if(t=t&&t instanceof HTMLElement?[t]:t instanceof Array?t:t?[t]:[this.getLastTag()],s=t.reduce(((t,e)=>{e&&\"string\"==typeof e&&(e=this.getTagElmByValue(e));var i=T(e);return e&&i&&!i.readonly&&t.push({node:e,idx:this.getTagIdx(i),data:T(e,{__removed:!0})}),t}),[]),i=\"number\"==typeof i?i:this.CSSVars.tagHideTransition,\"select\"==a.mode&&(i=0,this.input.set.call(this)),1==s.length&&\"select\"!=a.mode&&s[0].node.classList.contains(a.classNames.tagNotAllowed)&&(e=!0),s.length)return a.hooks.beforeRemoveTag(s,{tagify:this}).then((()=>{function t(t){t.node.parentNode&&(t.node.parentNode.removeChild(t.node),e?a.keepInvalidTags&&this.trigger(\"remove\",{tag:t.node,index:t.idx}):(this.trigger(\"remove\",{tag:t.node,index:t.idx,data:t.data}),this.dropdown.refilter(),this.dropdown.position(),this.DOM.input.normalize(),a.keepInvalidTags&&this.reCheckInvalidTags()))}i&&i>10&&1==s.length?function(e){e.node.style.width=parseFloat(window.getComputedStyle(e.node).width)+\"px\",document.body.clientTop,e.node.classList.add(a.classNames.tagHide),setTimeout(t.bind(this),i,e)}.call(this,s[0]):s.forEach(t.bind(this)),e||(this.removeTagsFromValue(s.map((t=>t.node))),this.update(),\"select\"==a.mode&&this.setContentEditable(!0))})).catch((t=>{}))},removeTagsFromDOM(){[].slice.call(this.getTagElms()).forEach((t=>t.parentNode.removeChild(t)))},removeTagsFromValue(t){(t=Array.isArray(t)?t:[t]).forEach((t=>{var e=T(t),i=this.getTagIdx(e);i>-1&&this.value.splice(i,1)}))},removeAllTags(t){t=t||{},this.value=[],\"mix\"==this.settings.mode?this.DOM.input.innerHTML=\"\":this.removeTagsFromDOM(),this.dropdown.refilter(),this.dropdown.position(),this.state.dropdown.visible&&setTimeout((()=>{this.DOM.input.focus()})),\"select\"==this.settings.mode&&(this.input.set.call(this),this.setContentEditable(!0)),this.update(t)},postUpdate(){this.state.blockChangeEvent=!1;var t=this.settings,e=t.classNames,i=\"mix\"==t.mode?t.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value.trim():this.value.length+this.input.raw.call(this).length;this.toggleClass(e.hasMaxTags,this.value.length>=t.maxTags),this.toggleClass(e.hasNoTags,!this.value.length),this.toggleClass(e.empty,!i),\"select\"==t.mode&&this.toggleScopeValidation(this.value?.[0]?.__isValid)},setOriginalInputValue(t){var e=this.DOM.originalInput;this.settings.mixMode.integrated||(e.value=t,e.tagifyValue=e.value,this.setPersistedData(t,\"value\"))},update(t){clearTimeout(this.debouncedUpdateTimeout),this.debouncedUpdateTimeout=setTimeout(function(){var e=this.getInputValue();this.setOriginalInputValue(e),this.settings.onChangeAfterBlur&&(t||{}).withoutChangeEvent||this.state.blockChangeEvent||this.triggerChangeEvent();this.postUpdate()}.bind(this),100)},getInputValue(){var t=this.getCleanValue();return\"mix\"==this.settings.mode?this.getMixedTagsAsString(t):t.length?this.settings.originalInputValueFormat?this.settings.originalInputValueFormat(t):JSON.stringify(t):\"\"},getCleanValue(t){return a(t||this.value,this.dataProps)},getMixedTagsAsString(){var t=\"\",e=this,i=this.settings,s=i.originalInputValueFormat||JSON.stringify,a=i.mixTagsInterpolator;return function i(o){o.childNodes.forEach((o=>{if(1==o.nodeType){const r=T(o);if(\"BR\"==o.tagName&&(t+=\"\\r\\n\"),r&&v.call(e,o)){if(r.__removed)return;t+=a[0]+s(n(r,e.dataProps))+a[1]}else o.getAttribute(\"style\")||[\"B\",\"I\",\"U\"].includes(o.tagName)?t+=o.textContent:\"DIV\"!=o.tagName&&\"P\"!=o.tagName||(t+=\"\\r\\n\",i(o))}else t+=o.textContent}))}(this.DOM.input),t}},N.prototype.removeTag=N.prototype.removeTags,N}));\n","import { MODULE, TEMPLATE } from '../constants.js'\nimport { Logger, Utils } from '../utils.js'\nimport DragSort from '@yaireo/dragsort'\nimport Tagify from '@yaireo/tagify'\n\n/**\n * Form Application for the dialogs.\n */\nexport class TagDialog extends FormApplication {\n    tagify = null\n    dragSort = null\n\n    constructor (data) {\n        super(data, { title: data.title })\n        this.content = data.content\n        this.submit = data.submit\n        this.categoryId = null\n        this.subcategoryId = null\n    }\n\n    static get defaultOptions () {\n        const defaults = super.defaultOptions\n        const overrides = {\n            classes: ['tah-dialog', 'sheet'],\n            closeOnSubmit: true,\n            id: 'token-action-hud-dialog',\n            popOut: true,\n            resizable: true,\n            height: 'auto',\n            width: 600\n        }\n\n        const mergedOptions = foundry.utils.mergeObject(defaults, overrides)\n\n        return mergedOptions\n    }\n\n    getData (options) {\n        return this.content\n    }\n\n    /**\n     * Activate listeners\n     * @public\n     * @param {object} html The HTML element\n     */\n    activateListeners (html) {\n        super.activateListeners(html)\n        const cancel = html.find('#tah-form-cancel')\n        cancel.on('click', this.close.bind(this))\n\n        const resetActions = html.find('#tah-dialog-reset-actions')\n        resetActions.on('click', this.#resetActions)\n    }\n\n    /**\n     * Show dialog\n     * @public\n     * @param {string} dialogType      The dialog type\n     * @param {string} nestId          The nest id\n     * @param {object} tags            The available and selected tags\n     * @param {object} dialogData      The dialog data\n     * @param {function*} dialogSubmit The dialog submit function\n     */\n    static showDialog (dialogType, nestId, tags, dialogData, dialogSubmit) {\n        this.nestId = nestId\n        TagDialog._prepareHook(tags)\n\n        const data = {\n            title: dialogData.title,\n            content: dialogData.content,\n            submit: dialogSubmit\n        }\n\n        let dialog\n        switch (dialogType) {\n        case 'hud':\n            dialog = new TagDialogHud(data)\n            break\n        case 'topLevelGroup':\n            dialog = new TagDialogTopLevelGroup(data)\n            break\n        case 'group':\n            dialog = new TagDialogGroup(data)\n            break\n        }\n\n        dialog.render(true)\n    }\n\n    /**\n     * Prepare dialog hook\n     * @private\n     * @param {object} tags The tags\n     */\n    static _prepareHook (tags) {\n        Hooks.once('renderTagDialog', (app, html, options) => {\n            const $tagFilter = html.find('input[class=\"tah-dialog-tagify\"]')\n\n            if ($tagFilter.length > 0) {\n                const tagifyOptions = {\n                    delimiters: ';',\n                    maxTags: 'Infinity',\n                    dropdown: {\n                        position: 'manual',\n                        maxItems: Infinity, // <- maximum allowed rendered suggestions\n                        classname: 'tah-dialog-tags-dropdown', // <- custom classname for this dropdown, so it could be targeted\n                        enabled: 0 // <- show suggestions on focus\n                    },\n                    templates: {\n                        dropdownItemNoMatch () {\n                            return '<div class=\\'empty\\'>Nothing Found</div>'\n                        }\n                    }\n                }\n\n                if (tags.available) tagifyOptions.whitelist = tags.available\n                TagDialog.tagify = new Tagify($tagFilter[0], tagifyOptions)\n\n                if (tags.selected) TagDialog.tagify.addTags(tags.selected)\n\n                TagDialog.dragSort = new DragSort(TagDialog.tagify.DOM.scope, {\n                    selector: '.' + TagDialog.tagify.settings.classNames.tag,\n                    callbacks: { dragEnd: onDragEnd }\n                })\n\n                function onDragEnd (elm) {\n                    TagDialog.tagify.updateValueByDOMTags()\n                }\n\n                html.find('.tagify__input').on('keydown', (event) => {\n                    if (event.key === 'Enter') {\n                        event.preventDefault()\n                        TagDialog.tagify.addTags(TagDialog.tagify.state.inputText, !0)\n                    }\n                })\n\n                // \"remove all tags\" button event listener\n                const unselectAllButton = html.find('#tah-dialog-unselect-all')\n                unselectAllButton.on('click', TagDialog.tagify.removeAllTags.bind(TagDialog.tagify))\n\n                if (app.constructor.name === 'TagDialogHud') return\n\n                TagDialog.tagify.dropdown.show()\n                const dropdownLabelElement = document.createElement('div')\n                dropdownLabelElement.classList.add('tah-dialog-label')\n                dropdownLabelElement.innerHTML = Utils.i18n('tokenActionHud.form.hud.availableItems')\n                TagDialog.tagify.DOM.scope.parentNode.appendChild(dropdownLabelElement)\n                TagDialog.tagify.DOM.scope.parentNode.appendChild(TagDialog.tagify.DOM.dropdown)\n            }\n        })\n\n        Hooks.on('renderApplication', (app, html, options) => {\n            if (app.constructor.name.startsWith('TagDialog')) {\n                app.setPosition()\n                app.setPosition({ top: 50 })\n            }\n        })\n    }\n\n    /**\n     * Reset actions\n     * @private\n     */\n    async #resetActions () {\n        const d = new Dialog({\n            title: Utils.i18n('tokenActionHud.dialog.resetActions.title'),\n            content: `<p>${Utils.i18n('tokenActionHud.dialog.resetActions.content')}</p>`,\n            buttons: {\n                yes: {\n                    icon: '<i class=\"fas fa-check\"></i>',\n                    label: Utils.i18n('tokenActionHud.dialog.button.yes'),\n                    callback: async () => {\n                        await game.tokenActionHud.resetActorData()\n                        Logger.info('Actions reset', true)\n                    }\n                },\n                no: {\n                    icon: '<i class=\"fas fa-times\"></i>',\n                    label: Utils.i18n('tokenActionHud.dialog.button.no')\n                }\n            }\n        })\n        d.render(true)\n    }\n\n    /** @override */\n    _onKeyDown (event) {\n    // Close dialog\n        if (event.key === 'Escape' && !event.target.className.includes('tagify')) {\n            event.preventDefault()\n            event.stopPropagation()\n            return this.close()\n        }\n\n        // Confirm default choice\n        if (\n            event.key === 'Enter' &&\n            this.data.default &&\n            !event.target.className.includes('tagify')\n        ) {\n            event.preventDefault()\n            event.stopPropagation()\n            const defaultChoice = this.data.buttons[this.data.default]\n            return this.submit(defaultChoice)\n        }\n    }\n\n    /**\n     * Handle form submission\n     * @param {object} event       The event\n     * @param {object} formDataThe form data\n     */\n    async _updateObject (event, formData) {\n        const selection = TagDialog.tagify.value.map((c) => {\n            c.id = c.id ?? c.value.slugify({ replacement: '-', strict: true })\n            return {\n                id: c.id,\n                listName: c.value,\n                name: c.name ?? c.value,\n                type: c.type\n            }\n        })\n        await this.submit(selection, formData)\n    }\n}\n\nexport class TagDialogHud extends TagDialog {\n    static get defaultOptions () {\n        return foundry.utils.mergeObject(super.defaultOptions,\n            {\n                template: TEMPLATE.tagDialogHud\n            })\n    }\n}\n\nexport class TagDialogTopLevelGroup extends TagDialog {\n    static get defaultOptions () {\n        return foundry.utils.mergeObject(super.defaultOptions, {\n            template: TEMPLATE.tagDialogTopLevelGroup,\n            tabs: [{\n                navSelector: '.tabs',\n                contentSelector: 'form',\n                initial: 'groups'\n            }]\n        })\n    }\n}\n\nexport class TagDialogGroup extends TagDialog {\n    static get defaultOptions () {\n        return foundry.utils.mergeObject(super.defaultOptions, {\n            template: TEMPLATE.tagDialogGroup,\n            tabs: [{\n                navSelector: '.tabs',\n                contentSelector: 'form',\n                initial: 'groups'\n            }]\n        })\n    }\n}\n","import { TEMPLATE } from '../constants.js'\nimport { TagDialog } from './tag-dialog.js'\nimport { Utils } from '../utils.js'\n\n/**\n * Generates data for the dialogs.\n */\nexport class TagDialogHelper {\n    /**\n     * Show the HUD dialog\n     * @public\n     * @param {object} actionHandler The ActionHandler class\n     */\n    static async showHudDialog (actionHandler) {\n        // Set available and selected tags\n        const tags = {}\n        tags.available = []\n        tags.selected = await actionHandler.getSelectedGroups()\n        const grid = await Utils.getSetting('grid')\n\n        // Set dialog data\n        const dialogData = {\n            title: Utils.i18n('tokenActionHud.form.hud.hudTitle'),\n            content: {\n                topLabel: Utils.i18n('tokenActionHud.form.hud.hudDetail'),\n                placeholder: Utils.i18n('tokenActionHud.form.hud.tagPlaceholder'),\n                settings: { grid }\n            }\n        }\n\n        // Set function on submit\n        const dialogSubmit = async (choices, formData) => {\n            const grid = formData?.grid\n            await actionHandler.updateGroups(choices, { level: 0 })\n            await actionHandler.saveGroups({ saveActor: true, saveUser: true })\n            await Utils.setSetting('grid', grid)\n            Hooks.callAll('forceUpdateTokenActionHud')\n        }\n\n        // Show dialog\n        TagDialog.showDialog('hud', null, tags, dialogData, dialogSubmit)\n    }\n\n    /**\n     * Show group dialog\n     * @public\n     * @param {object} actionHandler The ActionHandler class\n     * @param {object} groupData    The group data\n     */\n    static async showGroupDialog (actionHandler, groupData) {\n        const { nestId, name, level } = groupData\n\n        // Set available and selected tags\n        const tags = {}\n\n        // Get available subcategories\n        tags.available = await actionHandler.getAvailableGroups({ nestId, level })\n\n        // Get selected subcategories\n        tags.selected = await actionHandler.getSelectedGroups({ nestId, level })\n\n        // Set dialog data\n        const dialogData = {\n            title: Utils.i18n('tokenActionHud.form.hud.groupTitle') + ` (${name})`,\n            content: {\n                topLabel: Utils.i18n('tokenActionHud.form.hud.groupDetail'),\n                placeholder: Utils.i18n('tokenActionHud.form.hud.tagPlaceholder'),\n                settings: await actionHandler.getGroupSettings(groupData)\n            }\n        }\n\n        // Set function on submit\n        const dialogSubmit = async (choices, formData) => {\n            choices = choices.map((choice) => {\n                choice.id =\n                choice.id ??\n                choice.name.slugify({\n                    replacement: '-',\n                    strict: true\n                })\n                choice.type = choice.type ?? 'custom'\n                return {\n                    id: choice.id,\n                    listName: choice.listName,\n                    name: choice.name,\n                    type: choice.type\n                }\n            })\n\n            const characterCount = formData?.characterCount\n            const customWidth = formData?.customWidth\n            const grid = formData?.grid\n            const image = formData?.image\n            const showTitle = formData?.showTitle\n            const sort = formData?.sort\n            groupData.settings = { characterCount, customWidth, grid, image, showTitle, sort }\n\n            // Save selected subcategories to user action list\n            await actionHandler.updateGroups(choices, groupData)\n            await actionHandler.saveGroups({ saveActor: true, saveUser: true })\n            Hooks.callAll('forceUpdateTokenActionHud')\n        }\n\n        TagDialog.showDialog(\n            'topLevelGroup',\n            nestId,\n            tags,\n            dialogData,\n            dialogSubmit\n        )\n    }\n\n    /**\n     * Show action dialog\n     * @public\n     * @param {object} actionHandler The ActionHandler class\n     * @param {object} groupData    The group data\n     */\n    static async showActionDialog (actionHandler, groupData) {\n        const { nestId, name, level } = groupData\n\n        // Set available and selected tags\n        const tags = {}\n\n        // Get available actions and subcategories\n        const availableActions = await actionHandler.getAvailableActions(groupData)\n        const availableSubcategories = await actionHandler.getAvailableGroups({ nestId, level })\n        tags.available = [...availableActions, ...availableSubcategories]\n\n        // Get selected actions and subcategories\n        const selectedActions = await actionHandler.getSelectedActions(groupData)\n        const selectedGroups = await actionHandler.getSelectedGroups({ nestId, level })\n        tags.selected = [...selectedActions, ...selectedGroups]\n\n        // Set dialog data\n        const dialogData = {\n            title: `${Utils.i18n('tokenActionHud.form.hud.groupTitle')} (${name})`,\n            content: {\n                topLabel: Utils.i18n('tokenActionHud.form.hud.groupDetail'),\n                placeholder: Utils.i18n('tokenActionHud.form.hud.tagPlaceholder'),\n                settings: await actionHandler.getGroupSettings(groupData)\n            }\n        }\n\n        // Set function on submit\n        const dialogSubmit = async (choices, formData) => {\n            const selectedGroups = []\n            const selectedActions = []\n            for (const choice of choices) {\n                if (choice.type === 'action') {\n                    selectedActions.push(choice)\n                } else {\n                    selectedGroups.push(choice)\n                }\n            }\n\n            // Get advanced category options\n            const characterCount = formData?.characterCount\n            const collapse = formData?.collapse\n            const grid = formData?.grid\n            const image = formData?.image\n            const showTitle = formData?.showTitle\n            const sort = formData?.sort\n            const style = formData?.style\n            groupData.settings = { characterCount, collapse, grid, image, showTitle, sort, style }\n\n            // Save subcategories to user action list\n            await actionHandler.updateGroups(selectedGroups, groupData)\n            await actionHandler.updateActions(selectedActions, groupData)\n            await actionHandler.saveGroups({ saveActor: true, saveUser: true })\n\n            Hooks.callAll('forceUpdateTokenActionHud')\n        }\n\n        TagDialog.showDialog(\n            'group',\n            nestId,\n            tags,\n            dialogData,\n            dialogSubmit\n        )\n    }\n}\n","import { Utils } from './utils.js'\n\nexport class GroupResizer {\n    direction = null\n    minCols = 3\n    isCustomWidth = false\n    settings = null\n    spacing = 10\n\n    /**\n     * Resize the groups element\n     * @param {ActionHandler} actionHandler The actionHandler class\n     * @param {object} groupElement         The group element\n     * @param {string} autoDirection        The direction the HUD will expand\n     * @param {boolean} gridModuleSetting   The grid module setting\n     */\n    async resizeGroup (actionHandler, groupElement, autoDirection, gridModuleSetting) {\n        // Exit early if no group element exists\n        if (!groupElement) return\n\n        this.#resetVariables()\n\n        this.groupElement = groupElement\n\n        // Get groups element\n        await this.#getGroupsElement()\n\n        // Exit early if no groups element exists\n        if (!this.groupsElement) return\n\n        this.actionsElements = this.groupElement.querySelectorAll('.tah-actions')\n\n        // Exit early if no action elements exist\n        if (this.actionsElements.length === 0) return\n\n        // Reset groups elements\n        this.#resetGroupsElements()\n\n        // Set direction\n        this.direction = autoDirection\n\n        // Get group settings\n        const nestId = this.groupElement.dataset.nestId\n        this.settings = await actionHandler.getGroupSettings({ nestId, level: 1 })\n\n        // Get available width\n        this.availableWidth = this.#getAvailableWidth()\n\n        // Get groups\n        this.#getGroupElements()\n\n        // Loop groups\n        let hasGrid = false\n        for (const groupElement of this.groupElements) {\n            const actionsElement = groupElement.querySelector('.tah-actions')\n            if (!actionsElement) continue\n            const nestId = groupElement.dataset.nestId\n            const groupSettings = await actionHandler.getGroupSettings({ nestId })\n            const grid = gridModuleSetting || this.settings?.grid || groupSettings?.grid\n            if (grid) {\n                if (!hasGrid) {\n                    await this.#getGridWidth()\n                    hasGrid = true\n                }\n                await this.#resizeGrid(actionsElement)\n            } else {\n                await this.#resize(actionsElement)\n            }\n        }\n\n        // Set group height\n        await this.#setHeight()\n    }\n\n    /**\n     * Reset variables\n     * @private\n     */\n    #resetVariables () {\n        this.actionsElements = null\n        this.availableHeight = null\n        this.availableWidth = null\n        this.direction = null\n        this.gridWidth = null\n        this.groupElement = null\n        this.groupElements = null\n        this.groupsElement = null\n        this.groupsElementPadding = null\n        this.groupsElementRect = null\n        this.isCustomWidth = false\n        this.minCols = 3\n        this.settings = null\n        this.spacing = 10\n    }\n\n    /**\n     * Reset groups elements\n     */\n    #resetGroupsElements () {\n        const level1GroupElement = this.groupElement.closest('.tah-tab-group[data-level=\"1\"]')\n        const groupsElements = level1GroupElement.querySelectorAll('.tah-groups')\n        const style = { maxHeight: '', overflowY: '' }\n        this.#resetCSS(groupsElements, style)\n    }\n\n    /**\n     * Get the grid width\n     * @private\n     */\n    async #getGridWidth () {\n        // Reset action elements\n        const emptyStyle = { display: '', gridTemplateColumns: '', width: '' }\n        await this.#resetCSS(this.actionsElements, emptyStyle)\n\n        const actionWidths = []\n        const actionWidthsForMedian = []\n        for (const actionsElement of this.actionsElements) {\n            const actionElements = actionsElement.querySelectorAll('.tah-action:not(.shrink)')\n            for (const actionElement of actionElements) {\n                const actionRect = actionElement.getBoundingClientRect()\n                const actionWidth = Math.round(parseFloat(actionRect.width) + 1 || 0)\n                const actionButtonText = actionElement.querySelector('.tah-action-button-text')\n                const actionButtonTextRect = actionButtonText?.getBoundingClientRect()\n                const actionButtonTextWidth = Math.round(parseFloat(actionButtonTextRect?.width) || 0)\n                actionWidthsForMedian.push(actionWidth)\n                actionWidths.push({ actionWidth, actionButtonTextWidth })\n            }\n        }\n\n        let upperQuartileAverage = Math.ceil(Utils.getUpperQuartileAverage(actionWidthsForMedian))\n        const minActionButtonTextWidth = 30\n\n        for (const actionWidth of actionWidths) {\n            const availableactionButtonTextWidth = upperQuartileAverage - (actionWidth.actionWidth - actionWidth.actionButtonTextWidth)\n            if (availableactionButtonTextWidth < minActionButtonTextWidth) {\n                upperQuartileAverage = (upperQuartileAverage - availableactionButtonTextWidth) + minActionButtonTextWidth\n            }\n        }\n\n        this.gridWidth = upperQuartileAverage\n    }\n\n    /**\n     * Resize the actions element into the grid format\n     * @private\n     * @param {object} actionsElement The actions element\n     */\n    async #resizeGrid (actionsElement) {\n        if (!actionsElement) return\n        const emptyStyle = { display: '', gridTemplateColumns: '', width: '' }\n        await this.#assignCSS(actionsElement, emptyStyle)\n\n        const actions = actionsElement.querySelectorAll('.tah-action')\n        const squaredCols = Math.ceil(Math.sqrt(actions.length))\n        const availableCols = Math.floor(this.availableWidth / this.gridWidth)\n        const cols = (squaredCols > availableCols) ? availableCols : (actions.length <= this.minCols) ? actions.length : squaredCols\n        // Apply maxHeight and width styles to content\n        const style = { display: 'grid', gridTemplateColumns: `repeat(${cols}, ${this.gridWidth}px)` }\n        await this.#assignCSS(actionsElement, style)\n    }\n\n    /**\n     * Resize the actions element\n     * @private\n     * @param {object} actionsElement The actions element\n     */\n    async #resize (actionsElement) {\n        if (!actionsElement) return\n\n        let width = 500\n        if (this.isCustomWidth) {\n            width = this.availableWidth\n        } else {\n            const actions = actionsElement.querySelectorAll('.tah-action')\n            if (!actions.length) return\n            const sqrtActions = Math.ceil(Math.sqrt(actions.length)) // 4\n\n            // Initialize variables\n            let currentRow = 1\n            let maxRowWidth = 0\n            let rowWidth = 0\n            // Iterate through action groups, calculating dimensions and counts\n            if (actions.length > 0) {\n                actions.forEach((action, index) => {\n                    if ((index + 1) / sqrtActions > currentRow) {\n                        rowWidth = rowWidth - 5\n                        maxRowWidth = (rowWidth > maxRowWidth) ? rowWidth : maxRowWidth\n                        rowWidth = 0\n                        currentRow++\n                    }\n                    const actionRect = action.getBoundingClientRect()\n                    // const actionLeft = (index === 0) ? actionRect.left - this.groupsElementRect.left : 0\n                    const actionWidth = Math.ceil(parseFloat(actionRect.width) + 1 || 0)\n                    rowWidth += actionWidth\n                    // + actionLeft + 5\n                    if (index + 1 === actions.length) {\n                        rowWidth = rowWidth - 5\n                        maxRowWidth = (rowWidth > maxRowWidth) ? rowWidth : maxRowWidth\n                    }\n                })\n            }\n\n            // Add padding to maxAvgGroupWidth and maxGroupWidth\n            maxRowWidth += this.groupsElementPadding\n\n            // Determine width of content\n            width = (maxRowWidth < this.availableWidth && actions.length > 3) ? maxRowWidth : this.availableWidth\n            if (width < 200) width = 200\n        }\n\n        const style = { maxWidth: `${width}px` }\n        await this.#assignCSS(actionsElement, style)\n    }\n\n    /**\n     * Get available content width\n     * @private\n     */\n    #getAvailableWidth () {\n        const customWidth = this.settings?.customWidth\n\n        if (customWidth) {\n            this.isCustomWidth = true\n            return customWidth\n        }\n\n        const windowWidth = canvas.screenDimensions[0]\n        const contentLeft = this.groupsElementRect.left\n        const uiRight = document.querySelector('#ui-right')\n        const uiRightClientWidth = uiRight.clientWidth\n        return Math.floor((\n            uiRightClientWidth > 0\n                ? windowWidth - uiRightClientWidth\n                : windowWidth\n        ) - this.spacing - contentLeft)\n    }\n\n    /**\n     * Get available content height\n     * @private\n     */\n    #getAvailableHeight () {\n        const windowHeight = canvas.screenDimensions[1]\n        const contentBottom = this.groupsElementRect.bottom\n        const contentTop = this.groupsElementRect.top\n        const uiTopBottom = (this.direction === 'down')\n            ? document.querySelector('#ui-bottom')\n            : document.querySelector('#ui-top')\n        const uiTopBottomOffsetHeight = uiTopBottom.offsetHeight\n        const availableHeight = (this.direction === 'down')\n            ? windowHeight - contentTop - uiTopBottomOffsetHeight - this.spacing\n            : contentBottom - uiTopBottomOffsetHeight - this.spacing\n        return Math.floor(availableHeight < 100 ? 100 : availableHeight)\n    }\n\n    /**\n     * Get content\n     * @private\n     */\n    async #getGroupsElement () {\n        this.groupsElement = this.groupElement.querySelector('.tah-groups')\n        if (!this.groupsElement) return\n        this.groupsElementRect = this.groupsElement.getBoundingClientRect()\n        this.groupsElementComputed = getComputedStyle(this.groupsElement)\n        this.groupsElementPadding =\n            Math.ceil(parseFloat(this.groupsElementComputed.paddingLeft) || 0) +\n            Math.ceil(parseFloat(this.groupsElementComputed.paddingRight) || 0)\n    }\n\n    /**\n     * Get groups\n     * @private\n     */\n    #getGroupElements () {\n        this.groupElements = this.groupElement.querySelectorAll('.tah-group')\n        if (this.groupElements.length === 0) this.groupElements = [this.groupElement]\n    }\n\n    /**\n     * Set the content height\n     * @private\n     */\n    async #setHeight () {\n        requestAnimationFrame(() => {\n            this.availableHeight = this.#getAvailableHeight()\n            const style = { maxHeight: `${this.availableHeight}px`, overflowY: 'auto' }\n            Object.assign(this.groupsElement.style, style)\n        })\n    }\n\n    /**\n     * Assign CSS\n     * @private\n     * @param {object} element The DOM element\n     * @param {object} style   The style\n     */\n    async #assignCSS (element, style) {\n        if (!element) return\n        requestAnimationFrame(() => {\n            Object.assign(element.style, style)\n        })\n    }\n\n    /**\n     * Reset CSS\n     * @private\n     * @param {array} elements The DOM elements\n     * @param {object} style   The style\n     */\n    async #resetCSS (elements, style) {\n        for (const element of elements) {\n            Object.assign(element.style, style)\n        }\n    }\n}\n","import { TagDialogHelper } from './dialogs/tag-dialog-helper.js'\nimport { GroupResizer } from './group-resizer.js'\nimport { DataHandler } from './data-handler.js'\nimport { CSS_STYLE, MODULE, SETTING, TEMPLATE } from './constants.js'\nimport { Logger, Timer, Utils } from './utils.js'\n\n/**\n * Token Action HUD application\n */\nexport class TokenActionHud extends Application {\n    // Set defaults\n    hoveredGroups = []\n    defaults = {}\n    defaultHeight = 200\n    defaultWidth = 20\n    defaultLeftPos = 150\n    defaultTopPos = 80\n    leftPos = this.defaultLeftPos\n    topPos = this.defaultTopPos\n    defaultScale = 1\n    refreshTimeout = null\n    rendering = false\n    tokens = null\n    isUpdatePending = false\n    isUpdating = false\n    updatePendingTimer = new Timer(10)\n    updateTimer = new Timer(10)\n\n    constructor (module, systemManager) {\n        super()\n        this.module = MODULE\n        this.systemManager = systemManager\n        this.autoDirection = 'down'\n        this.directionSetting = 'down'\n        this.alwaysShowSetting = false\n        this.clickOpenCategorySetting = false\n        this.isCollapsed = false\n        this.enableCustomizationSetting = false\n        this.dragSetting = 'whenUnlocked'\n        this.enableSetting = false\n        this.isHudEnabled = false\n        this.gridSetting = false\n        this.isUnlocked = false\n        this.styleSetting = null\n    }\n\n    /**\n     * Initialise the HUD\n     * @public\n     */\n    async init () {\n        this.activeCssAsTextSetting = Utils.getSetting('activeCssAsTextSetting')\n        this.allowSetting = Utils.getSetting('allow')\n        this.alwaysShowSetting = Utils.getSetting('alwaysShowHud')\n        this.clickOpenCategorySetting = Utils.getSetting('clickOpenCategory')\n        this.directionSetting = Utils.getSetting('direction')\n        this.debugSetting = Utils.getSetting('debug')\n        this.displayIconsSetting = Utils.getSetting('displayIcons')\n        this.dragSetting = Utils.getSetting('drag')\n        this.enableCustomizationSetting = Utils.getSetting('enableCustomization')\n        this.enableSetting = Utils.getSetting('enable')\n        this.gridSetting = Utils.getSetting('grid')\n        this.scaleSetting = Utils.getSetting('scale')\n        this.styleSetting = Utils.getSetting('style')\n\n        this.isCollapsed = Utils.getUserFlag('isCollapsed')\n        this.isHudEnabled = this.#getHudEnabled()\n        this.hudPosition = Utils.getUserFlag('position')\n        this.isUnlocked = Utils.getUserFlag('isUnlocked')\n\n        await this.systemManager.registerDefaults()\n\n        this.dataHandler = new DataHandler()\n        await this.dataHandler.init()\n\n        this.actionHandler = await this.systemManager.getActionHandler()\n        this.actionHandler.customLayoutSetting = Utils.getSetting('customLayout')\n        this.actionHandler.userCustomLayoutSetting = Utils.getSetting('userCustomLayout')\n        this.actionHandler.enableCustomizationSetting = this.enableCustomizationSetting\n        this.actionHandler.displayCharacterNameSetting = Utils.getSetting('displayCharacterName')\n        this.actionHandler.sortActionsSetting = Utils.getSetting('sortActions')\n        this.actionHandler.tooltipsSetting = Utils.getSetting('tooltips')\n\n        this.GroupResizer = new GroupResizer()\n        this.rollHandler = this.systemManager.getRollHandler()\n    }\n\n    /**\n     * Update Token Action HUD following change to module settings\n     * @public\n     */\n    async updateSettings (key, value = null) {\n        if (!this.updateSettingsPending) {\n            this.updateSettingsPending = true\n            Logger.debug('Updating settings...')\n        }\n\n        const setting = SETTING[key]\n        const variable = setting?.variable\n        if (variable) {\n            if (setting.classes.includes('TokenActionHud')) this[variable] = value\n            if (setting.classes.includes('ActionHandler')) this.actionHandler[variable] = value\n        }\n\n        switch (key) {\n        case 'allow':\n        case 'enable':\n            this.isHudEnabled = this.#getHudEnabled()\n            break\n        case 'customLayout':\n        case 'userCustomLayout':\n            this.actionHandler.customLayout = null\n            break\n        case 'rollHandler':\n            this.updateRollHandler()\n            break\n        }\n    }\n\n    /**\n     * Update the RollHandler\n     * @public\n     */\n    updateRollHandler () {\n        this.rollHandler = this.systemManager.getRollHandler()\n    }\n\n    /**\n     * Merge Token Action Hud's default options with Application\n     * @override\n     */\n    static get defaultOptions () {\n        return mergeObject(super.defaultOptions, {\n            template: TEMPLATE.hud,\n            id: 'token-action-hud',\n            classes: [],\n            width: this.defaultWidth,\n            height: this.defaultHeight,\n            left: this.defaultLeftPos,\n            top: this.defaultTopPos,\n            scale: this.defaultScale,\n            background: 'none',\n            popOut: false,\n            minimizable: false,\n            resizable: false,\n            title: 'token-action-hud',\n            dragDrop: [],\n            tabs: [],\n            scrollY: [],\n            zIndex: 100\n        })\n    }\n\n    /**\n     * Whether the HUD can be dragged\n     * @returns {boolean} Whether the HUD can be dragged\n     */\n    #isDraggable () {\n        return ((this.dragSetting === 'always') || (this.dragSetting === 'whenUnlocked' && this.isUnlocked))\n    }\n\n    /**\n     * Get Token Action Hud scale\n     * @private\n     * @returns {number} The scale\n     */\n    #getScale () {\n        const scale = parseFloat(this.scaleSetting)\n        if (scale < 0.5) return 0.5\n        if (scale > 2) return 2\n        return scale\n    }\n\n    /**\n     * Get data\n     * @override\n     */\n    getData (options = {}) {\n        const data = super.getData()\n        data.hud = this.hud\n        data.id = 'token-action-hud'\n        data.style = CSS_STYLE[this.styleSetting].class\n        data.scale = this.#getScale()\n        data.background = '#00000000'\n        Logger.debug('Application data', { data })\n\n        return data\n    }\n\n    /**\n     * Activate listeners\n     * @override\n     */\n    activateListeners (html) {\n        const elements = {\n            action: html.find('.tah-action'),\n            buttons: html.find('#tah-buttons'),\n            tabGroup: html.find('.tah-tab-group'),\n            groups: html.find('#tah-groups'),\n            editHudButton: html.find('#tah-edit-hud'),\n            listGroups: html.find('.tah-list-groups'),\n            group: html.find('.tah-group'),\n            subtitle: html.find('.tah-subtitle'),\n            groupButton: html.find('.tah-group-button'),\n            collapseHudButton: html.find('#tah-collapse-hud'),\n            expandHudButton: html.find('#tah-expand-hud'),\n            unlockButton: html.find('#tah-unlock'),\n            lockButton: html.find('#tah-lock')\n        }\n\n        // Bind event listeners\n        this.#bindGroupEvents(elements)\n        this.#bindActionEvents(elements)\n        this.#bindEditHudButton(elements)\n        this.#bindLockUnlockButtons(elements)\n        this.#bindCollapseExpandButtons(elements)\n    }\n\n    /**\n     * Post-render HUD\n     */\n    postRender () {\n        this.#applySettings()\n\n        // Resize category\n        if (this.hoveredGroups.length) {\n            for (const groupId of this.hoveredGroups) {\n                const group = document.querySelector(`#${groupId}`)\n                this.GroupResizer.resizeGroup(this.actionHandler, group, this.autoDirection, this.gridSetting)\n            }\n        }\n    }\n\n    /**\n    * Bind category events\n    * @private\n    */\n    #bindGroupEvents (elements) {\n        /**\n         * Close the group\n         * @param {object} event The event\n         */\n        const closeGroup = (event) => {\n            if (game.tokenActionHud.rendering) return\n            const group = (this.clickOpenCategorySetting) ? event.currentTarget.parentElement : event.currentTarget\n            group.classList.remove('hover')\n            const closestGroupElement = group.closest('.tah-group')\n            let sibling = closestGroupElement?.nextElementSibling\n            while (sibling) {\n                if (sibling.classList.contains('tah-group')) {\n                    sibling.classList.remove('tah-hidden')\n                }\n                sibling = sibling.nextElementSibling\n            }\n            this.#clearHoveredGroup(group.id)\n        }\n\n        /**\n         * Open the group\n         * @param {object} event The event\n         */\n        const openGroup = async (event) => {\n            const group = (this.clickOpenCategorySetting) ? event.currentTarget.parentElement : event.currentTarget\n            group.classList.add('hover')\n            const closestGroupElement = group.closest('.tah-group')\n            let sibling = closestGroupElement?.nextElementSibling\n            while (sibling) {\n                if (sibling.classList.contains('tah-group')) {\n                    sibling.classList.add('tah-hidden')\n                }\n                sibling = sibling.nextElementSibling\n            }\n            this.GroupResizer.resizeGroup(this.actionHandler, group, this.autoDirection, this.gridSetting)\n            this.#setHoveredGroup(group.id)\n        }\n\n        /**\n         * Toggle the group\n         * @param {object} event The event\n         */\n        const toggleGroup = (event) => {\n            const group = event.currentTarget.parentElement\n            if (group.classList.contains('hover')) {\n                closeGroup(event)\n            } else {\n                const groupElements = group.parentElement.querySelectorAll('.tah-tab-group')\n                for (const groupElement of groupElements) {\n                    groupElement.classList.remove('hover')\n                    this.#clearHoveredGroup(groupElement.id)\n                }\n                openGroup(event)\n            }\n            // Remove focus to allow core ESC interactions\n            event.currentTarget.blur()\n        }\n\n        // Bring HUD to top\n        elements.groupButton.on('click', (event) => {\n            this.bringToTop()\n            // Remove focus to allow core ESC interactions\n            event.currentTarget.blur()\n        })\n\n        if (this.clickOpenCategorySetting) {\n            // When a category button is clicked...\n            elements.groupButton.on('click', toggleGroup)\n        } else {\n            // When a category button is hovered over...\n            elements.tabGroup.get().forEach(element => {\n                element.addEventListener('touchstart', toggleGroup, { passive: true })\n            })\n            elements.tabGroup.hover(openGroup, closeGroup)\n        }\n\n        // When a category button is clicked and held...\n        elements.groupButton.on('mousedown', (event) => this.#dragEvent(event))\n        elements.groupButton.get().forEach(element => {\n            element.addEventListener('touchstart', (event) => this.#dragEvent(event), { passive: true })\n        })\n\n        /**\n         * Open the group dialog\n         * @param {object} event\n         */\n        const openGroupDialog = (event) => {\n            const target = event.currentTarget\n            if (!target?.parentElement?.dataset?.nestId) return\n\n            const nestId = target?.parentElement?.dataset?.nestId\n            const name = target?.parentElement?.dataset?.name ?? target.innerText ?? target.outerText\n            const level = parseInt(target?.parentElement?.dataset?.level) || null\n            const type = target?.parentElement?.dataset?.type\n\n            TagDialogHelper.showGroupDialog(\n                this.actionHandler,\n                { nestId, name, level, type }\n            )\n        }\n\n        // When a category button is right-clicked...\n        elements.groupButton.on('contextmenu', (event) => {\n            if (this.isUnlocked && event.currentTarget.parentElement.dataset.level === '1') {\n                openGroupDialog(event)\n            }\n        })\n    }\n\n    /**\n     * Bind action events\n     * @private\n     * @param {object} elements The DOM elements\n     */\n    #bindActionEvents (elements) {\n        /**\n         * Handle action event\n         * @param {object} event The event\n         */\n        const handleAction = (event) => {\n            let target = event.target\n\n            if (target.tagName !== 'BUTTON') target = event.currentTarget.children[0]\n            const value = target.value\n            try {\n                this.rollHandler.handleActionEvent(event, value, this.actionHandler)\n                target.blur()\n            } catch (error) {\n                Logger.error(event)\n            }\n        }\n\n        /**\n         * Open the Action dialog\n         * @param {object} event The event\n         */\n        const openActionDialog = (event) => {\n            const target = (event.target.classList.contains('tah-button-text')) || (event.target.classList.contains('tah-button-image')) || (event.target.classList.contains('tah-group-button'))\n                ? event.target.closest('.tah-tab-group')\n                : event.target.closest('.tah-group')\n            if (!target?.dataset?.nestId) return\n            const nestId = target?.dataset?.nestId\n            const name = event.target.innerText ?? event.target.outerText\n            const level = parseInt(target?.dataset?.level) || null\n            const type = target?.dataset?.type\n\n            TagDialogHelper.showActionDialog(\n                this.actionHandler,\n                { nestId, name, level, type }\n            )\n        }\n\n        /**\n         * Collapse/expand group\n         * @param {object} event                   The event\n         * @param {boolean} enableCustomizationSetting Whether customization is enabled\n         */\n        const collapseExpandGroup = (event, enableCustomizationSetting) => {\n            const target = event.target.classList.contains('tah-subtitle-text')\n                ? event.target.parentElement\n                : event.target\n            const groupElement = target?.closest('.tah-group')\n            const nestId = groupElement?.dataset?.nestId\n            const tabGroup = target.closest('.tah-tab-group.hover')\n            const groupsElement = groupElement?.querySelector('.tah-groups')\n            const collapseIcon = target.querySelector('.tah-collapse-icon')\n            const expandIcon = target.querySelector('.tah-expand-icon')\n            const imageElement = groupElement.querySelector('.tah-list-image')\n\n            const toggleGroupVisibility = () => {\n                groupsElement?.classList.toggle('tah-hidden')\n                collapseIcon?.classList.toggle('tah-hidden')\n                expandIcon?.classList.toggle('tah-hidden')\n                imageElement?.classList.toggle('tah-hidden')\n            }\n\n            const saveGroupSettings = (collapse) => {\n                if (enableCustomizationSetting) {\n                    this.actionHandler.saveGroupSettings({ nestId, settings: { collapse } })\n                }\n            }\n\n            if (groupsElement?.classList.contains('tah-hidden')) {\n                toggleGroupVisibility()\n                saveGroupSettings(false)\n                this.GroupResizer.resizeGroup(this.actionHandler, tabGroup, this.autoDirection, this.gridSetting)\n            } else {\n                toggleGroupVisibility()\n                saveGroupSettings(true)\n            }\n        }\n\n        // When a subcategory title is right-clicked...\n        elements.subtitle.on('contextmenu', (event) => {\n            if (this.isUnlocked) openActionDialog(event)\n        })\n\n        // When a subcategory title is clicked...\n        elements.subtitle.on('click', (event) => {\n            if (event.target.classList.contains('tah-button-text')) return\n            collapseExpandGroup(event, this.enableCustomizationSetting)\n        })\n\n        // When an action is clicked or right-clicked...\n        elements.action.on('click contextmenu', (event) => {\n            event.preventDefault()\n            handleAction(event)\n        })\n\n        elements.groupButton.on('contextmenu', (event) => {\n            if (this.isUnlocked && event.currentTarget.parentElement.dataset.level !== '1') {\n                openActionDialog(event)\n            }\n        })\n    }\n\n    /**\n     * Bind 'Edit HUD' button\n     * @private\n     */\n    #bindEditHudButton (elements) {\n        // When the 'Edit HUD' button is clicked...\n        elements.editHudButton.on('click', (event) => {\n            event.preventDefault()\n            event = event || window.event\n            TagDialogHelper.showHudDialog(this.actionHandler)\n        })\n    }\n\n    /**\n     * Bind lock and unlock buttons\n     * @private\n     */\n    #bindLockUnlockButtons (elements) {\n        /**\n         * Unlock the HUD\n         * @param {object} event\n         */\n        const unlockHud = async (event) => {\n            if (event) {\n                event.preventDefault()\n            }\n\n            const target = event?.target || elements.unlockButton\n            $(target).addClass('tah-hidden')\n            elements.editHudButton.removeClass('tah-hidden')\n            elements.group.removeClass('tah-hidden')\n            elements.groupButton.removeClass('disable-edit')\n            elements.groups.addClass('tah-unlocked')\n            elements.listGroups.removeClass('tah-hidden')\n            elements.lockButton.removeClass('tah-hidden')\n            elements.tabGroup.removeClass('tah-hidden')\n            elements.subtitle.removeClass('disable-edit tah-hidden')\n\n            if (!this.isUnlocked) {\n                await Utils.setUserFlag('isUnlocked', true)\n                this.isUnlocked = true\n            }\n        }\n\n        /**\n         * Lock the HUD\n         * @param {object} event\n         */\n        const lockHud = async (event = null) => {\n            if (event) {\n                event.preventDefault()\n            }\n            const target = event?.target || elements.lockButton\n            $(target).addClass('tah-hidden')\n            elements.unlockButton.removeClass('tah-hidden')\n            elements.editHudButton.addClass('tah-hidden')\n            elements.groups.removeClass('tah-unlocked')\n            for (const topGroupElement of elements.tabGroup) {\n                const hasActions = (topGroupElement.getElementsByClassName('tah-action').length > 0)\n                if (!hasActions) topGroupElement.classList.add('tah-hidden')\n            }\n            for (const groupElement of elements.group) {\n                const hasActions = (groupElement.getElementsByClassName('tah-action').length > 0)\n                if (!hasActions) groupElement.classList.add('tah-hidden')\n            }\n            for (const listGroupsElement of elements.listGroups) {\n                const hasActions = (listGroupsElement.getElementsByClassName('tah-action').length > 0)\n                if (!hasActions) listGroupsElement.classList.add('tah-hidden')\n            }\n            for (const subtitleElement of elements.subtitle) {\n                const groupElement = subtitleElement.closest('.tah-group')\n                if (groupElement?.dataset?.showTitle === 'false') {\n                    subtitleElement.classList.add('tah-hidden')\n                }\n            }\n            elements.groupButton.addClass('disable-edit')\n            elements.subtitle.addClass('disable-edit')\n            if (this.isUnlocked) {\n                await Utils.setUserFlag('isUnlocked', false)\n                this.isUnlocked = false\n            }\n        }\n\n        // Set initial lock state\n        if (this.isUnlocked && this.enableCustomizationSetting) {\n            unlockHud()\n        } else {\n            lockHud()\n        }\n\n        if (!this.enableCustomizationSetting) {\n            elements.unlockButton.addClass('tah-hidden')\n        }\n\n        // Add event listeners\n        elements.unlockButton.on('click', unlockHud)\n        elements.lockButton.on('click', lockHud)\n    }\n\n    /**\n     * Bind collapse and expand buttons\n     * @private\n     */\n    #bindCollapseExpandButtons (elements) {\n        /**\n         * Collapse the HUD\n         * @param {object} event The event\n         */\n        const collapseHud = (event = null) => {\n            if (event) {\n                event.preventDefault()\n                event = event || window.event\n            }\n            const target = event?.target || elements.collapseHudButton\n            $(target).addClass('tah-hidden')\n            elements.expandHudButton.removeClass('tah-hidden')\n            elements.groups.addClass('tah-hidden')\n            elements.buttons.addClass('tah-hidden')\n            if (!this.isCollapsed) {\n                Utils.setUserFlag('isCollapsed', true)\n                this.isCollapsed = true\n            }\n        }\n\n        /**\n         * Expand the HUD\n         * @param {object} event The event\n         */\n        const expandHud = (event) => {\n            event.preventDefault()\n            event = event || window.event\n            $(event.target).addClass('tah-hidden')\n            elements.collapseHudButton.removeClass('tah-hidden')\n            elements.groups.removeClass('tah-hidden')\n            elements.buttons.removeClass('tah-hidden')\n            if (this.isCollapsed) {\n                Utils.setUserFlag('isCollapsed', false)\n                this.isCollapsed = false\n            }\n        }\n\n        // Set initial state\n        if (this.isCollapsed) { collapseHud() }\n\n        // Add event listeners\n        // When the 'Collapse HUD' button is clicked...\n        elements.collapseHudButton.on('click', collapseHud)\n\n        // When the 'Expand HUD' Button is clicked...\n        elements.expandHudButton.on('click', expandHud)\n\n        // When the 'Expand HUD' button is clicked and held...\n        elements.expandHudButton.on('mousedown', (event) => this.#dragEvent(event))\n        elements.expandHudButton.get(0).addEventListener('touchstart', (event) => this.#dragEvent(event), { passive: true })\n    }\n\n    /**\n     * Drag event handler\n     * @private\n     * @param {object} event The event\n     */\n    #dragEvent (event) {\n        if (!this.#isDraggable()) return\n\n        // Get the main element\n        const element = document.getElementById('token-action-hud')\n\n        const clientX = event.clientX ?? event.changedTouches[0].clientX\n        const clientY = event.clientY ?? event.changedTouches[0].clientY\n\n        // Initialise positions and starting positions\n        let pos1 = 0\n        let pos2 = 0\n        let pos3 = clientX\n        let pos4 = clientY\n        const originalElementTop = element.offsetTop\n        const originalElementLeft = element.offsetLeft\n        let newElementTop = originalElementTop\n        let newElementLeft = originalElementLeft\n\n        /**\n         * Mouse movement event handler\n         * @param {object} event The event\n         */\n        const mouseMoveEvent = (event) => {\n            const clientX = event.clientX ?? event.changedTouches[0].clientX\n            const clientY = event.clientY ?? event.changedTouches[0].clientY\n            pos1 = pos3 - clientX\n            pos2 = pos4 - clientY\n            pos3 = clientX\n            pos4 = clientY\n\n            // If the mouse has not moved, do not update\n            if (pos1 === pos3 && pos2 === pos4) return\n\n            newElementTop = newElementTop - pos2\n            newElementLeft = newElementLeft - pos1\n\n            this.topPos = newElementTop\n\n            // Apply styles\n            requestAnimationFrame(() => {\n                Object.assign(element.style, { left: `${newElementLeft}px`, position: 'fixed', top: `${newElementTop}px` })\n            })\n        }\n\n        /**\n         * Mouse up event handler\n         */\n        const mouseUpEvent = () => {\n            // Remove the mouse move and touch move events\n            document.onmousemove = null\n            element.ontouchmove = null\n\n            // Remove the mouse up and touch end events\n            document.onmouseup = null\n            element.ontouchend = null\n\n            // If position has not changed, do not update\n            if (newElementTop === originalElementTop && newElementLeft === originalElementLeft) return\n\n            this.topPos = newElementTop\n\n            this.#applySettings()\n\n            // Save the new position to the user's flags\n            this.hudPosition = { top: newElementTop, left: newElementLeft }\n            Utils.setUserFlag('position', this.hudPosition)\n\n            Logger.debug(`Set position to x: ${newElementTop}px, y: ${newElementLeft}px`)\n        }\n\n        // Bind mouse move and touch move events\n        document.onmousemove = mouseMoveEvent\n        element.ontouchmove = mouseMoveEvent\n\n        // Bind mouse up and touch end events\n        document.onmouseup = mouseUpEvent\n        element.ontouchend = mouseUpEvent\n    }\n\n    /**\n     * Get the automatic direction the HUD expands\n     * @private\n     * @returns {string} The direction\n     */\n    #getAutoDirection () {\n        if (this.directionSetting === 'up' || (this.directionSetting === 'auto' && this.topPos > window.innerHeight / 2)) return 'up'\n        return 'down'\n    }\n\n    /**\n     * Apply settings\n     * @private\n     */\n    #applySettings () {\n        this.autoDirection = this.#getAutoDirection()\n        if (this.autoDirection === 'up') {\n            $(document).find('.tah-groups-container').removeClass('expand-down')\n            $(document).find('.tah-groups-container').addClass('expand-up')\n            $(document).find('.tah-groups-container').removeClass('expand-down')\n            $(document).find('.tah-groups-container').addClass('expand-up')\n            $(document).find('#tah-character-name').addClass('tah-hidden')\n        } else {\n            $(document).find('.tah-groups-container').addClass('expand-down')\n            $(document).find('.tah-groups-container').removeClass('expand-up')\n            $(document).find('.tah-groups-container').addClass('expand-down')\n            $(document).find('.tah-groups-container').removeClass('expand-up')\n            $(document).find('#tah-character-name').removeClass('tah-hidden')\n        }\n    }\n\n    /**\n     * Set position of the HUD\n     * @public\n     */\n    setPosition () {\n        if (!this.hud) return\n        this.#setPositionFromFlag()\n        this.#restoreHoveredGroups()\n        this.rendering = false\n    }\n\n    /**\n     * Set the position of the HUD based on user flag\n     * @private\n     */\n    #setPositionFromFlag () {\n        if (!this.hudPosition) return\n\n        const defaultLeftPos = this.defaultLeftPos\n        const defaultTopPos = this.defaultTopPos\n\n        return new Promise((resolve) => {\n            const check = () => {\n                const element = document.getElementById('token-action-hud')\n                if (element) {\n                    element.style.bottom = null\n                    this.topPos = this.hudPosition.top < 5 || this.hudPosition.top > window.innerHeight + 5\n                        ? defaultTopPos\n                        : this.hudPosition.top\n                    element.style.top = `${this.topPos}px`\n                    this.leftPos = this.hudPosition.left < 5 || this.hudPosition.left > window.innerWidth + 5\n                        ? defaultLeftPos\n                        : this.hudPosition.left\n                    element.style.left = `${this.leftPos}px`\n                    element.style.position = 'fixed'\n                    resolve()\n                } else {\n                    setTimeout(check, 10)\n                }\n            }\n\n            check()\n        })\n    }\n\n    /**\n     * Reset the position of the HUD\n     * @public\n     */\n    async resetPosition () {\n        Logger.debug('Resetting position...')\n        this.hudPosition = { top: this.defaultTopPos, left: this.defaultLeftPos }\n        await Utils.setUserFlag('position', this.hudPosition)\n        Logger.debug(`Position reset to x: ${this.defaultTopPos}px, y: ${this.defaultLeftPos}px`)\n    }\n\n    /**\n     * Set hovered group\n     * @private\n     * @param {string} groupId The group id\n     */\n    #setHoveredGroup (groupId) {\n        if (this.hoveredGroups.length > 10) { this.hoveredGroups = [] }\n        this.hoveredGroups.push(groupId)\n    }\n\n    /**\n     * Clear hovered group\n     * @private\n     * @param {string} groupId The group id\n     */\n    #clearHoveredGroup (groupId) {\n        this.hoveredGroups = this.hoveredGroups.filter(id => id !== groupId)\n    }\n\n    /**\n     * Restore the hovered category state on the HUD\n     * @private\n     */\n    #restoreHoveredGroups () {\n        if (!this.hoveredGroups.length) return\n\n        for (const groupId of this.hoveredGroups) {\n            const groupElement = $(`#${groupId}`)\n\n            if (!groupElement[0]) continue\n\n            if (this.clickOpenCategorySetting) {\n                const button = groupElement.find('.tah-group-button')[0]\n                button.click()\n            } else {\n                groupElement.mouseenter()\n            }\n        }\n    }\n\n    /**\n     * Toggle HUD\n     * @public\n     */\n    async toggleHud () {\n        const binding = Utils.humanizeBinding('toggleHud')\n        if (this.enableSetting) {\n            this.#close()\n            this.enableSetting = false\n            await Utils.setSetting('enable', false)\n            Logger.info(game.i18n.format('tokenActionHud.keybinding.toggleHud.disabled', { binding }), true)\n        } else {\n            this.enableSetting = true\n            await Utils.setSetting('enable', true)\n            Logger.info(game.i18n.format('tokenActionHud.keybinding.toggleHud.enabled', { binding }), true)\n            Hooks.callAll('forceUpdateTokenActionHud')\n        }\n    }\n\n    /**\n     * Copy user's 'groups' flag to others users\n     * @public\n     * @param {string} fromUserId      The user id to copy from\n     * @param {string|array} toUserIds The user ids to copy to\n     */\n    async copy (fromUserId, toUserIds) {\n        if (!game.user.isGM) return\n\n        const isCopied = await this.#copyUserData(fromUserId, toUserIds)\n        if (isCopied) {\n            Logger.info('HUD copied', true)\n        } else {\n            Logger.info('Copy HUD failed', true)\n        }\n    }\n\n    /**\n     * Copy user's 'groups' flag to others users\n     * @private\n     * @param {string} fromUserId      The user id to copy from\n     * @param {string|array} toUserIds The user ids to copy to\n     */\n    async #copyUserData (fromUserId, toUserIds) {\n        // Exit if parameters are missing\n        if (!fromUserId || !toUserIds.length) return false\n\n        Logger.debug('Copying user data...')\n\n        const fromGroup = await DataHandler.getDataAsGm({ type: 'user', id: fromUserId })\n\n        if (typeof toUserIds === 'string') {\n            await DataHandler.saveDataAsGm('user', toUserIds, fromGroup)\n        } else if (Array.isArray(toUserIds)) {\n            for (const userId of toUserIds) {\n                await DataHandler.saveDataAsGm('user', userId, fromGroup)\n            }\n        }\n\n        Logger.debug('User data copied')\n        return true\n    }\n\n    /**\n     * Reset the HUD\n     * @public\n     */\n    async resetDialog () {\n        const d = new Dialog({\n            title: Utils.i18n('tokenActionHud.dialog.resetLayout.title'),\n            content: `<p>${Utils.i18n('tokenActionHud.dialog.resetLayout.content')}</p>`,\n            buttons: {\n                yes: {\n                    icon: '<i class=\"fas fa-check\"></i>',\n                    label: Utils.i18n('tokenActionHud.dialog.button.yes'),\n                    callback: async () => {\n                        const customLayoutElement = document.querySelector('#token-action-hud-core-settings input[name=customLayout]')\n                        if (customLayoutElement) {\n                            await this.updateSettings('customLayout', customLayoutElement?.value ?? '')\n                            await Utils.setSetting('customLayout', customLayoutElement?.value ?? '')\n                        }\n                        const userCustomLayoutElement = document.querySelector('#token-action-hud-core-settings input[name=userCustomLayout]')\n                        if (userCustomLayoutElement) {\n                            await this.updateSettings('userCustomLayout', userCustomLayoutElement?.value ?? '')\n                            await Utils.setSetting('userCustomLayout', customLayoutElement?.value ?? '')\n                        }\n                        await game.tokenActonHud.reset()\n                        Logger.info('Layout reset', true)\n                    }\n                },\n                no: {\n                    icon: '<i class=\"fas fa-times\"></i>',\n                    label: Utils.i18n('tokenActionHud.dialog.button.no')\n                }\n            }\n        })\n        d.render(true)\n    }\n\n    /**\n     * Reset the HUD\n     * @public\n     */\n    async resetAllDialog () {\n        const d = new Dialog({\n            title: Utils.i18n('tokenActionHud.dialog.resetAllLayouts.title'),\n            content: `<p>${Utils.i18n('tokenActionHud.dialog.resetAllLayouts.content')}</p>`,\n            buttons: {\n                yes: {\n                    icon: '<i class=\"fas fa-check\"></i>',\n                    label: Utils.i18n('tokenActionHud.dialog.button.yes'),\n                    callback: async () => {\n                        const customLayoutElement = document.querySelector('#token-action-hud-core-settings input[name=customLayout]')\n                        if (customLayoutElement) {\n                            await Utils.setSetting('customLayout', customLayoutElement?.value ?? '')\n                        }\n                        const userCustomLayoutElement = document.querySelector('#token-action-hud-core-settings input[name=userCustomLayout]')\n                        if (userCustomLayoutElement) {\n                            await Utils.setSetting('userCustomLayout', customLayoutElement?.value ?? '')\n                        }\n                        await game.tokenActionHud.socket.executeForEveryone('reset')\n                        Logger.info('All layouts reset', true)\n                    }\n                },\n                no: {\n                    icon: '<i class=\"fas fa-times\"></i>',\n                    label: Utils.i18n('tokenActionHud.dialog.button.no')\n                }\n            }\n        })\n        d.render(true)\n    }\n\n    static async reset () {\n        Logger.debug('Resetting layout...')\n        await game?.tokenActionHud?.resetUserAndActorData()\n        game?.tokenActionHud?.resetPosition()\n        Logger.debug('Layout reset')\n    }\n\n    /**\n     * Reset actor data\n     */\n    async resetActorData () {\n        Logger.debug('Resetting actor data...')\n\n        await DataHandler.saveDataAsGm('actor', this.actor.id, {})\n        this.actionHandler.hardResetActionHandler()\n\n        Logger.debug('Actor data reset')\n\n        const trigger = { trigger: { type: 'method', name: 'TokenActionHud#resetActorData' } }\n        this.update(trigger)\n    }\n\n    /**\n     * Reset all actor data\n     * @public\n     */\n    async resetAllActorData () {\n        Logger.debug('Resetting all actor data...')\n\n        for (const actor of game.actors) {\n            Logger.debug(`Resetting flags for actor [${actor.id}]`, { actor })\n            await DataHandler.saveDataAsGm('actor', actor.id, {})\n        }\n        this.actionHandler.hardResetActionHandler()\n\n        Logger.debug('All actor data reset')\n\n        const trigger = { trigger: { type: 'method', name: 'TokenActionHud#resetAllActorData' } }\n        this.update(trigger)\n    }\n\n    /**\n     * Reset user data\n     * @public\n     */\n    async resetUserData () {\n        Logger.debug('Resetting user data...')\n        await DataHandler.saveDataAsGm('user', game.userId, {})\n        Logger.debug('User data reset')\n        this.actionHandler.hardResetActionHandler()\n        const trigger = { trigger: { type: 'method', name: 'TokenActionHud#resetUserData' } }\n        this.update(trigger)\n    }\n\n    /**\n     * Reset all user data\n     * @public\n     */\n    async resetAllUserData () {\n        Logger.debug('Resetting all user data...')\n        for (const user of game.users) {\n            await DataHandler.saveDataAsGm('user', user.id, {})\n        }\n        Logger.debug('All user data reset')\n        this.actionHandler.hardResetActionHandler()\n        const trigger = { trigger: { type: 'method', name: 'TokenActionHud#resetAllUserData' } }\n        this.update(trigger)\n    }\n\n    /**\n     * Reset user and actor data\n     */\n    async resetUserAndActorData () {\n        Logger.debug('Resetting user data...')\n        await DataHandler.saveDataAsGm('user', game.userId, {})\n        Logger.debug('User data reset')\n\n        Logger.debug('Resetting actor data...')\n        await DataHandler.saveDataAsGm('actor', this.actor.id, {})\n        Logger.debug('Actor data reset')\n\n        this.actionHandler.hardResetActionHandler()\n\n        const trigger = { trigger: { type: 'method', name: 'TokenActionHud#resetUserAndActorData' } }\n        this.update(trigger)\n    }\n\n    /**\n     * Update the HUD\n     * @public\n     * @param {object} trigger The trigger for the update\n     */\n    async update (trigger = null) {\n        // Stops settings updates from triggering the HUD update multiple times\n        // Instead an update is triggered when settings are updated and the settings config window is closed\n        if (trigger?.name === 'closeSettingsConfig') {\n            if (!this.updateSettingsPending) return\n            this.updateSettingsPending = false\n            Logger.debug('Settings updated')\n        }\n\n        await this.#handleUpdate()\n\n        await this.#performUpdate(trigger)\n    }\n\n    /**\n     * Handles HUD updates to avoid overlapping updates\n     */\n    async #handleUpdate () {\n        // Start a timer and reset it each time an update call is received before the timer has elapsed\n        if (this.isUpdatePending) this.updatePendingTimer.abort()\n\n        this.isUpdatePending = true\n        await this.updatePendingTimer.start()\n        this.isUpdatePending = false\n\n        // Wait for the current update to complete before progressing a pending update\n        // Stop waiting if the current update takes longer than 5 seconds\n        const waitForUpdateCompletion = async () => {\n            const maxWaitTime = 5000\n            const interval = 10\n            const iterations = maxWaitTime / interval\n\n            let i = 0\n            while (i < iterations && this.isUpdating) {\n                await this.updateTimer.start()\n                i++\n            }\n\n            return !this.isUpdating\n        }\n\n        if (this.isUpdating) {\n            const hasCompleted = await waitForUpdateCompletion()\n            if (!hasCompleted) {\n                Logger.debug('Update took too long. Aborting...')\n            }\n        }\n    }\n\n    /**\n     * Perform the HUD update following handling\n     * @param {object} trigger The trigger for the update\n     */\n    async #performUpdate (trigger) {\n        this.isUpdating = true\n\n        Logger.debug('Updating HUD...', trigger)\n\n        const previousActorId = this.actor?.id\n        const controlledTokens = Utils.getControlledTokens()\n        const character = this.#getCharacter(controlledTokens)\n        const multipleTokens = controlledTokens.length > 1 && !character\n\n        if ((!character && !multipleTokens) || !this.isHudEnabled) {\n            this.#close()\n            this.hoveredGroups = []\n            Logger.debug('HUD update aborted as no character(s) found or HUD is disabled')\n            this.isUpdating = false\n            return\n        }\n\n        const options = (trigger === 'controlToken' && previousActorId !== this.actor?.id) ? { saveActor: true } : {}\n\n        this.hud = await this.actionHandler.buildHud(options)\n\n        if (this.hud.length === 0) {\n            this.#close()\n            this.hoveredGroups = []\n            Logger.debug('HUD update aborted as action list empty')\n            this.isUpdating = false\n            return\n        }\n\n        this.rendering = true\n        this.render(true)\n        if (!ui.windows[this.appId]) {\n            ui.windows[this.appId] = this\n        }\n\n        this.isUpdating = false\n\n        Hooks.callAll('tokenActionHudCoreHudUpdated', this.module)\n        Logger.debug('HUD updated')\n    }\n\n    /**\n     * Close application\n     * @private\n     */\n    #close () {\n        this.close()\n    }\n\n    /**\n     * Whether the token change is valid for a HUD update\n     * @public\n     * @param {object} token The token\n     * @param {object} data  The data\n     * @returns {boolean}    Whether the token change is valid for a HUD update\n     */\n    isValidTokenChange (token, data = null) {\n        if (data?.actorData?.flags) return false\n        if (this.alwaysShowSetting) {\n            return (this.#isRelevantToken(token) || token.actorId === game.user.character?.id)\n        } else {\n            return this.#isRelevantToken(token)\n        }\n    }\n\n    /**\n     * Whether the token is controlled or on the canvas\n     * @private\n     * @param {object} token The token\n     * @returns {boolean} Whether the token is controlled or on the canvas\n     */\n    #isRelevantToken (token) {\n        const controlledTokens = Utils.getControlledTokens()\n        return (\n            controlledTokens?.some((controlledToken) => controlledToken.id === token.id) ||\n            (\n                controlledTokens?.length === 0 &&\n                canvas?.tokens?.placeables?.some((token) => token.id === this.hud?.tokenId)\n            )\n        )\n    }\n\n    /**\n     * Whether the given actor is the selected actor\n     * @param {object} actor The actor\n     * @returns {boolean}    Whether the given actor is the selected actor\n     */\n    isSelectedActor (actor) {\n        if (!actor?.id) return true\n        if (actor?.id === this.actor?.id) return true\n        return false\n    }\n\n    /**\n     * Whether the actor or item update is valid for a HUD update\n     * @param {object} actor The actor\n     * @param {object} data  The data\n     * @returns {boolean}    Whether the actor or item update is valid for a HUD update\n     */\n    isValidActorOrItemUpdate (actor, data) {\n        if (!this.isSelectedActor(actor)) return false\n\n        if (actor) {\n            if (!actor) {\n                Logger.debug('No actor, update hud', { data })\n                return true\n            }\n\n            if (this.hud && actor.id === this.hud.actorId) {\n                Logger.debug('Same actor, update hud', { actor, data })\n                return true\n            }\n\n            Logger.debug('Different actor, do not update hud', { actor, data })\n            return false\n        }\n    }\n\n    /**\n     * Whether the character is a valid selection for the current user\n     * @private\n     * @param {object} [token = {}] The token\n     * @returns {boolean}           Whether the character is a valid selection for the current user\n     */\n    #isValidCharacter (token = {}) {\n        const actor = token?.actor\n        return game.user.isGM || actor?.testUserPermission(game.user, 'OWNER')\n    }\n\n    /**\n     * Whether the hud is enabled for the current user\n     * @private\n     * @returns {boolean} Whether the hud is enabled for the current user\n     */\n    #getHudEnabled () {\n        const userRole = game.user.role\n        const isGM = game.user.isGM\n        const isEnabled = this.enableSetting\n\n        if (!isEnabled) return false\n\n        if (isGM) return true\n\n        return Utils.checkAllow(userRole, this.allowSetting)\n    }\n\n    /**\n     * Get character from selected tokens\n     * @private\n     * @param {array} [controlled = []] The controlled tokens\n     */\n    #getCharacter (controlled = []) {\n        if (controlled.length > 1) {\n            this.actor = null\n            this.token = null\n            this.actionHandler.characterName = 'Multiple'\n            this.actionHandler.actor = null\n            this.actionHandler.token = null\n            this.rollHandler.actor = null\n            this.rollHandler.token = null\n            return null\n        }\n\n        const character = { token: null, actor: null }\n        if (controlled.length === 1) {\n            const token = controlled[0]\n            const actor = token.actor\n\n            if (!this.#isValidCharacter(token)) return null\n\n            character.token = token\n            character.actor = actor\n        } else if (controlled.length === 0 && game.user.character && this.alwaysShowSetting) {\n            character.actor = game.user.character\n            character.token = canvas.tokens.placeables.find(t => t.actor?.id === character.actor.id)\n        }\n\n        if (!character.actor) return null\n\n        this.actor = character.actor\n        this.token = character.token\n        this.actionHandler.characterName = character.token?.name ?? character.actor.name\n        this.actionHandler.actor = character.actor\n        this.actionHandler.token = character.token\n        this.rollHandler.actor = character.actor\n        this.rollHandler.token = character.token\n        return character\n    }\n}\n","import { ActionHandler } from './action-handlers/action-handler.js'\nimport { ActionListExtender } from './action-handlers/action-list-extender.js'\nimport { DataHandler } from './data-handler.js'\nimport { MigrationManager } from './migration-manager.js'\nimport { PreRollHandler } from './roll-handlers/pre-roll-handler.js'\nimport { RollHandler } from './roll-handlers/roll-handler.js'\nimport { SystemManager } from './system-manager.js'\nimport { TokenActionHud } from './token-action-hud.js'\nimport { MODULE, TEMPLATE } from './constants.js'\nimport { Logger, Timer, Utils } from './utils.js'\n\nlet systemManager\nlet module\nlet socket\n\nHooks.once('socketlib.ready', () => {\n    socket = socketlib.registerModule(MODULE.ID)\n    socket.register('getFilePaths', DataHandler.getFilePaths)\n    socket.register('getData', DataHandler.getData)\n    socket.register('saveData', DataHandler.saveData)\n    socket.register('reset', TokenActionHud.reset)\n})\n\nHooks.on('ready', async () => {\n    module = game.modules.get(MODULE.ID)\n    module.api = {\n        ActionListExtender,\n        ActionHandler,\n        DataHandler,\n        Logger,\n        PreRollHandler,\n        RollHandler,\n        SystemManager,\n        Timer,\n        Utils\n    }\n\n    Hooks.callAll('tokenActionHudCoreApiReady', module)\n})\n\nHooks.on('tokenActionHudSystemReady', async (systemModule) => {\n    // Exit if core module version is not compatible with the system module\n    const isCompatible = await Utils.checkModuleCompatibility(systemModule.api.requiredCoreModuleVersion)\n    if (!isCompatible) return\n\n    const socketlibModule = game.modules.get('socketlib')\n    if (!socketlibModule || !socketlibModule.active) {\n        Logger.error(\n            'This module requires the \\'socketlib\\' module to be installed and enabled.',\n            true\n        )\n        return\n    }\n\n    // Create new SystemManager and register core and system module settings\n    systemManager = new systemModule.api.SystemManager(MODULE.ID)\n    systemManager.registerSettings()\n\n    // Set stylesheet to 'style' core module setting\n    Utils.switchCSS(Utils.getSetting('style'))\n\n    // Register Handlebar helpers\n    Utils.registerHandlebars()\n\n    // Load templates\n    loadTemplates([\n        TEMPLATE.action,\n        TEMPLATE.customStyleForm,\n        TEMPLATE.group,\n        TEMPLATE.hud,\n        TEMPLATE.listGroup,\n        TEMPLATE.settings,\n        TEMPLATE.tabGroup,\n        TEMPLATE.tagDialogGroup,\n        TEMPLATE.tagDialogHud,\n        TEMPLATE.tagDialogTopLevelGroup\n    ])\n\n    Hooks.callAll('tokenActionHudCoreReady')\n})\n\nHooks.on('tokenActionHudCoreReady', async () => {\n    // If no supported color picker modules are active, for the first time only, display a notification\n    if (game.user.isGM && !(game.modules.get('color-picker')?.active ?? false)) {\n        const firstStartup = Utils.getSetting('startup') === false\n        if (firstStartup) {\n            Logger.info(\n                'To enable color pickers in this module\\'s settings, install the \\'Color Picker\\' module.',\n                true\n            )\n            Utils.setSetting('startup', true)\n        }\n    }\n\n    // Create directories for json data\n    const enableCustomizationSetting = Utils.getSetting('enableCustomization')\n    if (game.user.isGM && enableCustomizationSetting) {\n        await DataHandler.createDirectories()\n    }\n\n    // Initialise MigrationManager\n    const migrationManager = new MigrationManager(socket)\n    await migrationManager.init()\n\n    // If no Token Action Hud application exists, create a new TokenActionHud and initialise it\n    if (!game.tokenActionHud) {\n        game.tokenActionHud = new TokenActionHud(module, systemManager)\n        game.tokenActionHud.socket = socket\n        await game.tokenActionHud.init()\n    }\n\n    // Register hooks\n    Hooks.on('renderTokenActionHud', () => game.tokenActionHud.postRender())\n    Hooks.on('deleteActor', (actor, data) => handleHookEvent({ actor, data }, 'deleteActor'))\n    Hooks.on('updateActor', (actor, data) => handleHookEvent({ actor, data }, 'updateActor'))\n    Hooks.on('createActiveEffect', (activeEffect, options, userId) => handleHookEvent({ activeEffect, options, userId }, 'createActiveEffect'))\n    Hooks.on('deleteActiveEffect', (activeEffect, options, userId) => handleHookEvent({ activeEffect, options, userId }, 'deleteActiveEffect'))\n    Hooks.on('createCombat', (combat) => handleHookEvent({ combat }, 'createCombat'))\n    Hooks.on('deleteCombat', (combat) => handleHookEvent({ combat }, 'deleteCombat'))\n    Hooks.on('updateCombat', (combat) => handleHookEvent({ combat }, 'updateCombat'))\n    Hooks.on('updateCombatant', (combatant, data, options, userId) => handleHookEvent({ combatant, data, options, userId }, 'updateCombatant'))\n    Hooks.on('deleteCompendium', (source, html) => handleHookEvent({ source, html }, 'deleteCompendium'))\n    Hooks.on('renderCompendium', (source, html) => handleHookEvent({ source, html }, 'renderCompendium'))\n    Hooks.on('updateCompendium', (source, html) => handleHookEvent({ source, html }, 'updateCompendium'))\n    Hooks.on('createItem', (item) => handleHookEvent({ item }, 'createItem'))\n    Hooks.on('deleteItem', (item) => handleHookEvent({ item }, 'deleteItem'))\n    Hooks.on('updateItem', (item) => handleHookEvent({ item }, 'updateItem'))\n    Hooks.on('deleteMacro', () => handleHookEvent({}, 'deleteMacro'))\n    Hooks.on('updateMacro', () => handleHookEvent({}, 'updateMacro'))\n    Hooks.on('controlToken', (token, controlled) => handleHookEvent({ token, controlled }, 'controlToken'))\n    Hooks.on('deleteToken', (scene, token, change, userId) => handleHookEvent({ scene, token, change, userId }, 'deleteToken'))\n    Hooks.on('updateToken', (token, data, diff) => handleHookEvent({ token, data, diff }, 'updateToken'))\n    Hooks.on('closeSettingsConfig', () => handleHookEvent({}, 'closeSettingsConfig'))\n    Hooks.on('forceUpdateTokenActionHud', () => handleHookEvent({}, 'forceUpdateTokenActionHud'))\n\n    function handleHookEvent (hookData, hookName) {\n        const trigger = { type: 'hook', name: hookName, data: hookData }\n        switch (hookName) {\n        case 'deleteActor':\n        case 'updateActor':\n            if (!game.tokenActionHud.isValidActorOrItemUpdate(hookData.actor, hookData.data)) return\n            break\n        case 'createActiveEffect':\n        case 'deleteActiveEffect':\n            if (!game.tokenActionHud.isSelectedActor(hookData.activeEffect.parent)) return\n            break\n        case 'updateCombatant':\n            if (!game.tokenActionHud.isSelectedActor(hookData.combatant.actor)) return\n            break\n        case 'deleteCompendium':\n        case 'updateCompendium':\n            if (!game.tokenActionHud.actionHandler.compendiumActionHandler.isLinkedCompendium(hookData.source?.metadata?.id)) return\n            game.tokenActionHud.actionHandler.compendiumActionHandler.compendiumActions = new Map()\n            break\n        case 'createItem':\n        case 'deleteItem':\n        case 'updateItem':\n            if (!game.tokenActionHud.isValidActorOrItemUpdate(hookData.item?.actor)) return\n            break\n        case 'deleteMacro':\n        case 'updateMacro':\n            game.tokenActionHud.actionHandler.macroActionHandler.macroActions = null\n            break\n        case 'updateToken':\n            // If it's an X or Y change, assume the token is just moving\n            if (Object.hasOwn(hookData.data, 'y') || Object.hasOwn(hookData.data, 'x')) return\n            if (!game.tokenActionHud.isValidTokenChange(hookData.token, hookData.data)) return\n            break\n        }\n        game.tokenActionHud.update(trigger)\n    }\n\n    const trigger = { type: 'hook', name: 'canvasReady' }\n    game.tokenActionHud.update(trigger)\n})\n\n/**\n  * Move the HUD below the scene context menus\n  */\nHooks.on('renderSceneNavigation', (data, html) => {\n    html.find('li.scene.nav-item').contextmenu((ev) => sendHudToBottom())\n})\n\n/**\n  * Move the HUD below the hotbar context menus\n  */\nHooks.on('renderHotbar', (data, html) => {\n    html.find('li.macro').contextmenu((ev) => sendHudToBottom())\n})\n\n/**\n * Send HUD to bottom\n */\nfunction sendHudToBottom () {\n    if (!game.tokenActionHud?.element[0]) return\n    game.tokenActionHud.element[0].style.zIndex = 0\n}\n"],"names":["MODULE","ID","NAME","TEMPLATE_DIR","TEMPLATE","action","customStyleForm","group","hud","listGroup","settings","tabGroup","tagDialogGroup","tagDialogHud","tagDialogTopLevelGroup","DELIMITER","ACTION_TYPE","compendiumEntry","compendiumMacro","compendiumPlaylist","macro","COMPENDIUM_ACTION_TYPES","COMPENDIUM_PACK_TYPES","CSS_STYLE","compact","class","file","primaryColor","secondaryColor","tertiaryColor","custom","dorakoUI","foundryVTT","foundryVttLight","highContrast","pathfinder","CUSTOM_STYLE","backgroundColor","cssProperty","type","String","default","buttonHeight","Number","buttonBackgroundColor","buttonBorderPrimaryColor","buttonBorderSecondaryColor","buttonTextColor","buttonHoverBorderPrimaryColor","buttonHoverBorderSecondaryColor","buttonHoverBackgroundColor","buttonHoverTextColor","buttonToggleActiveBackgroundColor","buttonToggleActiveBorderPrimaryColor","buttonToggleActiveBorderSecondaryColor","buttonToggleActiveTextColor","buttonToggleHoverBackgroundColor","buttonToggleHoverBorderPrimaryColor","buttonToggleHoverBorderSecondaryColor","buttonToggleHoverTextColor","textPrimaryColor","textSecondaryColor","textTertiaryColor","textHoverPrimaryColor","textHoverSecondaryColor","textHoverTertiaryColor","GROUP_TYPE","ITEM_MACRO_ICON","LAYOUT_SETTING","customLayout","hint","name","inputType","filePickerType","dtype","scope","userCustomLayout","exportLayout","label","icon","onClick","resetLayout","resetAllLayouts","SETTING","activeCssAsText","classes","variable","allow","alwaysShowHud","clickOpenCategory","customStyle","debug","direction","displayCharacterName","displayIcons","drag","enable","enableCustomization","grid","itemMacro","migrationVersion","reset","renderItemOnRightClick","rollHandler","scale","sortActions","startup","style","tooltips","Logger","info","message","notify","ui","notifications","console","log","error","data","game","tokenActionHud","debugSetting","Utils","getSetting","dataClone","deepClone","Timer","constructor","milliseconds","this","timer","start","abort","Promise","resolve","setTimeout","clearTimeout","checkAllow","userRole","allowSetting","original","options","getActor","actorId","tokenId","token","canvas","tokens","placeables","find","id","actor","actors","get","getStatusEffect","statusId","version","startsWith","effects","effect","statuses","every","status","flags","core","getImage","entity","defaultImages","push","result","displayIconsSetting","img","includes","getItem","itemId","items","getToken","getControlledTokens","controlled","getFirstControlledToken","controlledToken","character","user","key","defaultValue","value","setSetting","set","getActorFlag","getFlag","setActorFlag","setFlag","unsetActorFlag","unsetFlag","getUserFlag","setUserFlag","unsetUserFlag","i18n","toTranslate","localize","isGmActive","users","some","isGM","active","isModuleActive","moduleId","module","modules","getModuleTitle","title","getModuleVersion","humanizeBinding","binding","keybindings","modifiers","reduce","parts","part","KeyboardManager","MODIFIER_CODES","unshift","getKeycodeDisplayString","join","median","numbers","mid","Math","floor","length","nums","sort","a","b","getUpperQuartileAverage","sortedNumbers","slice","endIndex","sum","count","i","ceil","getModifier","sortItems","Map","entries","localeCompare","sortItemsByName","switchCSS","Object","href","values","document","styleSheets","ss","disabled","setting","querySelector","setProperty","tahElement","classList","remove","add","registerHandlebars","Handlebars","registerHelper","string","toUpperCase","reduceOp","args","reducer","Array","from","pop","first","shift","eq","arguments","ne","lt","gt","lte","gte","and","or","true","false","block","activeCssAsTextSetting","fn","inverse","getModuleVersionParts","moduleVersion","trigger","moduleVersionParts","split","major","minor","patch","checkModuleCompatibility","requiredCoreModuleVersion","requiredCoreModuleVersionParts","coreModuleVersionParts","getSubcategories","subcategories","order","subcategoryId","subcategoryType","isArray","foundSubcategories","subcategory","level","nestId","assign","keys","getNestedGroups","groups","groupId","groupType","foundGroups","getGroupByNestId","async","findGroup","groupStyle","foundGroup","deleteGroupByNestId","index","splice","deleteGroupsById","isPersistentStorage","ForgeVTT","DataHandler","init","path","getPath","fileMap","getFilePathsAsGm","createDirectories","DATA_FOLDER","moduleDirectory","directoriesToCreate","world","directory","FilePicker","browse","catch","_","createDirectory","hasPermission","files","getFilePaths","socket","executeAsGM","map","getFileParts","filename","folder","dataHandler","actorFiles","userFiles","all","canSaveData","saveDataAsGm","saveData","fileName","encodeURI","File","JSON","stringify","response","upload","has","canGetData","getDataAsGm","getData","foundFile","ms","Date","now","fetch","ok","json","saveDataMigrate","folderPath","getDataMigrate","foundFilePath","endsWith","then","GenericActionHandler","actionHandler","buildGenericActions","buildUtilities","buildSingleTokenUtilities","buildMultipleTokenUtilities","actionsData","actionType","toggleCombatId","toggleCombatName","inCombat","toggleCombatEncodedValue","toggleCombatAction","encodedValue","toggleVisibilityId","toggleVisibilityName","hidden","toggleVisbilityEncodedValue","toggleVisibilityAction","groupData","addActions","toggleVisibilityname","CompendiumActionHandler","compendiumActions","packIds","buildCompendiumActions","size","packs","filter","pack","documentName","visible","private","metadata","packId","setCompendiumActions","getIndex","getCompendiumActionType","entry","_id","listName","getGroupId","replace","isLinkedCompendium","MacroActionHandler","macroActions","buildMacroActions","getActions","macros","permissions","ownership","userId","ActionHandler","characterName","furtherActionHandlers","delimiter","genericActionHandler","compendiumActionHandler","macroActionHandler","defaultGroups","defaultLayout","actorGroups","userGroups","actions","availableActionsMap","customLayoutSetting","userCustomLayoutSetting","enableCustomizationSetting","displayCharacterNameSetting","sortActionsSetting","tooltipsSetting","softResetActionHandler","hardResetActionHandler","registerDefaultCategories","buildHud","previousActor","isSameActor","getDefaultGroups","getDefaultLayout","getCustomLayout","isGmInactiveUserNotified","getSavedUserGroups","getSavedActorGroups","prepareHud","buildSystemActions","buildFurtherActions","updateNonPresetActions","setHasActions","setCharacterLimit","saveGroups","getUserGroups","userGroup","createGroup","parentNestId","parentGroup","tabs","lists","getActorGroups","actorGroup","existingGroup","selected","groupIds","forEach","handler","extendActionList","nonPresetActions","isPreset","nonPresetAction","availableAction","systemSelected","userSelected","createAction","hasActions","defaults","defaultGroup","layout","categories","saveDataToFile","savedUserData","getGroup","getGroups","getGroupSettings","saveGroupSettings","saveActor","saveUser","keepData","groupDataClone","tooltip","getTooltip","defaultSettings","showTitle","groupSettings","subtitleClass","commonProps","cssClass","info1","info2","info3","isSelected","defaultSelected","updateGroups","groupsData","parentGroupData","childGroupData","existingGroups","existingParentGroup","saveActorGroups","saveUserGroups","getReducedGroupData","keepActions","actionData","fullName","icons","icon1","icon2","icon3","text","isAction","isItem","isitem","useRawHtmlName","updateActions","reorderedActions","existingAction","actionClone","addToAvailableActions","actionsMap","actionId","getAvailableActions","toActionTagifyEntry","getSelectedActions","getSelectedGroups","toGroupTagifyEntry","getAvailableGroups","getDerivedGroups","getSystemGroups","getCompendiumGroups","getMacroGroups","derivedGroups","addGroup","update","parentGroups","updateGroup","updateExistingGroups","removeGroup","addGroupInfo","groupInfo","existingActions","existingActionId","topLevelGroups","topLevelGroup","topLevelGroupCharacterCount","characterCount","groupCharacterCount","word","addFurtherActionHandler","addActionsToActionList","globalThis","logger","warn","addSubcategoryInfo","addSubcategoryToActionList","ActionListExtender","MigrationManager","isSuccess","unsetOldFlags","migrateFiles","objects","children","scene","scenes","err","RollHandler","preRollHandlers","throwInvalidValueErr","Error","handleActionEvent","event","registerKeyPresses","handled","prehandleActionEvent","isGenericAction","handleGenericAction","doHandleActionEvent","addPreRollHandler","rightClick","isRightClick","ctrl","isCtrl","alt","isAlt","isShift","doRenderItem","sheet","render","isRenderItem","originalEvent","button","isModiferActive","keyboard","isModifierActive","MODIFIER_KEYS","ALT","altKey","emulateKeypress","force","downKeys","CONTROL","ctrlKey","SHIFT","shiftKey","payload","firstControlledToken","toggleVisibility","toggleCombat","Hooks","callAll","PreRollHandler","CustomStyleForm","FormApplication","defaultOptions","mergeObject","super","template","width","height","popOut","resizable","closeOnSubmit","activateListeners","html","on","_reset","bind","ColorPicker","install","_updateObject","formData","TahSettingsForm","Function","isButton","isCheckbox","isFilePicker","isNumber","isRange","range","isSelect","undefined","choices","close","updateSettings","TahSettingsFormLayout","onChangeFunction","register","editable","onDown","toggleHud","registerSettings","systemManager","rollHandlers","registerMenu","restricted","config","Boolean","onChange","auto","up","down","min","max","step","always","whenUnlocked","never","requiresReload","full","nameOnly","none","setTooltipDelay","both","registerCustomStyleSettings","doRegisterSettings","ItemMacroActionListExtender","item","itemacro","command","itemIds","isUnsupportedByMidiQoL","itemMacroSetting","groupKey","addGroupActions","existingItemMacroAction","actionToReplace","macroAction","createItemMacroAction","substr","indexOf","itemMacroIcon","findIndex","CompendiumMacroPreHandler","handleCompendium","handleMacroCompendium","handlePlaylistCompendium","handleMacro","compendiumKey","getDocument","execute","actionPayload","playlistId","soundId","sound","sounds","AudioHelper","play","src","ItemMacroPreRollHandler","tryExecuteItemMacro","executeMacro","e","SystemManager","coreModuleId","doGetActionHandler","doGetRollHandler","handlerId","getAvailableRollHandlers","updateFunc","doRegisterDefaultFlags","registerDefaults","getActionHandler","addActionExtenders","getRollHandler","rollHandlerId","addPreHandlers","addHandler","s","t","r","window","MutationObserver","WebKitMutationObserver","nodeType","observe","childList","subtree","addEventListener","parentElm","uid","selector","callbacks","setup","bindEvents","prototype","namespace","childNodes","parentNode","removeChild","matches","draggable","gap","getItemsGap","firstElementChild","throttle","call","getDraggableElm","closest","dragstart","source","getInitialState","target","getBoundingClientRect","elm","idx","getNodeIndex","dataTransfer","effectAllowed","dragStart","afterDragStart","mode","dragover","preventDefault","stopPropagation","hoverDirection","dropEffect","getTargetDirection","directionAwareDragEnter","dragenter","isValidElm","bounding","cleanupLastTarget","abs","toggle","dragend","dragoverTimeout","cleanup","nextElementSibling","insertBefore","dragEnd","isTargetLastChild","lastElementChild","pageY","top","pageX","left","previousSibling","test","removeAttribute","getComputedStyle","parseInt","listeners","destroy","DragSort","amd","exports","getOwnPropertySymbols","getOwnPropertyDescriptor","enumerable","apply","getOwnPropertyDescriptors","defineProperties","defineProperty","Symbol","toPrimitive","TypeError","configurable","writable","trim","toLowerCase","n","o","createElement","innerHTML","innerText","DOMParser","parseFromString","body","l","d","h","toString","g","hasOwnProperty","p","c","normalize","u","navigator","userAgent","m","crypto","getRandomValues","Uint8Array","v","contains","classNames","tag","f","getSelection","getRangeAt","createTextNode","deleteContents","insertNode","T","__tagifyTagData","w","delimiters","pattern","tagTextProp","maxTags","addTagOnBlur","onChangeAfterBlur","duplicates","whitelist","blacklist","enforceWhitelist","userInput","keepInvalidTags","createInvalidTags","mixTagsAllowedAfter","mixTagsInterpolator","backspace","skipInvalid","pasteAsTags","editTags","clicks","keepInvalid","transformTag","a11y","focusableTags","mixMode","insertAfterTag","autoComplete","enabled","rightKey","selectMode","input","focus","tagNoAnimation","tagInvalid","tagNotAllowed","scopeLoading","hasMaxTags","hasNoTags","empty","inputInvalid","dropdown","dropdownWrapper","dropdownHeader","dropdownFooter","dropdownItem","dropdownItemActive","dropdownItemHidden","dropdownInital","tagText","tagX","tagLoading","tagEditing","tagFlash","tagHide","classname","maxItems","searchKeys","fuzzySearch","caseSensitive","accentedSearch","includeSelectedTags","highlightFirst","closeOnSelect","clearOnSelect","position","appendTarget","hooks","beforeRemoveTag","beforePaste","suggestionClick","_dropdown","refs","y","DOM","parseTemplate","content","getHeaderRef","getFooterRef","getAllSuggestionsRefs","querySelectorAll","dropdownItemSelector","show","state","inputText","templates","dropdownItemNoMatch","isLoading","readonly","dropdownHide__bindEventsTimeout","suggestedListItems","filterListItems","editing","autocomplete","suggest","hide","fill","highlightOption","events","query","setStateSelection","removeEventListener","setAttribute","ddItemData","ddItemElm","selection","flaggedTags","baseOffset","cloneNode","cssText","appendChild","clientHeight","createListHTML","dropdownContent","fillHeaderFooter","replaceChild","refilter","placeAbove","pageYOffset","scrollTop","fullscreenElement","webkitFullscreenElement","documentElement","clientWidth","innerWidth","rangeCount","startContainer","startOffset","createRange","setStart","setEnd","right","bottom","offsetLeft","offsetTop","pageXOffset","onKeyDown","onMouseOver","onMouseLeave","onScroll","hasFocus","composing","dropdownItemActiveSelector","getSuggestionDataByNode","getNextOrPrevOption","ArrowLeft","getMappedValue","tagify","tagData","suggestionElm","selectOption","addTags","raw","charCodeAt","removeTags","editTag","scrollHeight","percentage","round","getAttribute","onEditTagDone","__isValid","normalizeTags","toggleFocusClass","once","selectAll","suggestions","isTagDuplicate","exact","sortby","concat","mapValueTo","mappedValue","x","O","D","exceed","duplicate","notAllowed","M","wrapper","className","required","placeholder","getAttributes","I","customBinding","customEventsList","mainEvents","main","bindGlobal","isJQueryPlugin","jQuery","originalInput","removeAllTags","onFocusBlur","keydown","onKeydown","click","onClickScope","dblclick","onDoubleClickScope","paste","onPaste","drop","onDrop","compositionstart","onCompositionStart","compositionend","onCompositionEnd","clearInterval","originalInputValueObserverInterval","setInterval","observeOriginalInputValue","inputMutationObserver","onInputDOMChange","disconnect","global","isIE","cb","onWindowKeyDown","onClickAnywhere","unbindGlobal","textContent","relatedTarget","addNew","postUpdate","triggerChangeEvent","loading","activeElement","hasAttribute","anchorOffset","anchorNode","getTagElms","previousElementSibling","Element","placeCaretAfterNode","nodeName","nodeValue","blur","inputSuggestion","onInput","onMixTagsInput","inputElm","validateTag","toggleScopeValidation","isValid","search","createDocumentFragment","createTagElem","setRangeAtStartEnd","lastChild","withoutChangeEvent","cloneRange","collapse","focusNode","endOffset","match","lastIndexOf","prefix","matchedPatternCount","onInputIE","tagifyValue","loadOriginalValues","fixFirefoxLastTagNoCaret","clipboardData","pastedText","injectAtCaret","onEditTagInput","__tagId","editTagChangeDetected","originalIsValid","newValue","onEditTagPaste","onEditTagFocus","onEditTagBlur","__originalData","onEditTagkeydown","__originalHTML","addedNodes","outerHTML","replaceWith","tagSelector","nextSibling","removedNodes","N","Proxy","__tagify","off","cloneData","triggerHandler","cloneEvent","HTMLElement","CustomEvent","detail","dispatchEvent","isFirefox","documentMode","getPersistedData","localStorage","parse","setPersistedData","setItem","Event","clearPersistedData","removeItem","applySettings","build","getCSSVars","autofocus","getSetTagData","helpers","sameStr","removeCollectionProp","omit","isObject","parseHTML","escapeHTML","extend","concatWithoutDups","getUID","isNodeTag","dataProps","generateClassSelectors","RegExp","_delimiters","TEXTS","texts","getCustomAttributes","CSSVars","tagHideTransition","unit","getPropertyValue","integrated","originalInput_tabIndex","tabIndex","inputSelector","blockChangeEvent","parseMixTags","tagName","insertAdjacentHTML","lastOriginalValueReported","toggleClass","bubbles","simulated","_valueTracker","setValue","random","setStartAfter","removeAllRanges","addRange","getTagTextNode","tagTextSelector","setTagTextNode","getLastTag","skipValidation","editTagToggleValidity","removeTagsFromValue","previousData","replaceTag","reCheckInvalidTags","getInvalidTagAttrs","updateValueByDOMTags","appendMixTags","validate","charAt","substring","replaceTextWithNode","getTagIdx","getTagIndexByValue","getTagElmByValue","flashTag","isTagBlacklisted","isTagWhitelisted","getWhitelistItem","setReadonly","setContentEditable","contentEditable","setDisabled","splitText","selectTag","appendTag","addEmptyTag","addMixTags","__preInvalidData","prefixedTextToTag","createNodeIterator","NodeFilter","SHOW_TEXT","nextNode","node","__removed","parseFloat","clientTop","removeTagsFromDOM","setOriginalInputValue","debouncedUpdateTimeout","getInputValue","getCleanValue","getMixedTagsAsString","originalInputValueFormat","removeTag","TagDialog","dragSort","submit","categoryId","foundry","utils","resetActions","showDialog","dialogType","tags","dialogData","dialogSubmit","_prepareHook","dialog","TagDialogHud","TagDialogTopLevelGroup","TagDialogGroup","app","$tagFilter","tagifyOptions","Infinity","onDragEnd","available","Tagify","dropdownLabelElement","setPosition","Dialog","buttons","yes","callback","resetActorData","no","_onKeyDown","defaultChoice","slugify","replacement","strict","navSelector","contentSelector","initial","TagDialogHelper","showHudDialog","topLabel","showGroupDialog","choice","customWidth","image","showActionDialog","availableActions","availableSubcategories","selectedActions","selectedGroups","GroupResizer","minCols","isCustomWidth","spacing","resizeGroup","groupElement","autoDirection","gridModuleSetting","resetVariables","getGroupsElement","groupsElement","actionsElements","resetGroupsElements","dataset","availableWidth","getAvailableWidth","getGroupElements","hasGrid","groupElements","actionsElement","getGridWidth","resizeGrid","resize","setHeight","availableHeight","gridWidth","groupsElementPadding","groupsElementRect","groupsElements","resetCSS","maxHeight","overflowY","display","gridTemplateColumns","actionWidths","actionWidthsForMedian","actionElements","actionElement","actionRect","actionWidth","actionButtonText","actionButtonTextRect","actionButtonTextWidth","upperQuartileAverage","availableactionButtonTextWidth","assignCSS","squaredCols","sqrt","availableCols","sqrtActions","currentRow","maxRowWidth","rowWidth","maxWidth","windowWidth","screenDimensions","contentLeft","uiRightClientWidth","getAvailableHeight","windowHeight","contentBottom","contentTop","uiTopBottomOffsetHeight","offsetHeight","groupsElementComputed","paddingLeft","paddingRight","requestAnimationFrame","element","elements","TokenActionHud","Application","hoveredGroups","defaultHeight","defaultWidth","defaultLeftPos","defaultTopPos","leftPos","topPos","defaultScale","refreshTimeout","rendering","isUpdatePending","isUpdating","updatePendingTimer","updateTimer","directionSetting","alwaysShowSetting","clickOpenCategorySetting","isCollapsed","dragSetting","enableSetting","isHudEnabled","gridSetting","isUnlocked","styleSetting","scaleSetting","getHudEnabled","hudPosition","updateSettingsPending","updateRollHandler","background","minimizable","dragDrop","scrollY","zIndex","isDraggable","getScale","editHudButton","listGroups","subtitle","groupButton","collapseHudButton","expandHudButton","unlockButton","lockButton","bindGroupEvents","bindActionEvents","bindEditHudButton","bindLockUnlockButtons","bindCollapseExpandButtons","postRender","closeGroup","currentTarget","parentElement","closestGroupElement","sibling","clearHoveredGroup","openGroup","setHoveredGroup","toggleGroup","bringToTop","passive","hover","dragEvent","openGroupDialog","outerText","handleAction","openActionDialog","collapseExpandGroup","collapseIcon","expandIcon","imageElement","toggleGroupVisibility","unlockHud","$","addClass","removeClass","lockHud","topGroupElement","getElementsByClassName","listGroupsElement","subtitleElement","collapseHud","getElementById","clientX","changedTouches","clientY","pos1","pos2","pos3","pos4","originalElementTop","originalElementLeft","newElementTop","newElementLeft","mouseMoveEvent","mouseUpEvent","onmousemove","ontouchmove","onmouseup","ontouchend","getAutoDirection","innerHeight","setPositionFromFlag","restoreHoveredGroups","check","resetPosition","mouseenter","format","copy","fromUserId","toUserIds","copyUserData","fromGroup","resetDialog","customLayoutElement","userCustomLayoutElement","tokenActonHud","resetAllDialog","executeForEveryone","resetUserAndActorData","resetAllActorData","resetUserData","resetAllUserData","handleUpdate","performUpdate","waitForUpdateCompletion","maxWaitTime","previousActorId","controlledTokens","getCharacter","multipleTokens","windows","appId","isValidTokenChange","actorData","isRelevantToken","isSelectedActor","isValidActorOrItemUpdate","isValidCharacter","testUserPermission","role","sendHudToBottom","socketlib","registerModule","api","systemModule","socketlibModule","loadTemplates","migrationManager","handleHookEvent","hookData","hookName","activeEffect","parent","combatant","hasOwn","combat","change","diff","contextmenu","ev"],"mappings":"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","x_google_ignoreList":[18,19]}